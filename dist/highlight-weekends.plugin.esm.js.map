{"version":3,"file":"highlight-weekends.plugin.esm.js","sources":["../node_modules/@neuronet.io/vido/Action.ts","../node_modules/@neuronet.io/vido/helpers.ts","../src/plugins/highlight-weekends.plugin.ts"],"sourcesContent":["class Action {\n  public isAction: boolean = true;\n}\nAction.prototype.isAction = true;\nexport default Action;\n","/**\n * Schedule - a throttle function that uses requestAnimationFrame to limit the rate at which a function is called.\n *\n * @param {function} fn\n * @returns {function}\n */\nexport function schedule(fn: (argument) => void | any) {\n  let frameId = 0;\n  function wrapperFn(argument) {\n    if (frameId) {\n      return;\n    }\n    function executeFrame() {\n      frameId = 0;\n      fn.apply(undefined, [argument]);\n    }\n    frameId = requestAnimationFrame(executeFrame);\n  }\n  return wrapperFn;\n}\n\n/**\n * Is object - helper function to determine if specified variable is an object\n *\n * @param {any} item\n * @returns {boolean}\n */\nfunction isObject(item) {\n  return item && typeof item === 'object' && item.constructor && item.constructor.name === 'Object';\n}\n\n/**\n * Merge deep - helper function which will merge objects recursively - creating brand new one - like clone\n *\n * @param {object} target\n * @params {[object]} sources\n * @returns {object}\n */\nexport function mergeDeep(target, ...sources) {\n  const source = sources.shift();\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (typeof source[key].clone === 'function') {\n          target[key] = source[key].clone();\n        } else {\n          if (typeof target[key] === 'undefined') {\n            target[key] = {};\n          }\n          target[key] = mergeDeep(target[key], source[key]);\n        }\n      } else if (Array.isArray(source[key])) {\n        target[key] = new Array(source[key].length);\n        let index = 0;\n        for (let item of source[key]) {\n          if (isObject(item)) {\n            if (typeof item.clone === 'function') {\n              target[key][index] = item.clone();\n            } else {\n              target[key][index] = mergeDeep({}, item);\n            }\n          } else {\n            target[key][index] = item;\n          }\n          index++;\n        }\n      } else {\n        target[key] = source[key];\n      }\n    }\n  }\n  if (!sources.length) {\n    return target;\n  }\n  return mergeDeep(target, ...sources);\n}\n\n/**\n * Clone helper function\n *\n * @param source\n * @returns {object} cloned source\n */\nexport function clone(source) {\n  if (typeof source.actions !== 'undefined') {\n    const actns = source.actions.map((action) => {\n      const result = { ...action };\n      const props = { ...result.props };\n      delete props.state;\n      delete props.api;\n      delete result.element;\n      result.props = props;\n      return result;\n    });\n    source.actions = actns;\n  }\n  return mergeDeep({}, source);\n}\n\nexport default {\n  mergeDeep,\n  clone,\n  schedule,\n};\n","/**\n * Weekend highlight plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   AGPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nimport Action from '@neuronet.io/vido/Action';\nimport { Api } from '../api/api';\nimport { Vido } from '../gstc';\nimport { mergeDeep } from '@neuronet.io/vido/helpers';\n\nexport interface Options {\n  weekdays?: number[];\n  className?: string;\n}\n\nexport function Plugin(options: Options = {}) {\n  const weekdays = options.weekdays || [6, 0];\n  let className;\n  let api: Api;\n  let enabled = true;\n\n  class WeekendHighlightAction extends Action {\n    constructor(element, data) {\n      super();\n      this.highlight(element, data.time.leftGlobal);\n    }\n\n    update(element, data) {\n      this.highlight(element, data.time.leftGlobal);\n    }\n\n    highlight(element, time) {\n      const hasClass = element.classList.contains(className);\n      if (!enabled) {\n        if (hasClass) {\n          element.classList.remove(className);\n        }\n        return;\n      }\n      const isWeekend = weekdays.includes(api.time.date(time).day());\n      if (!hasClass && isWeekend) {\n        element.classList.add(className);\n      } else if (hasClass && !isWeekend) {\n        element.classList.remove(className);\n      }\n    }\n  }\n\n  return function initialize(vidoInstance: Vido) {\n    const subs = [];\n    const pluginPath = 'config.plugin.HighlightWeekends';\n    api = vidoInstance.api;\n    className = options.className || api.getClass('chart-timeline-grid-row-cell') + '--weekend';\n    const currentOptions = vidoInstance.state.get(pluginPath);\n    if (currentOptions) {\n      options = mergeDeep({}, options, currentOptions);\n    }\n    subs.push(vidoInstance.state.subscribe('$data.chart.time.format.period', (period) => (enabled = period === 'day')));\n    vidoInstance.state.update('config.actions.chart-timeline-grid-row-cell', (actions) => {\n      actions.push(WeekendHighlightAction);\n      return actions;\n    });\n    return function onDestroy() {\n      subs.forEach((unsub) => unsub());\n      vidoInstance.state.update('config.actions.chart-timeline-grid-row-cell', (actions) => {\n        return actions.filter((action) => action !== WeekendHighlightAction);\n      });\n    };\n  };\n}\n"],"names":[],"mappings":"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"}