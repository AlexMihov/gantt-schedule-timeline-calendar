!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t=t||self).GSTC=s()}(this,(function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function createCommonjsModule(t,s){return t(s={exports:{}},s.exports),s.exports}createCommonjsModule((function(t,s){t.exports=function(){var t=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],s=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function PointerEvent(r,a){a=a||Object.create(null);var l=document.createEvent("Event");l.initEvent(r,a.bubbles||!1,a.cancelable||!1);for(var h,m=2;m<t.length;m++)l[h=t[m]]=a[h]||s[m];l.buttons=a.buttons||0;var b=0;return b=void 0!==a.pressure&&l.buttons?a.pressure:l.buttons?.5:0,l.x=l.clientX,l.y=l.clientY,l.pointerId=a.pointerId||0,l.width=a.width||1,l.height=a.height||1,l.pressure=b,l.tiltX=a.tiltX||0,l.tiltY=a.tiltY||0,l.twist=a.twist||0,l.tangentialPressure=a.tangentialPressure||0,l.pointerType=a.pointerType||"",l.hwTimestamp=a.hwTimestamp||0,l.isPrimary=a.isPrimary||!1,l.detail=0,l}var r=window.Map&&window.Map.prototype.forEach?Map:SparseArrayMap;function SparseArrayMap(){this.array=[],this.size=0}SparseArrayMap.prototype={set:function(t,s){if(void 0===s)return this.delete(t);this.has(t)||this.size++,this.array[t]=s},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,s){return this.array.forEach((function(r,a){t.call(s,r,a,this)}),this)}};var a=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],l=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],h={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},m="undefined"!=typeof SVGElementInstance,b={pointermap:new r,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,s){var r=s,a=r.events;a&&(a.forEach((function(t){r[t]&&(this.eventMap[t]=r[t].bind(r))}),this),this.eventSources[t]=r,this.eventSourceList.push(r))},register:function(t){for(var s,r=this.eventSourceList.length,a=0;a<r&&(s=this.eventSourceList[a]);a++)s.register.call(s,t)},unregister:function(t){for(var s,r=this.eventSourceList.length,a=0;a<r&&(s=this.eventSourceList[a]);a++)s.unregister.call(s,t)},contains:function(t,s){try{return t.contains(s)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var s=t.type,r=this.eventMap&&this.eventMap[s];r&&r(t),t._handledByPE=!0}},listen:function(t,s){s.forEach((function(s){this.addEvent(t,s)}),this)},unlisten:function(t,s){s.forEach((function(s){this.removeEvent(t,s)}),this)},addEvent:function(t,s){t.addEventListener(s,this.boundHandler)},removeEvent:function(t,s){t.removeEventListener(s,this.boundHandler)},makeEvent:function(t,s){this.captureInfo[s.pointerId]&&(s.relatedTarget=null);var r=new PointerEvent(t,s);return s.preventDefault&&(r.preventDefault=s.preventDefault),r._target=r._target||s.target,r},fireEvent:function(t,s){var r=this.makeEvent(t,s);return this.dispatchEvent(r)},cloneEvent:function(t){for(var s,r=Object.create(null),h=0;h<a.length;h++)r[s=a[h]]=t[s]||l[h],!m||"target"!==s&&"relatedTarget"!==s||r[s]instanceof SVGElementInstance&&(r[s]=r[s].correspondingUseElement);return t.preventDefault&&(r.preventDefault=function(){t.preventDefault()}),r},getTarget:function(t){var s=this.captureInfo[t.pointerId];return s?t._target!==s&&t.type in h?void 0:s:t._target},propagate:function(t,s,r){for(var a=t.target,l=[];null!=a&&a!==document&&!a.contains(t.relatedTarget);)if(l.push(a),!(a=a.parentNode))return;r&&l.reverse(),l.forEach((function(r){t.target=r,s.call(this,t)}),this)},setCapture:function(t,s,r){this.captureInfo[t]&&this.releaseCapture(t,r),this.captureInfo[t]=s,this.implicitRelease=this.releaseCapture.bind(this,t,r),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var a=new PointerEvent("gotpointercapture",{bubbles:!0});a.pointerId=t,a._target=s,r||this.asyncDispatchEvent(a)},releaseCapture:function(t,s){var r=this.captureInfo[t];if(r){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var a=new PointerEvent("lostpointercapture",{bubbles:!0});a.pointerId=t,a._target=r,s||this.asyncDispatchEvent(a)}},dispatchEvent:function(t){var s=this.getTarget(t);if(s)return s.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};b.boundHandler=b.eventHandler.bind(b);var x={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var s=this.shadow(t);if(this.canTarget(s))return s},olderShadow:function(t){var s=t.olderShadowRoot;if(!s){var r=t.querySelector("shadow");r&&(s=r.olderShadowRoot)}return s},allShadows:function(t){for(var s=[],r=this.shadow(t);r;)s.push(r),r=this.olderShadow(r);return s},searchRoot:function(t,s,r){if(t){var a,l,h=t.elementFromPoint(s,r);for(l=this.targetingShadow(h);l;){if(a=l.elementFromPoint(s,r)){var m=this.targetingShadow(a);return this.searchRoot(m,s,r)||a}l=this.olderShadow(l)}return h}},owner:function(t){for(var s=t;s.parentNode;)s=s.parentNode;return s.nodeType!==Node.DOCUMENT_NODE&&s.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(s=document),s},findTarget:function(t){var s=t.clientX,r=t.clientY,a=this.owner(t.target);return a.elementFromPoint(s,r)||(a=document),this.searchRoot(a,s,r)}},S=Array.prototype.forEach.call.bind(Array.prototype.forEach),O=Array.prototype.map.call.bind(Array.prototype.map),L=Array.prototype.slice.call.bind(Array.prototype.slice),z=Array.prototype.filter.call.bind(Array.prototype.filter),G=window.MutationObserver||window.WebKitMutationObserver,H={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function Installer(t,s,r,a){this.addCallback=t.bind(a),this.removeCallback=s.bind(a),this.changedCallback=r.bind(a),G&&(this.observer=new G(this.mutationWatcher.bind(this)))}function rule(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}Installer.prototype={watchSubtree:function(t){this.observer&&x.canTarget(t)&&this.observer.observe(t,H)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){S(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,s){this.changedCallback(t,s)},concatLists:function(t,s){return t.concat(L(s))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var s=O(t,this.findElements,this);return s.push(z(t,this.isElement)),s.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var j=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],W="",F=window.PointerEvent||window.MSPointerEvent,B=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,U=b.pointermap,q=[1,4,2,8,16],K=!1;try{K=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var Q,J={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){b.listen(t,this.events)},unregister:function(t){b.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var s,r=this.lastTouches,a=t.clientX,l=t.clientY,h=0,m=r.length;h<m&&(s=r[h]);h++){var b=Math.abs(a-s.x),x=Math.abs(l-s.y);if(b<=25&&x<=25)return!0}},prepareEvent:function(t){var s=b.cloneEvent(t),r=s.preventDefault;return s.preventDefault=function(){t.preventDefault(),r()},s.pointerId=this.POINTER_ID,s.isPrimary=!0,s.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(s.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),s},prepareButtonsForMove:function(t,s){var r=U.get(this.POINTER_ID);0!==s.which&&r?t.buttons=r.buttons:t.buttons=0,s.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var s=U.get(this.POINTER_ID),r=this.prepareEvent(t);K||(r.buttons=q[r.button],s&&(r.buttons|=s.buttons),t.buttons=r.buttons),U.set(this.POINTER_ID,t),s&&0!==s.buttons?b.move(r):b.down(r)}},webkitmouseforcechanged:function(t){this.mousemove(t)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var s=this.prepareEvent(t);K||this.prepareButtonsForMove(s,t),s.button=-1,U.set(this.POINTER_ID,t),b.move(s)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var s=U.get(this.POINTER_ID),r=this.prepareEvent(t);if(!K){var a=q[r.button];r.buttons=s?s.buttons&~a:0,t.buttons=r.buttons}U.set(this.POINTER_ID,t),r.buttons&=~q[r.button],0===r.buttons?b.up(r):b.move(r)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var s=this.prepareEvent(t);K||this.prepareButtonsForMove(s,t),s.button=-1,U.set(this.POINTER_ID,t),b.enterOver(s)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var s=this.prepareEvent(t);K||this.prepareButtonsForMove(s,t),s.button=-1,b.leaveOut(s)}},cancel:function(t){var s=this.prepareEvent(t);b.cancel(s),this.deactivateMouse()},deactivateMouse:function(){U.delete(this.POINTER_ID)}},Z=b.captureInfo,tt=x.findTarget.bind(x),et=x.allShadows.bind(x),it=b.pointermap,nt={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(t){Q.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var s=t.getAttribute("touch-action"),r=this.touchActionToScrollType(s);"number"==typeof r&&(t._scrollType=r,b.listen(t,this.events),et(t).forEach((function(t){t._scrollType=r,b.listen(t,this.events)}),this))},elementRemoved:function(t){if(it.size>0){var s=this.events;t.addEventListener("touchend",(function(){t._scrollType=void 0,b.unlisten(t,s)}))}else t._scrollType=void 0,b.unlisten(t,this.events);et(t).forEach((function(t){t._scrollType=void 0,b.unlisten(t,this.events)}),this)},elementChanged:function(t,s){var r=t.getAttribute("touch-action"),a=this.touchActionToScrollType(r),l=this.touchActionToScrollType(s);"number"==typeof a&&"number"==typeof l?(t._scrollType=a,et(t).forEach((function(t){t._scrollType=a}),this)):"number"==typeof l?this.elementRemoved(t):"number"==typeof a&&this.elementAdded(t)},scrollTypes:{UP:function(t){return t.includes("pan-y")||t.includes("pan-up")?1:0},DOWN:function(t){return t.includes("pan-y")||t.includes("pan-down")?2:0},LEFT:function(t){return t.includes("pan-x")||t.includes("pan-left")?4:0},RIGHT:function(t){return t.includes("pan-x")||t.includes("pan-right")?8:0}},touchActionToScrollType:function(t){if(t){if("auto"===t)return 15;if("none"===t)return 0;var s=t.split(" "),r=this.scrollTypes;return r.UP(s)|r.DOWN(s)|r.LEFT(s)|r.RIGHT(s)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===it.size||1===it.size&&it.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1)},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(t){var s=0;return"touchstart"!==t&&"touchmove"!==t&&"touchforcechange"!==t||(s=1),s},touchToPointer:function(t){var s=this.currentTouchEvent,r=b.cloneEvent(t),a=r.pointerId=t.identifier+2;if(r.target=Z[a]||tt(r),r.bubbles=!0,r.cancelable=!0,r.button=0,r.buttons=this.typeToButtons(s.type),r.width=2*(t.radiusX||t.webkitRadiusX||0),r.height=2*(t.radiusY||t.webkitRadiusY||0),r.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,r.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle){const s=Math.tan(t.altitudeAngle),a=180/Math.PI;r.tiltX=Math.atan(Math.cos(t.azimuthAngle)/s)*a,r.tiltY=Math.atan(Math.sin(t.azimuthAngle)/s)*a}else r.tiltX=0,r.tiltY=0;"stylus"===t.touchType?r.pointerType="pen":r.pointerType=this.POINTER_TYPE,r.altKey=s.altKey,r.ctrlKey=s.ctrlKey,r.metaKey=s.metaKey,r.shiftKey=s.shiftKey;var l=this;return r.preventDefault=function(){l.scrolling=!1,l.firstXY=null,s.preventDefault()},r},processTouches:function(t,s){var r=t.changedTouches;this.currentTouchEvent=t;for(var a,l=0;l<r.length;l++)a=r[l],s.call(this,this.touchToPointer(a))},shouldScroll:function(t){if(this.firstXY){var s,r=t.currentTarget._scrollType;if(0===r)s=!1;else if(15===r)s=!0;else{var a=t.changedTouches[0],l=a.clientY-this.firstXY.Y,h=Math.abs(l),m=a.clientX-this.firstXY.X,b=Math.abs(m),x=1&r,S=2&r,O=4&r,L=8&r;O&&L?s=b>h:O?s=b>h&&m>0:L&&(s=b>h&&m<0),s||(x&&S?s=b<h:x?s=b<h&&l>0:S&&(s=b<h&&l<0))}return this.firstXY=null,s}},findTouch:function(t,s){for(var r,a=0,l=t.length;a<l&&(r=t[a]);a++)if(r.identifier===s)return!0},vacuumTouches:function(t){var s=t.touches;if(it.size>=s.length){var r=[];it.forEach((function(t,a){if(1!==a&&!this.findTouch(s,a-2)){var l=t.out;r.push(l)}}),this),r.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||this.processTouches(t,this.overDown)},overDown:function(t){it.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),b.enterOver(t),b.down(t)},touchforcechange:function(t){this.touchmove(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var s=t,r=it.get(s.pointerId);if(r){var a=r.out,l=r.outTarget;b.move(s),a&&l!==s.target&&(a.relatedTarget=s.target,s.relatedTarget=l,a.target=l,s.target?(b.leaveOut(a),b.enterOver(s)):(s.target=l,s.relatedTarget=null,this.cancelOut(s))),r.out=s,r.outTarget=s.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(b.up(t),b.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){b.cancel(t),b.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){it.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var s=J.lastTouches,r=t.changedTouches[0];if(this.isPrimaryTouch(r)){var a={x:r.clientX,y:r.clientY};s.push(a);var l=function(t,s){var r=t.indexOf(s);r>-1&&t.splice(r,1)}.bind(null,s,a);setTimeout(l,2500)}}};Q=new Installer(nt.elementAdded,nt.elementRemoved,nt.elementChanged,nt);var st,ot,rt,at=b.pointermap,lt=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,ct={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){b.listen(t,this.events)},unregister:function(t){b.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var s=t;return lt&&((s=b.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),s},cleanup:function(t){at.delete(t)},MSPointerDown:function(t){at.set(t.pointerId,t);var s=this.prepareEvent(t);b.down(s)},MSPointerMove:function(t){var s=this.prepareEvent(t);b.move(s)},MSPointerUp:function(t){var s=this.prepareEvent(t);b.up(s),this.cleanup(t.pointerId)},MSPointerOut:function(t){var s=this.prepareEvent(t);b.leaveOut(s)},MSPointerOver:function(t){var s=this.prepareEvent(t);b.enterOver(s)},MSPointerCancel:function(t){var s=this.prepareEvent(t);b.cancel(s),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var s=b.makeEvent("lostpointercapture",t);b.dispatchEvent(s)},MSGotPointerCapture:function(t){var s=b.makeEvent("gotpointercapture",t);b.dispatchEvent(s)}};function assertActive(t){if(!b.pointermap.has(t)){var s=new Error("NotFoundError");throw s.name="NotFoundError",s}}function assertConnected(t){for(var s=t.parentNode;s&&s!==t.ownerDocument;)s=s.parentNode;if(!s){var r=new Error("InvalidStateError");throw r.name="InvalidStateError",r}}function inActiveButtonState(t){return 0!==b.pointermap.get(t).buttons}return window.navigator.msPointerEnabled?(st=function(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&(b.setCapture(t,this,!0),this.msSetPointerCapture(t))},ot=function(t){assertActive(t),b.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(st=function setPointerCapture(t){assertActive(t),assertConnected(this),inActiveButtonState(t)&&b.setCapture(t,this)},ot=function releasePointerCapture(t){assertActive(t),b.releaseCapture(t)}),rt=function hasPointerCapture(t){return!!b.captureInfo[t]},function applyAttributeStyles(){if(F){j.forEach((function(t){W+=t.selector+rule(t.value)+"\n",B&&(W+=function shadowSelector(t){return"body /shadow-deep/ "+t}(t.selector)+rule(t.value)+"\n")}));var t=document.createElement("style");t.textContent=W,document.head.appendChild(t)}}(),function applyPolyfill(){if(!window.PointerEvent){if(window.PointerEvent=PointerEvent,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),b.registerSource("ms",ct)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),b.registerSource("mouse",J),void 0!==window.ontouchstart&&b.registerSource("touch",nt);b.register(document)}}(),function applyPolyfill$1(){window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:st},releasePointerCapture:{value:ot},hasPointerCapture:{value:rt}})}(),{dispatcher:b,Installer:Installer,PointerEvent:PointerEvent,PointerMap:r,targetFinding:x}}()}));const directive=t=>(...s)=>{const r=t(...s);return r.isDirective=!0,r};class Directive{constructor(){this.isDirective=!0,this.isClass=!0}body(t){}}const isDirective=t=>null!=t&&"boolean"==typeof t.isDirective,t="undefined"!=typeof window&&(null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback),reparentNodes=(t,s,r=null,a=null)=>{for(;s!==r;){const r=s.nextSibling;t.insertBefore(s,a),s=r}},removeNodes=(t,s,r=null)=>{for(;s!==r;){const r=s.nextSibling;t.removeChild(s),s=r}},s={},r={},a=`{{lit-${String(Math.random()).slice(2)}}}`,l=`\x3c!--${a}--\x3e`,h=new RegExp(`${a}|${l}`);class Template{constructor(t,s){this.parts=[],this.element=s;const r=[],l=[],m=document.createTreeWalker(s.content,133,null,!1);let x=0,S=-1,O=0;const{strings:L,values:{length:z}}=t;for(;O<z;){const t=m.nextNode();if(null!==t){if(S++,1===t.nodeType){if(t.hasAttributes()){const s=t.attributes,{length:r}=s;let a=0;for(let t=0;t<r;t++)endsWith(s[t].name,"$lit$")&&a++;for(;a-- >0;){const s=L[O],r=b.exec(s)[2],a=r.toLowerCase()+"$lit$",l=t.getAttribute(a);t.removeAttribute(a);const m=l.split(h);this.parts.push({type:"attribute",index:S,name:r,strings:m,sanitizer:void 0}),O+=m.length-1}}"TEMPLATE"===t.tagName&&(l.push(t),m.currentNode=t.content)}else if(3===t.nodeType){const s=t.data;if(s.indexOf(a)>=0){const a=t.parentNode,l=s.split(h),m=l.length-1;for(let s=0;s<m;s++){let r,h=l[s];if(""===h)r=createMarker();else{const t=b.exec(h);null!==t&&endsWith(t[2],"$lit$")&&(h=h.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),r=document.createTextNode(h)}a.insertBefore(r,t),this.parts.push({type:"node",index:++S})}""===l[m]?(a.insertBefore(createMarker(),t),r.push(t)):t.data=l[m],O+=m}}else if(8===t.nodeType)if(t.data===a){const s=t.parentNode;null!==t.previousSibling&&S!==x||(S++,s.insertBefore(createMarker(),t)),x=S,this.parts.push({type:"node",index:S}),null===t.nextSibling?t.data="":(r.push(t),S--),O++}else{let s=-1;for(;-1!==(s=t.data.indexOf(a,s+1));)this.parts.push({type:"node",index:-1}),O++}}else m.currentNode=l.pop()}for(const t of r)t.parentNode.removeChild(t)}}const endsWith=(t,s)=>{const r=t.length-s.length;return r>=0&&t.slice(r)===s},isTemplatePartActive=t=>-1!==t.index,m=document.createComment(""),createMarker=()=>m.cloneNode(),b=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class TemplateInstance{constructor(t,s,r){this.__parts=[],this.template=t,this.processor=s,this.options=r}update(t){let s=0;for(const r of this.__parts)void 0!==r&&r.setValue(t[s]),s++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const s=t?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),r=[],a=this.template.parts,l=document.createTreeWalker(s,133,null,!1);let h,m=0,b=0,x=l.nextNode();for(;m<a.length;)if(h=a[m],isTemplatePartActive(h)){for(;b<h.index;)b++,"TEMPLATE"===x.nodeName&&(r.push(x),l.currentNode=x.content),null===(x=l.nextNode())&&(l.currentNode=r.pop(),x=l.nextNode());if("node"===h.type){const t=this.processor.handleTextExpression(this.options,h);t.insertAfterNode(x.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(x,h.name,h.strings,this.options,h));m++}else this.__parts.push(void 0),m++;return t&&(document.adoptNode(s),customElements.upgrade(s)),s}}let x;const S=` ${a} `,O=document.createElement("template");class TemplateResult{constructor(t,s,r,a){this.strings=t,this.values=s,this.type=r,this.processor=a}getHTML(){const t=this.strings.length-1;let s="",r=!1;for(let h=0;h<t;h++){const t=this.strings[h],m=t.lastIndexOf("\x3c!--");r=(m>-1||r)&&-1===t.indexOf("--\x3e",m+1);const x=b.exec(t);s+=null===x?t+(r?S:l):t.substr(0,x.index)+x[1]+x[2]+"$lit$"+x[3]+a}return s+=this.strings[t],s}getTemplateElement(){const t=O.cloneNode();return t.innerHTML=function convertConstantTemplateStringToTrustedHTML(t){const s=window,r=s.trustedTypes||s.TrustedTypes;return r&&!x&&(x=r.createPolicy("lit-html",{createHTML:t=>t})),x?x.createHTML(t):t}(this.getHTML()),t}}class SVGTemplateResult extends TemplateResult{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),s=t.content,r=s.firstChild;return s.removeChild(r),reparentNodes(s,r.firstChild),t}}const isPrimitive=t=>null===t||!("object"==typeof t||"function"==typeof t),isIterable=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]),identityFunction=t=>t,noopSanitizer=(t,s,r)=>identityFunction;let L=noopSanitizer;const z=document.createTextNode("");class AttributeCommitter{constructor(t,s,r,a,l="attribute"){this.dirty=!0,this.element=t,this.name=s,this.strings=r,this.parts=[];let h=a&&a.sanitizer;void 0===h&&(h=L(t,s,l),void 0!==a&&(a.sanitizer=h)),this.sanitizer=h;for(let t=0;t<r.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new AttributePart(this)}_getValue(){const t=this.strings,s=this.parts,r=t.length-1;if(1===r&&""===t[0]&&""===t[1]&&void 0!==s[0]){const t=s[0].value;if(!isIterable(t))return t}let a="";for(let l=0;l<r;l++){a+=t[l];const r=s[l];if(void 0!==r){const t=r.value;if(isPrimitive(t)||!isIterable(t))a+="string"==typeof t?t:String(t);else for(const s of t)a+="string"==typeof s?s:String(s)}}return a+=t[r],a}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),"symbol"==typeof t&&(t=String(t)),this.element.setAttribute(this.name,t)}}}class AttributePart{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===s||isPrimitive(t)&&t===this.value||(this.value=t,isDirective(t)||(this.committer.dirty=!0))}commit(){for(;isDirective(this.value);){const t=this.value;this.value=s,t.isClass?t.body(this):t(this)}this.value!==s&&this.committer.commit()}}class NodePart{constructor(t,s){this.value=void 0,this.__pendingValue=void 0,this.textSanitizer=void 0,this.options=t,this.templatePart=s}appendInto(t){this.startNode=t.appendChild(createMarker()),this.endNode=t.appendChild(createMarker())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=createMarker()),t.__insert(this.endNode=createMarker())}insertAfterPart(t){t.__insert(this.startNode=createMarker()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=s,t.isClass?t.body(this):t(this)}const t=this.__pendingValue;t!==s&&(isPrimitive(t)?t!==this.value&&this.__commitText(t):t instanceof TemplateResult?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):isIterable(t)?this.__commitIterable(t):t===r?(this.value=r,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const s=this.startNode.nextSibling;if(t=null==t?"":t,s===this.endNode.previousSibling&&3===s.nodeType){void 0===this.textSanitizer&&(this.textSanitizer=L(s,"data","property"));const r=this.textSanitizer(t);s.data="string"==typeof r?r:String(r)}else{const s=z.cloneNode();this.__commitNode(s),void 0===this.textSanitizer&&(this.textSanitizer=L(s,"data","property"));const r=this.textSanitizer(t);s.data="string"==typeof r?r:String(r)}this.value=t}__commitTemplateResult(t){const s=this.options.templateFactory(t);if(this.value instanceof TemplateInstance&&this.value.template===s)this.value.update(t.values);else{const r=this.endNode.parentNode;if(L!==noopSanitizer&&"STYLE"===r.nodeName||"SCRIPT"===r.nodeName)return void this.__commitText("/* lit-html will not write TemplateResults to scripts and styles */");const a=new TemplateInstance(s,t.processor,this.options),l=a._clone();a.update(t.values),this.__commitNode(l),this.value=a}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const s=this.value;let r,a=0;for(const l of t)r=s[a],void 0===r&&(r=new NodePart(this.options,this.templatePart),s.push(r),0===a?r.appendIntoPart(this):r.insertAfterPart(s[a-1])),r.setValue(l),r.commit(),a++;a<s.length&&(s.length=a,this.clear(r&&r.endNode))}clear(t=this.startNode){removeNodes(this.startNode.parentNode,t.nextSibling,this.endNode)}}class BooleanAttributePart{constructor(t,s,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=s,this.strings=r}setValue(t){this.__pendingValue=t}commit(){for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=s,t.isClass?t.body(this):t(this)}if(this.__pendingValue===s)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=s}}class PropertyCommitter extends AttributeCommitter{constructor(t,s,r,a){super(t,s,r,a,"property"),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new PropertyPart(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),this.element[this.name]=t}}}class PropertyPart extends AttributePart{}let G=!1;(()=>{try{const t={get capture(){return G=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class EventPart{constructor(t,s,r){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=s,this.eventContext=r,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;isDirective(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=s,t.isClass?t.body(this):t(this)}if(this.__pendingValue===s)return;const t=this.__pendingValue,r=this.value,a=null==t||null!=r&&(t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive),l=null!=t&&(null==r||a);a&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),l&&(this.__options=getOptions(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=s}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const getOptions=t=>t&&(G?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);class DefaultTemplateProcessor{handleAttributeExpressions(t,s,r,a,l){const h=s[0];if("."===h){return new PropertyCommitter(t,s.slice(1),r,l).parts}return"@"===h?[new EventPart(t,s.slice(1),a.eventContext)]:"?"===h?[new BooleanAttributePart(t,s.slice(1),r)]:new AttributeCommitter(t,s,r,l).parts}handleTextExpression(t,s){return new NodePart(t,s)}}const H=new DefaultTemplateProcessor;function templateFactory(t){let s=j.get(t.type);void 0===s&&(s={stringsArray:new WeakMap,keyString:new Map},j.set(t.type,s));let r=s.stringsArray.get(t.strings);if(void 0!==r)return r;const l=t.strings.join(a);return r=s.keyString.get(l),void 0===r&&(r=new Template(t,t.getTemplateElement()),s.keyString.set(l,r)),s.stringsArray.set(t.strings,r),r}const j=new Map,W=new WeakMap,render=(t,s,r)=>{let a=W.get(s);void 0===a&&(removeNodes(s,s.firstChild),W.set(s,a=new NodePart(Object.assign({templateFactory:templateFactory},r),void 0)),a.appendInto(s)),a.setValue(t),a.commit()};"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.7");const html=(t,...s)=>new TemplateResult(t,s,"html",H),svg=(t,...s)=>new SVGTemplateResult(t,s,"svg",H);var F=Object.freeze({__proto__:null,html:html,svg:svg,DefaultTemplateProcessor:DefaultTemplateProcessor,defaultTemplateProcessor:H,directive:directive,Directive:Directive,isDirective:isDirective,removeNodes:removeNodes,reparentNodes:reparentNodes,noChange:s,nothing:r,AttributeCommitter:AttributeCommitter,AttributePart:AttributePart,BooleanAttributePart:BooleanAttributePart,EventPart:EventPart,isIterable:isIterable,isPrimitive:isPrimitive,NodePart:NodePart,PropertyCommitter:PropertyCommitter,PropertyPart:PropertyPart,get sanitizerFactory(){return L},setSanitizerFactory:t=>{if(L!==noopSanitizer)throw new Error("Attempted to overwrite existing lit-html security policy. setSanitizeDOMValueFactory should be called at most once.");L=t},parts:W,render:render,templateCaches:j,templateFactory:templateFactory,TemplateInstance:TemplateInstance,SVGTemplateResult:SVGTemplateResult,TemplateResult:TemplateResult,createMarker:createMarker,isTemplatePartActive:isTemplatePartActive,Template:Template}),__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s);function verb(r){s[r]=t[r]&&function(s){return new Promise((function(a,l){(function settle(t,s,r,a){Promise.resolve(a).then((function(s){t({value:s,done:r})}),s)})(a,l,(s=t[r](s)).done,s.value)}))}}};const B=directive((t,s)=>async r=>{var a,l;if(!(r instanceof NodePart))throw new Error("asyncAppend can only be used in text bindings");if(t===r.value)return;let h;r.value=t;let m=0;try{for(var b,x=__asyncValues(t);!(b=await x.next()).done;){let a=b.value;if(r.value!==t)break;0===m&&r.clear(),void 0!==s&&(a=s(a,m));let l=r.startNode;void 0!==h&&(l=createMarker(),h.endNode=l,r.endNode.parentNode.insertBefore(l,r.endNode)),h=new NodePart(r.options,r.templatePart),h.insertAfterNode(l),h.setValue(a),h.commit(),m++}}catch(t){a={error:t}}finally{try{b&&!b.done&&(l=x.return)&&await l.call(x)}finally{if(a)throw a.error}}});var __asyncValues$1=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s);function verb(r){s[r]=t[r]&&function(s){return new Promise((function(a,l){(function settle(t,s,r,a){Promise.resolve(a).then((function(s){t({value:s,done:r})}),s)})(a,l,(s=t[r](s)).done,s.value)}))}}};const U=directive((t,s)=>async r=>{var a,l;if(!(r instanceof NodePart))throw new Error("asyncReplace can only be used in text bindings");if(t===r.value)return;const h=new NodePart(r.options,r.templatePart);r.value=t;let m=0;try{for(var b,x=__asyncValues$1(t);!(b=await x.next()).done;){let a=b.value;if(r.value!==t)break;0===m&&(r.clear(),h.appendIntoPart(r)),void 0!==s&&(a=s(a,m)),h.setValue(a),h.commit(),m++}}catch(t){a={error:t}}finally{try{b&&!b.done&&(l=x.return)&&await l.call(x)}finally{if(a)throw a.error}}}),q=new WeakMap,K=directive(t=>s=>{if(!(s instanceof NodePart))throw new Error("cache can only be used in text bindings");let r=q.get(s);void 0===r&&(r=new WeakMap,q.set(s,r));const a=s.value;if(a instanceof TemplateInstance){if(t instanceof TemplateResult&&a.template===s.options.templateFactory(t))return void s.setValue(t);{let t=r.get(a.template);void 0===t&&(t={instance:a,nodes:document.createDocumentFragment()},r.set(a.template,t)),reparentNodes(t.nodes,s.startNode.nextSibling,s.endNode)}}if(t instanceof TemplateResult){const a=s.options.templateFactory(t),l=r.get(a);void 0!==l&&(s.setValue(l.nodes),s.commit(),s.value=l.instance)}s.setValue(t)}),Q=new WeakMap,J=directive(t=>s=>{if(!(s instanceof AttributePart)||s instanceof PropertyPart||"class"!==s.committer.name||s.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:r}=s,{element:a}=r;let l=Q.get(s);void 0===l&&(a.className=r.strings.join(" "),Q.set(s,l=new Set));const{classList:h}=a;l.forEach(s=>{s in t||(h.remove(s),l.delete(s))});for(const s in t){const r=t[s];r!=l.has(s)&&(r?(h.add(s),l.add(s)):(h.remove(s),l.delete(s)))}}),Z=new WeakMap,tt=directive((t,s)=>r=>{const a=Z.get(r);if(Array.isArray(t)){if(Array.isArray(a)&&a.length===t.length&&t.every((t,s)=>t===a[s]))return}else if(a===t&&(void 0!==t||Z.has(r)))return;r.setValue(s()),Z.set(r,Array.isArray(t)?Array.from(t):t)}),et=directive(t=>s=>{if(void 0===t&&s instanceof AttributePart){if(t!==s.value){const t=s.committer.name;s.committer.element.removeAttribute(t)}}else s.setValue(t)}),createAndInsertPart=(t,s)=>{const r=t.startNode.parentNode,a=null==s?t.endNode:s.startNode,l=r.insertBefore(createMarker(),a);r.insertBefore(createMarker(),a);const h=new NodePart(t.options,void 0);return h.insertAfterNode(l),h},updatePart=(t,s)=>(t.setValue(s),t.commit(),t),insertPartBefore=(t,s,r)=>{const a=t.startNode.parentNode,l=r?r.startNode:t.endNode,h=s.endNode.nextSibling;h!==l&&reparentNodes(a,s.startNode,h,l)},removePart=t=>{removeNodes(t.startNode.parentNode,t.startNode,t.endNode.nextSibling)},generateMap=(t,s,r)=>{const a=new Map;for(let l=s;l<=r;l++)a.set(t[l],l);return a},it=new WeakMap,nt=new WeakMap,st=directive((t,s,r)=>{let a;return void 0===r?r=s:void 0!==s&&(a=s),s=>{if(!(s instanceof NodePart))throw new Error("repeat can only be used in text bindings");const l=it.get(s)||[],h=nt.get(s)||[],m=[],b=[],x=[];let S,O,L=0;for(const s of t)x[L]=a?a(s,L):L,b[L]=r(s,L),L++;let z=0,G=l.length-1,H=0,j=b.length-1;for(;z<=G&&H<=j;)if(null===l[z])z++;else if(null===l[G])G--;else if(h[z]===x[H])m[H]=updatePart(l[z],b[H]),z++,H++;else if(h[G]===x[j])m[j]=updatePart(l[G],b[j]),G--,j--;else if(h[z]===x[j])m[j]=updatePart(l[z],b[j]),insertPartBefore(s,l[z],m[j+1]),z++,j--;else if(h[G]===x[H])m[H]=updatePart(l[G],b[H]),insertPartBefore(s,l[G],l[z]),G--,H++;else if(void 0===S&&(S=generateMap(x,H,j),O=generateMap(h,z,G)),S.has(h[z]))if(S.has(h[G])){const t=O.get(x[H]),r=void 0!==t?l[t]:null;if(null===r){const t=createAndInsertPart(s,l[z]);updatePart(t,b[H]),m[H]=t}else m[H]=updatePart(r,b[H]),insertPartBefore(s,r,l[z]),l[t]=null;H++}else removePart(l[G]),G--;else removePart(l[z]),z++;for(;H<=j;){const t=createAndInsertPart(s,m[j+1]);updatePart(t,b[H]),m[H++]=t}for(;z<=G;){const t=l[z++];null!==t&&removePart(t)}it.set(s,m),nt.set(s,x)}}),ot=new WeakMap,rt=document.createElement("template"),at=directive(t=>s=>{if(!(s instanceof NodePart))throw new Error("unsafeHTML can only be used in text bindings");const r=ot.get(s);if(void 0!==r&&isPrimitive(t)&&t===r.value&&s.value===r.fragment)return;const a=rt.cloneNode();a.innerHTML=t;const l=document.importNode(a.content,!0);s.setValue(l),ot.set(s,{value:t,fragment:l})}),lt=new WeakMap,ct=directive((...t)=>s=>{let r=lt.get(s);void 0===r&&(r={lastRenderedIndex:2147483647,values:[]},lt.set(s,r));const a=r.values;let l=a.length;r.values=t;for(let h=0;h<t.length&&!(h>r.lastRenderedIndex);h++){const m=t[h];if(isPrimitive(m)||"function"!=typeof m.then){s.setValue(m),r.lastRenderedIndex=h;break}h<l&&m===a[h]||(r.lastRenderedIndex=2147483647,l=0,Promise.resolve(m).then(t=>{const a=r.values.indexOf(m);a>-1&&a<r.lastRenderedIndex&&(r.lastRenderedIndex=a,s.setValue(t),s.commit())}))}}),dt=new WeakMap;class Detach extends Directive{constructor(t){super(),this.ifFn=t}body(t){const s=this.ifFn(),r=t.committer.element;if(s)dt.has(t)||dt.set(t,{element:r,nextSibling:r.nextSibling,previousSibling:r.previousSibling,parent:r.parentNode}),r.remove();else{const s=dt.get(t);s&&(s.nextSibling&&s.nextSibling.parentNode?s.nextSibling.parentNode.insertBefore(s.element,s.nextSibling):s.previousSibling&&s.previousSibling.parentNode?s.previousSibling.parentNode.appendChild(s.element):s.parent&&s.parent.appendChild(s.element),dt.delete(t))}}}class StyleMap extends Directive{constructor(t,s=!1){super(),this.toRemove=[],this.toUpdate=[],this.debug=!1,this.previous={},this.style=t,this.detach=s}setStyle(t){this.style=t}setDebug(t=!0){this.debug=t}setDetach(t){this.detach=t}body(t){this.toRemove.length=0,this.toUpdate.length=0;const s=t.committer.element,r=s.style;let a=this.previous;if(s.attributes.getNamedItem("style")){const t=s.attributes.getNamedItem("style").value.split(";").map(t=>t.substr(0,t.indexOf(":")).trim()).filter(t=>!!t);for(const s of t)void 0===this.style[s]&&(this.toRemove.includes(s)||this.toRemove.push(s))}for(const t in a)this.style.hasOwnProperty(t)&&void 0===this.style[t]&&(this.toRemove.includes(t)||this.toRemove.push(t));for(const t in this.style){if(!this.style.hasOwnProperty(t))continue;const s=this.style[t],r=a[t];void 0!==r&&r===s||this.toUpdate.push(t)}if(this.debug&&(console.log("[StyleMap] to remove",[...this.toRemove]),console.log("[StyleMap] to update",[...this.toUpdate])),this.toRemove.length||this.toUpdate.length){let t,a;this.detach&&(t=s.parentNode,t&&(a=s.nextSibling,s.remove()));for(const t of this.toRemove)r.removeProperty(t),r[t]&&delete r[t];for(const t of this.toUpdate){const s=this.style[t];t.includes("-")?r.setProperty(t,s):r[t]=s}this.detach&&t&&t.insertBefore(s,a),this.previous=Object.assign({},this.style)}}}class Action{constructor(){this.isAction=!0}}Action.prototype.isAction=!0;const ht={element:document.createTextNode(""),axis:"xy",threshold:10,onDown(t){},onMove(t){},onUp(t){},onWheel(t){}},ut="undefined"!=typeof PointerEvent;let pt=0;class PointerAction extends Action{constructor(t,s){super(),this.moving="",this.initialX=0,this.initialY=0,this.lastY=0,this.lastX=0,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onWheel=this.onWheel.bind(this),this.element=t,this.id=++pt,this.options=Object.assign(Object.assign({},ht),s.pointerOptions),ut?(t.addEventListener("pointerdown",this.onPointerDown),document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp)):(t.addEventListener("touchstart",this.onPointerDown),document.addEventListener("touchmove",this.onPointerMove,{passive:!1}),document.addEventListener("touchend",this.onPointerUp),document.addEventListener("touchcancel",this.onPointerUp),t.addEventListener("mousedown",this.onPointerDown),document.addEventListener("mousemove",this.onPointerMove,{passive:!1}),document.addEventListener("mouseup",this.onPointerUp))}normalizeMouseWheelEvent(t){let s=t.deltaX||0,r=t.deltaY||0,a=t.deltaZ||0;const l=t.deltaMode,h=parseInt(getComputedStyle(t.target).getPropertyValue("line-height"));let m=1;switch(l){case 1:m=h;break;case 2:m=window.height}return s*=m,r*=m,a*=m,{x:s,y:r,z:a,event:t}}onWheel(t){const s=this.normalizeMouseWheelEvent(t);this.options.onWheel(s)}normalizePointerEvent(t){let s={x:0,y:0,pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0,event:t};switch(t.type){case"wheel":const r=this.normalizeMouseWheelEvent(t);s.x=r.x,s.y=r.y,s.pageX=s.x,s.pageY=s.y,s.screenX=s.x,s.screenY=s.y,s.clientX=s.x,s.clientY=s.y;break;case"touchstart":case"touchmove":case"touchend":case"touchcancel":s.x=t.changedTouches[0].screenX,s.y=t.changedTouches[0].screenY,s.pageX=t.changedTouches[0].pageX,s.pageY=t.changedTouches[0].pageY,s.screenX=t.changedTouches[0].screenX,s.screenY=t.changedTouches[0].screenY,s.clientX=t.changedTouches[0].clientX,s.clientY=t.changedTouches[0].clientY;break;default:s.x=t.x,s.y=t.y,s.pageX=t.pageX,s.pageY=t.pageY,s.screenX=t.screenX,s.screenY=t.screenY,s.clientX=t.clientX,s.clientY=t.clientY}return s}onPointerDown(t){if("mousedown"===t.type&&0!==t.button)return;this.moving="xy";const s=this.normalizePointerEvent(t);this.lastX=s.x,this.lastY=s.y,this.initialX=s.x,this.initialY=s.y,this.options.onDown(s)}handleX(t){let s=t.x-this.lastX;return this.lastY=t.y,this.lastX=t.x,s}handleY(t){let s=t.y-this.lastY;return this.lastY=t.y,this.lastX=t.x,s}onPointerMove(t){if(""===this.moving||"mousemove"===t.type&&0!==t.button)return;const s=this.normalizePointerEvent(t);if("x|y"===this.options.axis){let r=0,a=0;("x"===this.moving||"xy"===this.moving&&Math.abs(s.x-this.initialX)>this.options.threshold)&&(this.moving="x",r=this.handleX(s)),("y"===this.moving||"xy"===this.moving&&Math.abs(s.y-this.initialY)>this.options.threshold)&&(this.moving="y",a=this.handleY(s)),this.options.onMove({movementX:r,movementY:a,x:s.x,y:s.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}else if("xy"===this.options.axis){let r=0,a=0;Math.abs(s.x-this.initialX)>this.options.threshold&&(r=this.handleX(s)),Math.abs(s.y-this.initialY)>this.options.threshold&&(a=this.handleY(s)),this.options.onMove({movementX:r,movementY:a,x:s.x,y:s.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}else if("x"===this.options.axis)("x"===this.moving||"xy"===this.moving&&Math.abs(s.x-this.initialX)>this.options.threshold)&&(this.moving="x",this.options.onMove({movementX:this.handleX(s),movementY:0,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t}));else if("y"===this.options.axis){let r=0;("y"===this.moving||"xy"===this.moving&&Math.abs(s.y-this.initialY)>this.options.threshold)&&(this.moving="y",r=this.handleY(s)),this.options.onMove({movementX:0,movementY:r,x:s.x,y:s.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}}onPointerUp(t){this.moving="";const s=this.normalizePointerEvent(t);this.options.onUp({movementX:0,movementY:0,x:s.x,y:s.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t}),this.lastY=0,this.lastX=0}destroy(t){ut?(t.removeEventListener("pointerdown",this.onPointerDown),document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp)):(t.removeEventListener("mousedown",this.onPointerDown),document.removeEventListener("mousemove",this.onPointerMove),document.removeEventListener("mouseup",this.onPointerUp),t.removeEventListener("touchstart",this.onPointerDown),document.removeEventListener("touchmove",this.onPointerMove),document.removeEventListener("touchend",this.onPointerUp),document.removeEventListener("touchcancel",this.onPointerUp))}}function schedule(t){let s=0;return function wrapperFn(r){s||(s=requestAnimationFrame((function executeFrame(){s=0,t.apply(void 0,[r])})))}}function isObject(t){return t&&"object"==typeof t&&t.constructor&&"Object"===t.constructor.name}function mergeDeep(t,...s){const r=s.shift();if(isObject(t)&&isObject(r))for(const s in r)if(isObject(r[s]))"function"==typeof r[s].clone?t[s]=r[s].clone():(void 0===t[s]&&(t[s]={}),t[s]=mergeDeep(t[s],r[s]));else if(Array.isArray(r[s])){t[s]=new Array(r[s].length);let a=0;for(let l of r[s])isObject(l)?"function"==typeof l.clone?t[s][a]=l.clone():t[s][a]=mergeDeep({},l):t[s][a]=l,a++}else t[s]=r[s];return s.length?mergeDeep(t,...s):t}function clone(t){if(void 0!==t.actions){const s=t.actions.map(t=>{const s=Object.assign({},t),r=Object.assign({},s.props);return delete r.state,delete r.api,delete s.element,s.props=r,s});t.actions=s}return mergeDeep({},t)}var mt={mergeDeep:mergeDeep,clone:clone,schedule:schedule};class Slots{constructor(t,s){this.slotInstances={},this.destroyed=!1,this.vido=t,this.props=s,this.destroy=this.destroy.bind(this),this.change=this.change.bind(this),this.html=this.html.bind(this),this.getInstances=this.getInstances.bind(this),this.setComponents=this.setComponents.bind(this),this.vido.onDestroy(()=>{this.destroy()})}setComponents(t){if(t&&!this.destroyed){for(const s in t){const r=t[s];void 0===this.slotInstances[s]&&(this.slotInstances[s]=[]);for(const t of this.slotInstances[s])t.destroy();this.slotInstances[s].length=0;for(const t of r)this.slotInstances[s].push(this.vido.createComponent(t,this.props))}this.vido.update()}}destroy(){if(!this.destroyed){for(const t in this.slotInstances){for(const s of this.slotInstances[t])s.destroy();this.slotInstances[t].length=0}this.destroyed=!0}}change(t,s){if(!this.destroyed)for(const r in this.slotInstances){const a=this.slotInstances[r];for(const r of a)r.change(t,s)}}getInstances(t){if(!this.destroyed)return void 0===t?this.slotInstances:this.slotInstances[t]}html(t,s){if(!this.destroyed)return this.slotInstances[t].map(t=>t.html(s))}getProps(){return this.props}isDestroyed(){return this.destroyed}}function Vido(t,s){let r=0;const a=new Map;let l,h,m=new Map,b=0;const x=[],S=Promise.resolve(),O={},L=function getActionsCollector(t){return class ActionsCollector extends Directive{constructor(t){super(),this.instance=t}set(t,s){return this.actions=t,this.props=s,this}body(s){const r=s.committer.element;for(const s of this.actions)if(void 0!==s){let a;if(t.has(this.instance))for(const l of t.get(this.instance))if(l.componentAction.create===s&&l.element===r){a=l;break}if(a)a.props=this.props;else{void 0!==r.vido&&delete r.vido;const a={create:s,update(){},destroy(){}},l={instance:this.instance,componentAction:a,element:r,props:this.props};let h=[];t.has(this.instance)&&(h=t.get(this.instance)),h.push(l),t.set(this.instance,h)}}}}}(m);class InstanceActionsCollector{constructor(t){this.instance=t}create(t,s){const r=new L(this.instance);return r.set(t,s),r}}const z=function getPublicComponentMethods(t,s,r){return class PublicComponentMethods{constructor(t,s,r={}){this.instance=t,this.name=s.name,this.vidoInstance=s,this.props=r,this.destroy=this.destroy.bind(this),this.update=this.update.bind(this),this.change=this.change.bind(this),this.html=this.html.bind(this)}destroy(){return this.vidoInstance.debug&&(console.groupCollapsed(`destroying component ${this.instance}`),console.log(r({components:t.keys(),actionsByInstance:s})),console.trace(),console.groupEnd()),this.vidoInstance.destroyComponent(this.instance,this.vidoInstance)}update(a){return this.vidoInstance.debug&&(console.groupCollapsed(`updating component ${this.instance}`),console.log(r({components:t.keys(),actionsByInstance:s})),console.trace(),console.groupEnd()),this.vidoInstance.updateTemplate(a)}change(a,l){this.vidoInstance.debug&&(console.groupCollapsed(`changing component ${this.instance}`),console.log(r({props:this.props,newProps:a,components:t.keys(),actionsByInstance:s})),console.trace(),console.groupEnd());const h=t.get(this.instance);h&&h.change(a,l)}html(s={}){const r=t.get(this.instance);if(r)return r.update(s,this.vidoInstance)}_getComponents(){return t}_getActions(){return s}}}(a,m,clone),G=function getInternalComponentMethods(t,s,r){return class InternalComponentMethods{constructor(t,s,r,a){this.instance=t,this.vidoInstance=s,this.renderFunction=r,this.content=a,this.destroy=this.destroy.bind(this),this.update=this.update.bind(this),this.change=this.change.bind(this)}destroy(){var a;this.vidoInstance.debug&&(console.groupCollapsed(`component destroy method fired ${this.instance}`),console.log(r({props:this.vidoInstance.props,components:t.keys(),destroyable:this.vidoInstance.destroyable,actionsByInstance:s})),console.trace(),console.groupEnd()),"function"==typeof(null===(a=this.content)||void 0===a?void 0:a.destroy)&&this.content.destroy();for(const t of this.vidoInstance.destroyable)t();this.vidoInstance.onChangeFunctions.length=0,this.vidoInstance.destroyable.length=0,this.vidoInstance.destroyed=!0,this.vidoInstance.update()}update(a={}){return this.vidoInstance.debug&&(console.groupCollapsed(`component update method fired ${this.instance}`),console.log(r({components:t.keys(),actionsByInstance:s})),console.trace(),console.groupEnd()),this.renderFunction(a)}change(a,l={leave:!1}){const h=a;this.vidoInstance.debug&&(console.groupCollapsed(`component change method fired ${this.instance}`),console.log(r({props:h,components:t.keys(),onChangeFunctions:this.vidoInstance.onChangeFunctions,changedProps:a,actionsByInstance:s})),console.trace(),console.groupEnd());for(const t of this.vidoInstance.onChangeFunctions)t(a,l)}}}(a,m,clone);class VidoInstance{constructor(){this.destroyable=[],this.onChangeFunctions=[],this.debug=!1,this.state=t,this.api=s,this.lastProps={},this.html=html,this.svg=svg,this.directive=directive,this.asyncAppend=B,this.asyncReplace=U,this.cache=K,this.classMap=J,this.guard=tt,this.ifDefined=et,this.repeat=st,this.unsafeHTML=at,this.until=ct,this.schedule=schedule,this.actionsByInstance=(t,s)=>{},this.StyleMap=StyleMap,this.Detach=Detach,this.PointerAction=PointerAction,this.Action=Action,this.Slots=Slots,this._components=a,this._actions=m,this.reuseComponents=this.reuseComponents.bind(this),this.onDestroy=this.onDestroy.bind(this),this.onChange=this.onChange.bind(this),this.update=this.update.bind(this),this.destroyComponent=this.destroyComponent.bind(this);for(const t in O)this[t]=O[t].bind(this)}static addMethod(t,s){O[t]=s}onDestroy(t){this.destroyable.push(t)}onChange(t){this.onChangeFunctions.push(t)}update(t){return this.updateTemplate(t)}reuseComponents(t,s,r,a,l=!0,h=!1){const m=[],b=t.length,x=s.length;let S=!1;!l||void 0!==s&&0!==s.length||(S=!0);let O=0;if(b<x){let l=x-b;for(;l;){const h=s[x-l],b=this.createComponent(a,r(h));t.push(b),m.push(b),l--}}else if(b>x){let s=b-x;for(l&&(S=!0,O=b-s);s;){const r=b-s;l||(m.push(t[r]),t[r].destroy()),s--}l||(t.length=x)}let L=0;h&&console.log("modified components",m),h&&console.log("current components",t),h&&console.log("data array",s);for(const a of t){const t=s[L];h&&console.log(`reuse components data at '${L}'`,t),a&&!m.includes(a)&&(h&&console.log("getProps fn result",r(t)),a.change(r(t),{leave:S&&L>=O})),L++}}createComponent(t,s={},l=null){const h=t.name+":"+r++;let b;b=new VidoInstance,b.instance=h,b.name=t.name,b.Actions=new InstanceActionsCollector(h);const x=new z(h,b,s),S=new G(h,b,t(b,s,l),l);return a.set(h,S),a.get(h).change(s),b.debug&&(console.groupCollapsed(`component created ${h}`),console.log(clone({props:s,components:a.keys(),actionsByInstance:m})),console.trace(),console.groupEnd()),x}destroyComponent(t,s){if(s.debug&&(console.groupCollapsed(`destroying component ${t}...`),console.log(clone({components:a.keys(),actionsByInstance:m})),console.trace(),console.groupEnd()),m.has(t))for(const s of m.get(t))"function"==typeof s.componentAction.destroy&&s.componentAction.destroy(s.element,s.props);m.delete(t);const r=a.get(t);r?(r.update(),r.destroy(),a.delete(t),s.debug&&(console.groupCollapsed(`component destroyed ${t}`),console.log(clone({components:a.keys(),actionsByInstance:m})),console.trace(),console.groupEnd())):console.warn(`No component to destroy! [${t}]`)}executeActions(){var t,s,r;for(const a of m.values()){for(const l of a)if(void 0===l.element.vido){const a=l.componentAction,h=a.create;if(void 0!==h){let m;m=!0!==(null===(t=h.prototype)||void 0===t?void 0:t.isAction)&&void 0===h.isAction&&void 0===(null===(s=h.prototype)||void 0===s?void 0:s.update)&&void 0===(null===(r=h.prototype)||void 0===r?void 0:r.destroy)?h(l.element,l.props):new h(l.element,l.props),void 0!==m&&("function"==typeof m?a.destroy=m:("function"==typeof m.update&&(a.update=m.update.bind(m)),"function"==typeof m.destroy&&(a.destroy=m.destroy.bind(m))))}}else l.element.vido=l.props,"function"==typeof l.componentAction.update&&l.componentAction.update(l.element,l.props);for(const t of a)t.element.vido=t.props}}updateTemplate(t){return t&&x.push(t),new Promise(t=>{const s=++b,r=this;S.then((function flush(){if(s===b){b=0,r.render();for(const t of x)t();x.length=0,t()}}))})}createApp(t){h=t.element;const s=this.createComponent(t.component,t.props);return l=s.instance,this.render(),s}render(){const t=a.get(l);t?(render(t.update(),h),this.executeActions()):h&&h.remove()}}return new VidoInstance}function __awaiter(t,s,r,a){return new(r||(r=Promise))((function(l,h){function fulfilled(t){try{step(a.next(t))}catch(t){h(t)}}function rejected(t){try{step(a.throw(t))}catch(t){h(t)}}function step(t){t.done?l(t.value):function adopt(t){return t instanceof r?t:new r((function(s){s(t)}))}(t.value).then(fulfilled,rejected)}step((a=a.apply(t,s||[])).next())}))}Vido.prototype.lithtml=F,Vido.prototype.Action=Action,Vido.prototype.Directive=Directive,Vido.prototype.schedule=schedule,Vido.prototype.Detach=Detach,Vido.prototype.StyleMap=StyleMap,Vido.prototype.PointerAction=PointerAction,Vido.prototype.asyncAppend=B,Vido.prototype.asyncReplace=U,Vido.prototype.cache=K,Vido.prototype.classMap=J,Vido.prototype.guard=tt,Vido.prototype.ifDefined=et,Vido.prototype.repeat=st,Vido.prototype.unsafeHTML=at,Vido.prototype.until=ct,Vido.prototype.Slots=Slots;var ft=function(){if("undefined"!=typeof Map)return Map;function getIndex(t,s){var r=-1;return t.some((function(t,a){return t[0]===s&&(r=a,!0)})),r}return function(){function class_1(){this.__entries__=[]}return Object.defineProperty(class_1.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),class_1.prototype.get=function(t){var s=getIndex(this.__entries__,t),r=this.__entries__[s];return r&&r[1]},class_1.prototype.set=function(t,s){var r=getIndex(this.__entries__,t);~r?this.__entries__[r][1]=s:this.__entries__.push([t,s])},class_1.prototype.delete=function(t){var s=this.__entries__,r=getIndex(s,t);~r&&s.splice(r,1)},class_1.prototype.has=function(t){return!!~getIndex(this.__entries__,t)},class_1.prototype.clear=function(){this.__entries__.splice(0)},class_1.prototype.forEach=function(t,s){void 0===s&&(s=null);for(var r=0,a=this.__entries__;r<a.length;r++){var l=a[r];t.call(s,l[1],l[0])}},class_1}()}(),gt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,vt="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),bt="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(vt):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var yt=["top","right","bottom","left","width","height","size","weight"],wt="undefined"!=typeof MutationObserver,$t=function(){function ResizeObserverController(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function throttle(t,s){var r=!1,a=!1,l=0;function resolvePending(){r&&(r=!1,t()),a&&proxy()}function timeoutCallback(){bt(resolvePending)}function proxy(){var t=Date.now();if(r){if(t-l<2)return;a=!0}else r=!0,a=!1,setTimeout(timeoutCallback,s);l=t}return proxy}(this.refresh.bind(this),20)}return ResizeObserverController.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},ResizeObserverController.prototype.removeObserver=function(t){var s=this.observers_,r=s.indexOf(t);~r&&s.splice(r,1),!s.length&&this.connected_&&this.disconnect_()},ResizeObserverController.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},ResizeObserverController.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},ResizeObserverController.prototype.connect_=function(){gt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),wt?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},ResizeObserverController.prototype.disconnect_=function(){gt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},ResizeObserverController.prototype.onTransitionEnd_=function(t){var s=t.propertyName,r=void 0===s?"":s;yt.some((function(t){return!!~r.indexOf(t)}))&&this.refresh()},ResizeObserverController.getInstance=function(){return this.instance_||(this.instance_=new ResizeObserverController),this.instance_},ResizeObserverController.instance_=null,ResizeObserverController}(),defineConfigurable=function(t,s){for(var r=0,a=Object.keys(s);r<a.length;r++){var l=a[r];Object.defineProperty(t,l,{value:s[l],enumerable:!1,writable:!1,configurable:!0})}return t},getWindowOf=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||vt},Pt=createRectInit(0,0,0,0);function toFloat(t){return parseFloat(t)||0}function getBordersSize(t){for(var s=[],r=1;r<arguments.length;r++)s[r-1]=arguments[r];return s.reduce((function(s,r){return s+toFloat(t["border-"+r+"-width"])}),0)}function getHTMLElementContentRect(t){var s=t.clientWidth,r=t.clientHeight;if(!s&&!r)return Pt;var a=getWindowOf(t).getComputedStyle(t),l=function getPaddings(t){for(var s={},r=0,a=["top","right","bottom","left"];r<a.length;r++){var l=a[r],h=t["padding-"+l];s[l]=toFloat(h)}return s}(a),h=l.left+l.right,m=l.top+l.bottom,b=toFloat(a.width),x=toFloat(a.height);if("border-box"===a.boxSizing&&(Math.round(b+h)!==s&&(b-=getBordersSize(a,"left","right")+h),Math.round(x+m)!==r&&(x-=getBordersSize(a,"top","bottom")+m)),!function isDocumentElement(t){return t===getWindowOf(t).document.documentElement}(t)){var S=Math.round(b+h)-s,O=Math.round(x+m)-r;1!==Math.abs(S)&&(b-=S),1!==Math.abs(O)&&(x-=O)}return createRectInit(l.left,l.top,b,x)}var _t="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof getWindowOf(t).SVGGraphicsElement}:function(t){return t instanceof getWindowOf(t).SVGElement&&"function"==typeof t.getBBox};function getContentRect(t){return gt?_t(t)?function getSVGContentRect(t){var s=t.getBBox();return createRectInit(0,0,s.width,s.height)}(t):getHTMLElementContentRect(t):Pt}function createRectInit(t,s,r,a){return{x:t,y:s,width:r,height:a}}var Tt=function(){function ResizeObservation(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=createRectInit(0,0,0,0),this.target=t}return ResizeObservation.prototype.isActive=function(){var t=getContentRect(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},ResizeObservation.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},ResizeObservation}(),Ct=function Ct(t,s){var r=function createReadOnlyRect(t){var s=t.x,r=t.y,a=t.width,l=t.height,h="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,m=Object.create(h.prototype);return defineConfigurable(m,{x:s,y:r,width:a,height:l,top:r,right:s+a,bottom:l+r,left:s}),m}(s);defineConfigurable(this,{target:t,contentRect:r})},St=function(){function ResizeObserverSPI(t,s,r){if(this.activeObservations_=[],this.observations_=new ft,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=s,this.callbackCtx_=r}return ResizeObserverSPI.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof getWindowOf(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var s=this.observations_;s.has(t)||(s.set(t,new Tt(t)),this.controller_.addObserver(this),this.controller_.refresh())}},ResizeObserverSPI.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof getWindowOf(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var s=this.observations_;s.has(t)&&(s.delete(t),s.size||this.controller_.removeObserver(this))}},ResizeObserverSPI.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},ResizeObserverSPI.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(s){s.isActive()&&t.activeObservations_.push(s)}))},ResizeObserverSPI.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,s=this.activeObservations_.map((function(t){return new Ct(t.target,t.broadcastRect())}));this.callback_.call(t,s,t),this.clearActive()}},ResizeObserverSPI.prototype.clearActive=function(){this.activeObservations_.splice(0)},ResizeObserverSPI.prototype.hasActive=function(){return this.activeObservations_.length>0},ResizeObserverSPI}(),Dt="undefined"!=typeof WeakMap?new WeakMap:new ft,Et=function ResizeObserver(t){if(!(this instanceof ResizeObserver))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var s=$t.getInstance(),r=new St(t,s,this);Dt.set(this,r)};["observe","unobserve","disconnect"].forEach((function(t){Et.prototype[t]=function(){var s;return(s=Dt.get(this))[t].apply(s,arguments)}}));var Mt=void 0!==vt.ResizeObserver?vt.ResizeObserver:Et;function Main(t,s={}){const{api:r,state:a,onDestroy:l,Actions:h,update:m,createComponent:b,html:x,StyleMap:S}=t,O=r.name,L=[];function destroyPlugins(){L.forEach(t=>t()),L.length=0}l(a.subscribe("config.plugins",s=>{if(destroyPlugins(),void 0!==s&&Array.isArray(s))for(const r of s){const s=r(t);"function"==typeof s?L.push(s):s&&s.hasOwnProperty("destroy")&&L.push(s.destroy)}})),l(destroyPlugins);const z=[];let G,H;z.push(a.subscribe("config.components.List",t=>G=t)),z.push(a.subscribe("config.components.Chart",t=>H=t));const j=b(G);l(()=>{j&&j.destroy()});const W=b(H);let F,B,U;l(()=>{W&&W.destroy()}),l(()=>{z.forEach(t=>t())}),l(a.subscribe("config.wrappers.Main",t=>F=t)),l(a.subscribe("config.actions.main",t=>B=t));const q=new S({});let K=0,Q=!1,J=-1,Z=!1;l(a.subscribe("config.classNames",(function updateClassNames(){U=r.getClass(O),Q&&(U+=` ${O}__list-column-header-resizer--active`),m()}))),l(a.subscribeAll(["config.height","config.innerHeight","config.headerHeight","config.scroll.horizontal.size"],(function heightChange(){const t=a.get("config"),s=a.get("config.scroll.horizontal.size"),r=t.height-t.headerHeight-s;a.update("$data.innerHeight",r),q.style["--height"]=t.height+"px",m()}))),l(a.subscribe("$data.list.columns.resizer.active",(function resizerActiveChange(t){Q=t,U=r.getClass(r.name),Q&&(U+=` ${r.name}__list-column-header-resizer--active`),m()})));let tt=!1;function generateTree(t=null,s=null){if(s&&"subscribe"===s.type)return;"reload"===t&&(tt=!1);const l=a.get("config.list.rows");tt||r.fillEmptyRowValues(l);const h=a.get("config.chart.items");tt||r.prepareItems(h),tt=!0,a.update("$data.treeMap",r.makeTreeMap(l,h)),m()}let et=0;function prepareExpandedCalculateRowHeightsAndFixOverlapped(){const t=a.get("config.list.rows");if(!t)return;const s=r.getRowsWithParentsExpanded(t);K=r.recalculateRowsHeightsAndFixOverlappingItems(s);const l=a.get("config.scroll.vertical.area");r.recalculateRowsPercents(s,l),a.multi().update("$data.list.rowsHeight",K,{force:!0}).update("$data.list.rowsWithParentsExpanded",s).done(),m()}function calculateHeightRelatedThings(){const t=a.get("$data.list.rowsWithParentsExpanded"),s=a.get("$data.list.rowsHeight");if(s===J)return;J=s;const r=function getLastPageRowsHeight(t,s){if(0===s.length)return 0;let r=0,l=0;for(let a=s.length-1;a>=0;a--){const h=s[a];if(r+=h.$data.outerHeight,r>=t){r-=h.$data.outerHeight;break}l++}return a.multi().update("config.scroll.vertical.lastPageSize",r,{force:!0}).update("config.scroll.vertical.lastPageCount",l,{force:!0}).done(),r}(a.get("$data.innerHeight"),t);a.multi().update("config.scroll.vertical.area",s,{force:!0}).update("config.scroll.vertical.areaWithoutLastPage",s-r,{force:!0}).done()}function calculateVisibleRowsHeights(){const t=a.get("config.scroll.vertical.offset")||0,s=a.get("$data.list.visibleRows");let l=0;for(const t of s)l+=r.recalculateRowHeight(t);a.update("$data.list.visibleRowsHeight",l+t)}function generatePeriodDates(s,a,l,h){const m=s.period;let b=a.from,x=r.time.date(b).startOf(m);const S=r.time.date(a.to).endOf(m),O=r.time.generatePeriodDates({leftDate:x,rightDate:S,level:l,levelIndex:h,period:m,time:a,callOnDate:!1,callOnLevelDates:!0}),L=r.getClass("chart-calendar-date");for(const r of O)r.formatted=s.format({timeStart:r.leftGlobalDate,timeEnd:r.rightGlobalDate,vido:t,className:L,props:{date:r}});return O}function triggerLoadedEvent(){Z||Promise.resolve().then(()=>{const t=a.get("$data.elements.main"),s=t.parentNode,r=new Event("gstc-loaded");t.dispatchEvent(r),s.dispatchEvent(r),Z=!0})}function guessPeriod(t,s){if(!t.zoom)return t;for(const r of s){const s=r.formats.find(s=>+t.zoom<=+s.zoomTo);s&&r.main&&(t.period=s.period)}return t}function calculateDatesPercents(t,s){const r=function getLastPageDatesWidth(t,s){if(0===s.length)return 0;let r=0,l=0;for(let a=s.length-1;a>=0;a--){const h=s[a];if(r+=h.width,r>=t){r-=h.width;break}l++}return a.update("config.scroll.horizontal",t=>(t.lastPageSize=r,t.lastPageCount=l,t)),r}(s,t);let l=0;for(const s of t)l+=s.width;const h=l-r;for(const s of t)s.leftPercent=s.leftPx/h,s.rightPercent=s.rightPx/h;return h}function generateAllDates(t,s,r){if(!t.zoom)return 0;t.allDates=new Array(s.length);const a=s[t.level],l=a.formats.find(s=>+t.zoom<=+s.zoomTo);t.allDates[t.level]=generatePeriodDates(l,t,a,t.level);let h=0;for(const r of s){if(!r.main){const s=r.formats.find(s=>+t.zoom<=+s.zoomTo);t.allDates[h]=generatePeriodDates(s,t,r,h)}h++}return calculateDatesPercents(t.allDates[t.level],r)}function getPeriodDates(t,s){if(!t.length)return[];const a=t.filter(t=>t.leftGlobal>=s.leftGlobal&&t.leftGlobal<=s.rightGlobal||t.rightGlobal>=s.leftGlobal&&t.rightGlobal<=s.rightGlobal||t.leftGlobal<=s.leftGlobal&&t.rightGlobal>=s.rightGlobal||t.leftGlobal>=s.leftGlobal&&t.rightGlobal<=s.rightGlobal);if(!a.length)return[];let l=0;a[0].period!==s.period&&s.leftGlobal>a[0].leftGlobal&&(l=r.time.getDatesDiffPx(s.leftGlobalDate,a[0].leftGlobalDate,s,!1));let h=0;const m=a.length-1;return a.map((t,r)=>(t.currentView={leftPx:h,rightPx:t.rightPx,width:t.width},l<0&&(t.currentView.width=t.width+l,t.currentView.leftPx=0,l=0),t.currentView.rightPx=t.currentView.leftPx+t.currentView.width,h+=t.currentView.width,r===m&&t.currentView.rightPx>s.width&&(t.currentView.rightPx=s.width,t.currentView.width=t.currentView.rightPx-t.currentView.leftPx),t))}function calculateTotalViewDuration(t){let s=0,r=0;for(const a of t.allDates[t.level])s+=a.width,r+=a.rightGlobal-a.leftGlobal;t.totalViewDurationPx=s,t.totalViewDurationMs=r}function calculateRightGlobal(t,s,a){const l=r.time.findDateAtTime(t,a);if(!l)return t;let h=a.indexOf(l),m=l.leftGlobal,b=0;for(let t=a.length;h<t;h++){const t=a[h];if(m=t.leftGlobal,b+=t.width,b>=s)break}return m}function updateVisibleItems(t=a.get("$data.chart.time"),s=a.multi()){const l=a.get("$data.chart.visibleItems");if(!l)return s;const h=a.get("config.list.rows");if(!h)return s;if(!t.levels||!t.levels[t.level])return s;const m=a.get("config.chart.spacing")||0;for(const a of l){const l=h[a.rowId];if(!l||!l.$data)continue;const b=r.time.getViewOffsetPxFromDates(a.$data.time.startDate,!1,t),x=r.time.getViewOffsetPxFromDates(a.$data.time.endDate,!1,t),S=a.$data.position.top+a.gap.top,O=l.$data.position.viewTop+a.$data.position.actualTop,L=a.$data.position;L.left===b&&L.right===x&&L.actualTop===S&&L.viewTop===O||(s=s.update(`config.chart.items.${a.id}.$data`,(function(s){if(s)return s.position.left=b,s.position.actualLeft=r.time.limitOffsetPxToView(b,t),s.position.right=x,s.position.actualRight=r.time.limitOffsetPxToView(x,t),s.width=x-b-m,s.actualWidth=s.position.actualRight-s.position.actualLeft-m,s.position.actualTop=S,s.position.viewTop=O,s}),{data:{updateVisibleItems:!0}}))}return s}function recalculateTimes(t){const s=a.get("$data.chart.dimensions.width");if(!s)return;const l=a.get("config.chart.time"),h=a.get("config.chart.calendar"),b=Object.assign({},a.get("$data.chart.time"));let x=r.mergeDeep({},l);if(!(x.from&&x.to||Object.keys(a.get("config.chart.items")).length))return;x.fromDate=r.time.date(x.from),x.toDate=r.time.date(x.to);const S=h.levels.find(t=>t.main);if(!S)throw new Error("Main calendar level not found (config.chart.calendar.levels).");const O=h.levels.indexOf(S);if(x.level=O,!x.calculatedZoomMode){if(x.period!==b.period){let t=S.formats.find(t=>t.period===x.period&&t.default);t&&(x.zoom=t.zoomTo)}guessPeriod(x,h.levels)}let L=a.get("config.scroll.horizontal"),z=0;if(x.calculatedZoomMode&&s){if(x.totalViewDurationMs=r.time.date(x.to).diff(x.from,"millisecond"),x.timePerPixel=x.totalViewDurationMs/s,x.zoom=Math.log(x.timePerPixel)/Math.log(2),guessPeriod(x,h.levels),b.zoom!==x.zoom||0===x.allDates.length||"forceUpdate"===t.name||"items"===t.name||"reload"===t.name){z=generateAllDates(x,h.levels,s),calculateTotalViewDuration(x);const t=x.allDates[x.level];x.to=t[t.length-1].rightGlobal,x.toDate=r.time.date(x.to)}x.leftGlobal=x.from,x.leftGlobalDate=r.time.date(x.leftGlobal),x.rightGlobal=x.to,x.rightGlobalDate=r.time.date(x.rightGlobal)}else if(x.timePerPixel=Math.pow(2,x.zoom),"items"===t.name&&(x.from=t.from,x.to=t.to,x.fromDate=r.time.date(x.from),x.toDate=r.time.date(x.to)),x=r.time.recalculateFromTo(x,t),b.zoom!==x.zoom||0===x.allDates.length||"forceUpdate"===t.name||"items"===t.name||"reload"===t.name){z=generateAllDates(x,h.levels,s),calculateTotalViewDuration(x);const t=x.allDates[x.level];x.to=t[t.length-1].rightGlobal,x.toDate=r.time.date(x.to)}else x.totalViewDurationPx=b.totalViewDurationPx,x.totalViewDurationMs=b.totalViewDurationMs;x.scrollWidth=z||b.scrollWidth;const G=x.allDates[O];let H=!1;const j=a.get("$data.chart.time.recalculateTimesLastReason")||"";if(!x.calculatedZoomMode)if(x.zoom===b.zoom&&"period"!==t.name||!b.centerGlobal){let t=L.data;t||(t=G[0]),x.leftGlobalDate=t.leftGlobalDate,x.leftGlobal=x.leftGlobalDate.valueOf(),x.rightGlobal=calculateRightGlobal(x.leftGlobal,s,G),x.rightGlobalDate=r.time.date(x.rightGlobal).endOf(x.period),x.rightGlobal=x.rightGlobal.valueOf(),H="zoom"!==j&&"period"!==j&&"time"!==j}else{const t=s*x.timePerPixel,a=Math.round(t/2),l=Math.ceil(b.centerGlobalDate.diff(b.centerGlobal+a,x.period,!0));x.leftGlobalDate=b.centerGlobalDate.add(l,x.period);const h=x.leftGlobalDate.valueOf();let m=r.time.findDateAtTime(h,G);m||(m=G[0]),x.leftGlobal=m.leftGlobal,x.leftGlobalDate=m.leftGlobalDate,x.rightGlobal=calculateRightGlobal(x.leftGlobal,s,G),x.rightGlobalDate=r.time.date(x.rightGlobal).endOf(x.period),x.rightGlobal=x.rightGlobalDate.valueOf()}!function limitGlobal(t,s,a){return t.leftGlobal<t.from&&(t.leftGlobal=t.from),t.rightGlobal>t.to&&(t.rightGlobal=t.to),t.leftGlobalDate=r.time.date(t.leftGlobal).startOf(t.period),t.leftGlobal=t.leftGlobalDate.valueOf(),t.rightGlobalDate=r.time.date(t.rightGlobal).endOf(t.period),t.rightGlobal=t.rightGlobalDate.valueOf(),t.centerGlobal=s.centerGlobal,t.centerGlobalDate=s.centerGlobalDate,t}(x,b),x.leftInner=x.leftGlobal-x.from,x.rightInner=x.rightGlobal-x.from,x.leftPx=0,x.rightPx=s,x.width=s,function updateLevels(t,s){t.levels=[];let r=0;for(const a of s){const s=a.formats.find(s=>+t.zoom<=+s.zoomTo);if(a.main&&(t.format=s,t.level=r),s){let l=getPeriodDates(t.allDates[r],t);t.onCurrentViewLevelDates.forEach(h=>{l=h({dates:l,format:s,time:t,level:a,levelIndex:r})}),t.levels.push(l)}r++}}(x,h.levels),H&&function setCenter(t){let s=Math.floor(t.rightGlobalDate.diff(t.leftGlobalDate,"millisecond",!0)/2);const a=r.time.getRightViewDate(t);a.width!==a.currentView.width&&(s-=(a.width-a.currentView.width)*t.timePerPixel),t.centerGlobalDate=t.leftGlobalDate.add(s,"millisecond"),t.centerGlobal=t.centerGlobalDate.valueOf()}(x);const W=x.levels[x.level];W&&W.length&&(x.leftPx=W[0].leftPx,x.rightPx=W[W.length-1].leftPx);let F=a.multi().update("$data.chart.time",x).update("config.chart.time",t=>(t.zoom=x.zoom,t.period=x.format.period,t.leftGlobal=x.leftGlobal,t.centerGlobal=x.centerGlobal,t.rightGlobal=x.rightGlobal,t.from=x.from,t.to=x.to,t.allDates=x.allDates,t.additionalSpaceAdded=x.additionalSpaceAdded,t));F=updateVisibleItems(x,F),F=F.update("$data.chart.time.recalculateTimesLastReason",t.name),F.done(),m(()=>{Z||setTimeout(triggerLoadedEvent,0)})}l(a.subscribeAll(["config.chart.items;","config.list.rows;"],(t,s)=>{++et,generateTree("reload"),prepareExpandedCalculateRowHeightsAndFixOverlapped(),calculateHeightRelatedThings(),calculateVisibleRowsHeights(),a.update("config.scroll",t=>(t.horizontal.dataIndex=0,t.horizontal.data=null,t.horizontal.posPx=0,t.vertical.dataIndex=0,t.vertical.data=null,t.vertical.posPx=0,t)),2===et&&"subscribe"!==s.type&&(Z=!1),recalculateTimes({name:"reload"}),2===et&&(et=0)})),l(a.subscribeAll(["config.list.rows.*.parentId","config.chart.items.*.rowId"],()=>{generateTree(),calculateHeightRelatedThings(),calculateVisibleRowsHeights()},{bulk:!0})),l(a.subscribeAll(["config.list.rows.*.expanded","config.chart.items.*.height","config.chart.items.*.rowId","config.list.rows.*.$data.outerHeight","config.scroll.vertical.area"],prepareExpandedCalculateRowHeightsAndFixOverlapped,{bulk:!0})),l(a.subscribeAll(["$data.innerHeight","$data.list.rowsHeight"],calculateHeightRelatedThings)),l(a.subscribeAll(["config.chart.items.*.time","config.chart.items.*.$data.position","$data.list.visibleRows","config.scroll.vertical.offset"],calculateVisibleRowsHeights,{bulk:!0})),l(a.subscribeAll(["$data.list.rowsWithParentsExpanded","config.scroll.vertical.dataIndex","config.chart.items.*.rowId"],(function generateVisibleRowsAndItems(){const t=r.getVisibleRows(a.get("$data.list.rowsWithParentsExpanded")),s=a.get("$data.list.visibleRows");let l=!0;t.length!==s.length?l=!0:t.length&&(l=t.some((t,r)=>void 0===s[r]||t.id!==s[r].id)),l&&a.update("$data.list.visibleRows",t);const h=[];for(const s of t)for(const t of s.$data.items)h.push(t);const b=a.get("$data.chart.visibleItems");h.map(t=>t.id).join("|")!==b.map(t=>t.id).join("|")&&a.update("$data.chart.visibleItems",h),m()}),{bulk:!0})),l(a.subscribeAll(["$data.list.visibleRows;","$data.chart.visibleItems;","config.scroll.vertical","config.chart.items"],(t,s)=>{s.options.data&&s.options.data.updateVisibleItems||updateVisibleItems().done()},{bulk:!0,ignore:["config.chart.items.*.$data.detached","config.chart.items.*.selected"]}));const it={initialized:!1,zoom:0,period:"",scrollDataIndex:0,chartWidth:0,from:0,to:0};l(a.subscribeAll(["config.chart.time","$data.chart.time","config.chart.calendar.levels","config.scroll.horizontal.dataIndex","$data.chart.dimensions.width"],()=>{let t=function recalculationIsNeeded(){const t=a.get("config.chart.time"),s=a.get("config.scroll.horizontal.dataIndex"),r=a.get("$data.chart.dimensions.width"),l=Object.assign({},it);return it.zoom=t.zoom,it.period=t.period,it.from=t.from,it.to=t.to,it.scrollDataIndex=s,it.chartWidth=r,it.initialized?!0===t.forceUpdate?(a.update("config.chart.time.forceUpdate",!1),{name:"forceUpdate"}):t.zoom!==l.zoom?{name:"zoom",oldValue:l.zoom,newValue:t.zoom}:t.period!==l.period?{name:"period",oldValue:l.period,newValue:t.period}:t.from!==l.from?{name:"from",oldValue:l.from,newValue:t.from}:t.to!==l.to?{name:"to",oldValue:l.to,newValue:t.to}:s!==l.scrollDataIndex?{name:"scroll",oldValue:l.scrollDataIndex,newValue:s}:r!==l.chartWidth?{name:"chartWidth",oldValue:l.chartWidth,newValue:r}:{name:""}:(it.initialized=!0,{name:"all"})}();t.name&&recalculateTimes(t)},{bulk:!0})),l(a.subscribe("config.chart.items.:itemId.time",(t,s)=>{const r=a.get("$data.chart.time"),l=a.get(`config.chart.items.${s.params.itemId}`);if(l&&(l.time.start<r.from||l.time.end>r.to)){let t=r.from,s=r.to;l.time.start<r.from&&(t=l.time.start),l.time.end>r.to&&(s=l.time.end),recalculateTimes({name:"items",from:t,to:s})}}));try{const t=["stackblitz.io","codepen.io","cdpn.io","codesandbox.io","csb.app","jsrun.pro","jsrun.top","jsfiddle.net","jsbin.com"];let s=location.host;const r=s.split(".");if(r.length>2){for(let t=0,s=r.length-2;t<s;t++)r.shift();s=r.join(".")}const l=["192.","127.","test","demo","local"],h=["test","local","demo"];!0===a.get("config.usageStatistics")&&!localStorage.getItem("gstcus")&&function shouldSend(){return!t.includes(s)&&"localhost"!==location.hostname&&!function startsEnds(){for(let t=0,s=l.length;t<s;t++)if(location.hostname.startsWith(l[t]))return!0;for(let t=0,s=h.length;t<s;t++)if(location.hostname.endsWith(h[t]))return!0;return!1}()}()&&(fetch("https://gstc-us.neuronet.io/",{method:"POST",mode:"cors",credentials:"omit",redirect:"follow",body:JSON.stringify({location:{href:location.href,host:location.host}})}).catch(t=>{}),localStorage.setItem("gstcus","true"))}catch(t){}const nt={width:0,height:0};let st,ot,rt;class ResizeAction{constructor(t){st||(st=new Mt((s,r)=>{const l=t.clientWidth,h=t.clientHeight;nt.width===l&&nt.height===h||(nt.width=l,nt.height=h,a.update("$data.dimensions",nt))}),st.observe(t),a.update("$data.elements.main",t))}update(){}destroy(t){st.unobserve(t)}}function onWheel(t){const s=r.normalizeMouseWheelEvent(t);if(t.shiftKey||s.x){const t=s.x?s.x:s.y,a=r.getScrollLeft();return void(t>0?r.setScrollLeft(a.dataIndex+ot):r.setScrollLeft(a.dataIndex-ot))}const a=r.getScrollTop();s.y>0?r.setScrollTop(a.dataIndex+rt):r.setScrollTop(a.dataIndex-rt)}B.includes(ResizeAction)||B.push(ResizeAction),l(()=>{st.disconnect()}),l(a.subscribe("config.scroll",t=>{ot=t.horizontal.multiplier,rt=t.vertical.multiplier}));const at=Object.assign(Object.assign({},s),{api:r,state:a}),lt=h.create(B,at),ct=r.generateSlots("main",t,s);return l(ct.destroy),r=>F(x`
        <div
          data-info-url="https://github.com/neuronetio/gantt-schedule-timeline-calendar"
          class=${U}
          style=${q}
          data-actions=${lt}
          @wheel=${onWheel}
        >
          ${ct.html("before",r)}${j.html()}${ct.html("inside",r)}${W.html()}${ct.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}function ScrollBar(t,s){const{onDestroy:r,state:a,api:l,html:h,StyleMap:m,Actions:b,update:x,schedule:S}=t;let O,L,z,G="",H="";r(a.subscribe("config.classNames",()=>{O=l.getClass("scroll-bar"),L=l.getClass("scroll-bar-inner")}));const j="horizontal"===s.type?"height":"width",W="height"===j?"width":"height",F="horizontal"===s.type?"left":"top",B=new m({}),U=new m({});let q=0,K=!1,Q=[],J=[],Z=0,tt=0,et=0,it=0;function getFullSize(){return"vertical"===s.type?J.length?J[J.length-1].$data.position.top+J[J.length-1].$data.outerHeight:0:Q.length?Q[Q.length-1].rightPx:0}"horizontal"===s.type&&r(a.subscribe("$data.chart.time",()=>{const t=a.get("$data.chart.time");if(t.leftGlobalDate&&(a.get("config.scroll.horizontal").area!==t.scrollWidth&&a.update("config.scroll.horizontal.area",t.scrollWidth),t.allDates&&t.allDates[t.level])){const s=t.allDates[t.level],r=s.find(s=>s.leftGlobal===t.leftGlobal);let h=s.indexOf(r);const m=a.get("config.scroll.horizontal.lastPageCount");h>s.length-m&&(h=s.length-m),l.setScrollLeft(h,t,void 0,"time")}}));const nt={maxPosPx:0,innerSize:0,sub:0,scrollArea:0};r(a.subscribeAll("horizontal"===s.type?[`config.scroll.${s.type}`,"$data.chart.time"]:[`config.scroll.${s.type}`,"$data.innerHeight","$data.list.rowsWithParentsExpanded;","$data.list.rowsHeight"],(function scrollThing(){const t=a.get("$data.chart.time"),r=a.get(`config.scroll.${s.type}`),l=a.get("$data.chart.dimensions.width"),h=a.get("$data.innerHeight");K=r.smooth,z=r.size,tt="horizontal"===s.type?l:h,tt=tt||0,"horizontal"===s.type?tt-=z:tt+=z,tt<0&&(tt=0),B.style[j]=z+"px",B.style[W]=tt+"px","vertical"===s.type&&(B.style.top=a.get("config.headerHeight")+"px"),U.style[j]="100%",et=tt,"horizontal"===s.type?Q=t.allDates&&t.allDates[t.level]?t.allDates[t.level]:[]:J=a.get("$data.list.rowsWithParentsExpanded")||[];const m=getFullSize();a.get(`config.scroll.${s.type}.lastPageSize`)&&(it=0,m<=et||r.lastPageSize===m?(et=0,Z=0):(tt&&m?Z=tt*(tt/m):(Z=0,et=0),Z<r.minInnerSize&&(it=r.minInnerSize-Z,Z=r.minInnerSize)),U.style[W]=Z+"px",q=Math.round(tt-it),function shouldUpdate(t,s,r,a){const l=nt.maxPosPx!==t||nt.innerSize!==s||nt.sub!==r||nt.scrollArea!==a;return l&&(nt.maxPosPx=q,nt.innerSize=s,nt.sub=r,nt.scrollArea=a),l}(q,Z,it,tt)&&a.update(`config.scroll.${s.type}`,t=>(t.maxPosPx=q,t.innerSize=Z,t.sub=it,t.scrollArea=tt,t)),x())})));let st=0;r(a.subscribe(`config.scroll.${s.type}.posPx`,t=>{t!==st&&(U.style[F]=t+"px",st=t,x())}));const ot=l.getActions("scroll-bar");ot.push(class OuterAction extends Action{constructor(t){super(),a.update(`$data.elements.scroll-bar--${s.type}`,t)}update(){}destroy(){}});const rt=b.create(ot,{api:l,state:a,props:s}),at=[class InnerAction extends Action{constructor(t){super(),this.moving=!1,this.initialPos=0,this.currentPos=0,this.cumulation=0,this.lastDataIndex=0,this.dataIndex=0,a.update(`$data.elements.scroll-bar-inner--${s.type}`,t),this.bodyClassName=a.get("config.scroll.bodyClassName"),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this);const r=this.pointerMove.bind(this);this.pointerMove=S(t=>r(t)),this.unsub=a.subscribe(`config.scroll.${s.type}`,this.dataChanged.bind(this)),this.destroy=this.destroy.bind(this),t.addEventListener("pointerdown",this.pointerDown),document.addEventListener("pointermove",this.pointerMove,{passive:!0}),document.addEventListener("pointerup",this.pointerUp)}destroy(t){this.unsub(),t.removeEventListener("pointerdown",this.pointerDown),document.removeEventListener("pointermove",this.pointerMove),document.removeEventListener("pointerup",this.pointerUp)}dataChanged(){const t=a.get(`config.scroll.${s.type}`),r=t.dataIndex;if(this.lastDataIndex=r,"horizontal"===s.type&&Q&&Q.length){const t=Q[r];if(!t)return;if(this.lastDate&&this.lastDate.leftPercent===t.leftPercent)return;const s=this.limitPosition(t.leftPercent*(tt-it));this.currentPos=s,x()}else if("vertical"===s.type){const s=J[r];if(!s)return;if(this.lastRow&&this.lastRow.$data.position.topPercent===s.$data.position.topPercent)return;const a=Math.round(s.$data.position.topPercent*(tt-it));this.currentPos=a+t.offset,x()}}limitPosition(t){return Math.max(Math.min(t,q),0)}pointerDown(t){t.preventDefault(),t.stopPropagation(),document.body.classList.add(this.bodyClassName),this.moving=!0,this.initialPos="horizontal"===s.type?t.screenX:t.screenY,H=" "+l.getClass("scroll-bar")+"-inner--active",G=" "+l.getClass("scroll-bar")+"--active",x()}pointerUp(t){this.moving&&(t.preventDefault(),t.stopPropagation(),document.body.classList.remove(this.bodyClassName)),this.moving=!1,this.cumulation=0,H="",G="",x()}pointerMove(t){if(this.moving){t.stopPropagation();const r="horizontal"===s.type?t.screenX:t.screenY,a=r-this.initialPos;this.cumulation+=a,this.currentPos=this.limitPosition(this.currentPos+a),this.initialPos=r;const h=this.currentPos/q;let m=0,b=0;if("horizontal"===s.type)for(let t=Q.length;m<t;m++){if(Q[m].leftPercent>=h)break}else{let t;for(let s=J.length;m<s&&(t=J[m],!(t.$data.position.bottomPercent>=h));m++);if(m!==t.length-1&&K){const s=h-t.$data.position.topPercent;b=Math.floor(s*getFullSize())}}m||(m=0),this.dataIndex=m,"horizontal"===s.type?(this.lastDate=Q[m],l.setScrollLeft(m,void 0,void 0,void 0)):(this.lastRow=J[m],l.setScrollTop(m,b)),m!==this.lastDataIndex&&(this.cumulation=0),this.lastDataIndex=m}}}],lt=b.create(at,{api:l,state:a,props:s}),ct=l.generateSlots("scroll-bar",t,s);return()=>h`
      <div
        data-actions=${rt}
        class=${O+" "+O+"--"+s.type+G}
        style=${B}
      >
        ${ct.html("before")}
        <div
          data-actions=${lt}
          class=${L+" "+L+"--"+s.type+H}
          style=${U}
        >
          ${ct.html("inside")}
        </div>
        ${ct.html("after")}
      </div>
    `}function List(t,s={}){const{api:r,state:a,onDestroy:l,Actions:h,update:m,reuseComponents:b,html:x,schedule:S,StyleMap:O,cache:L}=t,z=r.getActions("list");let G,H;l(a.subscribe("config.wrappers.List",t=>G=t));const j=a.subscribe("config.components.ListColumn",t=>H=t);let W,F,B;!function renderExpanderIcons(){const t=a.get("config.list.expander.icons"),s={};for(const a in t){const l=t[a];s[a]=r.getSVGIconSrc(l)}a.update("$data.list.expander.icons",s)}(),function renderToggleIcons(){const t={open:"",close:""},s=a.get("config.list.toggle.icons");for(const a in s){const l=s[a];t[a]=r.getSVGIconSrc(l)}a.update("$data.list.toggle.icons",t)}(),l(a.subscribe("config.list",(function onListChange(){F=a.get("config.list"),B=F.columns.percent,m()}))),l(a.subscribe("config.classNames",()=>{W=r.getClass("list"),m()}));let U=[];l(a.subscribe("config.list.columns.data",(function onListColumnsDataChange(t){b(U,Object.values(t),t=>({column:t}),H),m()})));const q=new O({height:"","--expander-padding-width":"","--expander-size":""});function onWheel(t){}let K;function getWidth(t){K||(K=t.clientWidth,0===B&&(K=0),a.update("$data.list.width",K))}l(a.subscribeAll(["config.height","config.list.expander"],t=>{const s=a.get("config.list.expander");q.style.height=a.get("config.height")+"px",q.style["--expander-padding-width"]=s.padding+"px",q.style["--expander-size"]=s.size+"px",m()})),l(()=>{U.forEach(t=>t.destroy()),j()});z.push(class ListAction{constructor(t,s){s.state.update("$data.elements.list",t),getWidth(t)}update(t){return getWidth(t)}});const Q=h.create(z,Object.assign(Object.assign({},s),{api:r,state:a})),J=r.generateSlots("list",t,s);return s=>G(L(F.columns.percent>0?x`
              <div class=${W} data-actions=${Q} style=${q} @wheel=${onWheel}>
                ${J.html("before",s)}${U.map(t=>t.html())}${J.html("after",s)}
              </div>
            `:""),{vido:t,props:{},templateProps:s})}class BindElementAction{constructor(t,s){let r=!1,a=s.state.get("$data.elements.list-columns");void 0===a&&(a=[],r=!0),a.includes(t)||(a.push(t),r=!0),r&&s.state.update("$data.elements.list-columns",a)}destroy(t,s){s.state.update("$data.elements.list-columns",s=>s.filter(s=>s!==t))}}function ListColumn(t,s){const{api:r,state:a,onDestroy:l,onChange:h,Actions:m,update:b,createComponent:x,reuseComponents:S,html:O,StyleMap:L}=t;let z;l(a.subscribe("config.wrappers.ListColumn",t=>z=t));const G=[];let H,j;G.push(a.subscribe("config.components.ListColumnRow",t=>H=t)),G.push(a.subscribe("config.components.ListColumnHeader",t=>j=t));const W=Object.assign(Object.assign({},s),{api:r,state:a}),F=r.getActions("list-column"),B=r.getActions("list-column-rows");let U,q,K,Q;const J=new L({width:"","--width":""}),Z=new L({width:"",height:""}),tt=new L({"margin-top":"0px"});let et;function calculateStyle(){const t=a.get("config.list");Q=t.columns.data[s.column.id].width*t.columns.percent*.01,et=Q;const r=a.get("$data.innerHeight");J.style.width=et+"px",J.style["--width"]=et+"px",Z.style.height=r+"px"}l(a.subscribeAll(["config.list.columns.percent","config.list.columns.resizer.width","$data.chart.dimensions.width","$data.innerHeight","$data.list.width","$data.list.visibleRowsHeight"],calculateStyle,{bulk:!0}));const it=x(j,s);l(it.destroy);const nt=r.generateSlots("list-column",t,s);h(t=>{s=t;for(const t in s)W[t]=s[t];calculateStyle(),it.change(s),visibleRowsChange(),nt.change(t)}),l(a.subscribe("config.classNames",t=>{U=r.getClass("list-column"),K=r.getClass("list-column-rows-offset"),q=r.getClass("list-column-rows"),b()}));const st=[];function visibleRowsChange(){const t=a.get("$data.list.visibleRows")||[];S(st,t,t=>t&&{column:s.column,row:t,width:et},H,!1)}l(a.subscribeAll(["$data.list.visibleRows;","$data.list.visibleRowsHeight","config.chart.items.*.height","config.chart.items.*.rowId","config.chart.items.*.time"],visibleRowsChange)),l(a.subscribe("config.scroll.vertical.offset",t=>{tt.style.transform=`translateY(-${t||0}px)`,b()})),l(()=>{st.forEach(t=>t.destroy()),G.forEach(t=>t())}),F.push(BindElementAction);const ot=m.create(F,{column:s.column,state:a,api:r}),rt=m.create(B,{api:r,state:a});return r=>z(O`
        <div class=${U} data-actions=${ot} style=${J}>
          ${it.html()}
          <div class=${q} style=${Z} data-actions=${rt}>
            <div class=${K} style=${tt}>
              ${nt.html("before",r)}${st.map(t=>t.html())}${nt.html("after",r)}
            </div>
          </div>
        </div>
      `,{vido:t,props:s,templateProps:r})}function ListColumnHeader(t,s){const{api:r,state:a,onDestroy:l,onChange:h,Actions:m,update:b,createComponent:x,html:S,cache:O,StyleMap:L}=t,z=Object.assign(Object.assign({},s),{api:r,state:a});let G;l(a.subscribe("config.wrappers.ListColumnHeader",t=>G=t));const H=r.getActions("list-column-header"),j=[];let W;j.push(a.subscribe("config.components.ListColumnHeaderResizer",t=>W=t));const F=x(W,s);let B;j.push(a.subscribe("config.components.ListColumnRowExpander",t=>B=t));const U=x(B,s);l(()=>{F.destroy(),U.destroy(),j.forEach(t=>t())});const q=r.generateSlots("list-column-header",t,s);let K,Q;h(t=>{s=t;for(const t in s)z[t]=s[t];F.change(s),U.change(s),q.change(t)}),l(a.subscribe("config.classNames",()=>{K=r.getClass("list-column-header"),Q=r.getClass("list-column-header-content")}));const J=new L({height:"","--height":"","--paddings-count":""});l(a.subscribe("config.headerHeight",()=>{const t=a.get("config");J.style.height=t.headerHeight+"px",J.style["--height"]=t.headerHeight+"px",J.style["--paddings-count"]="1",b()}));const Z=m.create(H,z);return r=>G(S`
        <div class=${K} style=${J} data-actions=${Z}>
          ${q.html("before",r)}${O(s.column.expander?function withExpander(){return S`
      <div class=${Q}>
        ${U.html()}${F.html(s.column)}
      </div>
    `}():function withoutExpander(){return S`
      <div class=${Q}>
        ${F.html(s.column)}
      </div>
    `}())}${q.html("after",r)}
        </div>
      `,{vido:t,props:s,templateProps:r})}function ListColumnHeaderResizer(t,s){const{api:r,state:a,onDestroy:l,update:h,html:m,Actions:b,onChange:x,PointerAction:S,cache:O,StyleMap:L,unsafeHTML:z}=t,G="list-column-header-resizer",H=r.getActions(G),j=r.getActions(G+"-dots");let W,F,B,U,q,K;l(a.subscribe("config.wrappers.ListColumnHeaderResizer",t=>W=t));const Q=new L({width:""});let J=!1;l(a.subscribe("config.classNames",t=>{F=r.getClass(G),B=r.getClass(G+"-container"),U=r.getClass(G+"-dots"),q=r.getClass(G+"-dots-dot"),h()}));const Z=r.generateSlots(G,t,s);function updateData(){if(!s.column)return;const t=a.get("config.list");K=s.column.width*t.columns.percent*.01,Q.style["--width"]=t.columns.resizer.width+"px",J=t.columns.resizer.inRealTime,a.update("$data.list.width",K),Z.change(s),h()}x(t=>{s=t,updateData()}),l(a.subscribeAll(["config.list.columns.percent","config.list.columns.resizer.width","config.list.columns.resizer.inRealTime"],updateData));let tt=[1,2,3,4,5,6,7,8];l(a.subscribe("config.list.columns.resizer.dots",t=>{tt=[];for(let s=0;s<t;s++)tt.push(s);h()}));let et=K;const it={column:s.column,api:r,state:a,pointerOptions:{axis:"x",onMove:function onMove({movementX:t}){let r=a.get("config.list.columns.minWidth");"number"==typeof s.column.minWidth&&(r=s.column.minWidth),et+=t,et<r&&(et=r),J&&a.update(`config.list.columns.data.${s.column.id}.width`,et)}}};H.push(S);const nt=b.create(H,it),st=b.create(j,it);return r=>W(m`
        <div class=${F} data-actions=${nt}>
          ${Z.html("before",r)}
          <div class=${B}>
            ${O(s.column.header.html?z(s.column.header.html):s.column.header.content)}
          </div>
          ${Z.html("inside",r)}
          <div class=${U} style=${Q} data-actions=${st}>
            ${tt.map(t=>m` <div class=${q} /> `)}
          </div>
          ${Z.html("after",r)}
        </div>
      `,{vido:t,props:s,templateProps:r})}class BindElementAction$1{constructor(t,s){let r=s.state.get("$data.elements.list-column-rows"),a=!1;void 0===r&&(a=!0,r=[]),r.includes(t)||(r.push(t),a=!0),a&&s.state.update("$data.elements.list-column-rows",r)}destroy(t,s){s.state.update("$data.elements.list-column-rows",s=>s.filter(s=>s!==t))}}function ListColumnRow(t,s){const{api:r,state:a,onDestroy:l,Detach:h,Actions:m,update:b,html:x,createComponent:S,onChange:O,StyleMap:L,unsafeHTML:z}=t,G=Object.assign(Object.assign({},s),{api:r,state:a});let H=!1;const j=new h(()=>H);let W,F;l(a.subscribe("config.wrappers.ListColumnRow",t=>W=t)),l(a.subscribe("config.components.ListColumnRowExpander",t=>F=t));const B=new L(s.column.expander?{height:"",top:"","--height":"","--expander-padding-width":"","--expander-size":""}:{height:"",top:"","--height":""},!0),U=S(F,{row:s.row});let q;l(a.subscribe("config.classNames",t=>{q=r.getClass("list-column-row"),b()}));let K=q;const Q=r.generateSlots("list-column-row",t,s);O((function onPropsChange(t,r){if(r.leave||void 0===t.row||void 0===t.column)return H=!0,Q.change(t,r),void b();H=!1,s=t;for(const t in s)G[t]=s[t];if(!s.column||!s.row||!s.row.$data)return H=!0,Q.change(t,r),void b();if(void 0===s.column||void 0===s.row)return;const l=a.get("config.list.expander");B.setStyle({}),B.style.height=s.row.$data.outerHeight+"px",B.style["--height"]=s.row.$data.outerHeight+"px",s.column.expander&&(B.style["--expander-padding-width"]=l.padding*(s.row.$data.parents.length+1)+"px");const h=a.get("config.list.rows");for(const t of s.row.$data.parents){const s=h[t];if("object"==typeof s.style&&"Object"===s.style.constructor.name&&"object"==typeof s.style.children){const t=s.style.children;for(const s in t)B.style[s]=t[s]}}if("object"==typeof s.row.style&&"Object"===s.row.style.constructor.name&&"object"==typeof s.row.style.current){const t=s.row.style.current;for(const s in t)B.style[s]=t[s]}K=s.row.classNames&&s.row.classNames.length?q+" "+s.row.classNames.join(" "):q,U&&U.change(s),Q.change(t,r),b()})),l(()=>{U&&U.destroy()});const J=r.getActions("list-column-row");J.includes(BindElementAction$1)||J.push(BindElementAction$1);const Z=m.create(J,G);return r=>W(x`
        <div detach=${j} class=${K} style=${B} data-actions=${Z}>
          ${s.column.expander?U.html():null}
          <div class=${q+"-content"}>
            ${Q.html("before",r)}${s.column.isHTML?function getHtml(){return void 0===s.row?null:"function"==typeof s.column.data?z(s.column.data({row:s.row,vido:t})):"function"==typeof s.row[s.column.data]?z(s.row[s.column.data]({row:s.row,vido:t})):z(s.row[s.column.data])}():function getText(){return void 0===s.row?null:"function"==typeof s.column.data?s.column.data({row:s.row,vido:t}):"function"==typeof s.row[s.column.data]?s.row[s.column.data]({row:s.row,vido:t}):s.row[s.column.data]}()}${Q.html("after",r)}
          </div>
        </div>
      `,{vido:t,props:s,templateProps:r})}function ListColumnRowExpander(t,s){const{api:r,state:a,onDestroy:l,Actions:h,update:m,html:b,createComponent:x,onChange:S}=t,O=r.getActions("list-column-row-expander"),L=Object.assign(Object.assign({},s),{api:r,state:a});let z,G;const H=a.subscribe("config.components.ListColumnRowExpanderToggle",t=>G=t),j=x(G,s.row?{row:s.row}:{});let W;l(()=>{j.destroy(),H()}),l(a.subscribe("config.wrappers.ListColumnRowExpander",t=>W=t)),l(a.subscribe("config.classNames",t=>{z=r.getClass("list-column-row-expander"),m()}));const F=r.generateSlots("list-column-row-expander",t,s);if(s.row){S((function onPropsChange(t){s=t;for(const t in s)L[t]=s[t];j.change(s),F.change(t)}))}const B=h.create(O,L);return r=>W(b`
        <div class=${z} data-action=${B}>
          ${F.html("before",r)}${j.html()}${F.html("after",r)}
        </div>
      `,{vido:t,props:s,templateProps:r})}function ListColumnRowExpanderToggle(t,s){const{api:r,state:a,onDestroy:l,Actions:h,update:m,html:b,onChange:x,cache:S}=t,O="list-column-row-expander-toggle",L=Object.assign(Object.assign({},s),{api:r,state:a});let z;l(a.subscribe("config.wrappers.ListColumnRowExpanderToggle",t=>z=t));const G=r.getActions(O);let H,j,W,F,B,U,q,K=!1;l(a.subscribe("config.classNames",t=>{H=r.getClass(O),j=H+"-child",W=H+"-open",F=H+"-closed",m()})),l(a.subscribe("$data.list.expander.icons",t=>{t&&(B=t.child,U=t.open,q=t.closed),m()}));const Q=r.generateSlots(O,t,s);function expandedChangeRow(t){K=t,m()}let J;function toggle(){K=!K,s.row?a.update(`config.list.rows.${s.row.id}.expanded`,K):a.update("config.list.rows",t=>{for(const s in t)t[s].expanded=K;return t},{only:["*.expanded"]})}s.row?(x((function onPropsChange(t){var r;s=t;for(const t in s)L[t]=s[t];J&&J(),(null===(r=null==s?void 0:s.row)||void 0===r?void 0:r.id)&&(J=a.subscribe(`config.list.rows.${s.row.id}.expanded`,expandedChangeRow)),Q.change(t)})),l((function listToggleDestroy(){J&&J()}))):l(a.subscribe("config.list.rows.*.expanded",(function expandedChangeNoRow(t){for(const s of t)if(s.value){K=!0;break}m()}),{bulk:!0}));const Z=h.create(G,L);return r=>{return z(b`
        <div class=${H} data-action=${Z} @click=${toggle}>
          ${Q.html("before",r)}${S(B?0===(null===(h=null===(l=null===(a=s.row)||void 0===a?void 0:a.$data)||void 0===l?void 0:l.children)||void 0===h?void 0:h.length)?b` <img width="16" height="16" class=${j} src=${B} /> `:K?b` <img width="16" height="16" class=${W} src=${U} /> `:b` <img width="16" height="16" class=${F} src=${q} /> `:"")}${Q.html("after",r)}
        </div>
      `,{vido:t,props:s,templateProps:r});var a,l,h}}function ListToggle(t,s={}){const{html:r,onDestroy:a,api:l,state:h,update:m,StyleMap:b}=t;let x,S;a(h.subscribe("config.classNames",t=>{x=l.getClass("list-toggle")})),a(h.subscribe("config.wrappers.ListToggle",t=>S=t));let O={open:"",close:""};a(h.subscribe("$data.list.toggle.icons",t=>{t&&(O=t,m())}));const L=new b({top:"0px"});a(h.subscribe("config.scroll.vertical.offset",t=>{L.style.top=(t||0)+"px"}));let z=!0;a(h.subscribe("config.list.columns.percent",t=>z=0!==t));let G=!1;function pointerDown(){G=!0}function pointerUp(){G&&(G=!1,function toggle(){h.update("config.list.columns.percent",t=>0===t?100:0)}())}const H=l.generateSlots("list-toggle",t,s);return a=>S(r`
        <div class=${x} style=${L} @pointerdown=${pointerDown} @pointerup=${pointerUp}>
          ${H.html("before",a)}<img
            src=${z?O.close:O.open}
          />${H.html("after",a)}
        </div>
      `,{props:s,vido:t,templateProps:a})}function Chart(t,s={}){const{api:r,state:a,onDestroy:l,Actions:h,update:m,html:b,createComponent:x}=t,S=[];let O,L,z;S.push(a.subscribe("config.components.ChartCalendar",t=>O=t)),S.push(a.subscribe("config.components.ChartTimeline",t=>L=t)),S.push(a.subscribe("config.components.ScrollBar",t=>z=t));const G=x(O);l(G.destroy);const H=x(L);l(H.destroy);const j=x(z,{type:"horizontal"});l(j.destroy);const W=x(z,{type:"vertical"});let F,B;l(W.destroy),l(()=>{S.forEach(t=>t())}),l(a.subscribe("config.wrappers.Chart",t=>F=t));const U=r.getActions("chart");let q=!1;l(a.subscribe("config.chart.time.calculatedZoomMode",t=>q=t)),l(a.subscribe("config.classNames",()=>{B=r.getClass("chart"),m()}));const K={handleEvent:function onWheelHandler(t){t.type},passive:!1,capture:!1};let Q,J=0;U.push((function bindElement(t){Q||(Q=new Mt((s,r)=>{const l=t.clientWidth,h=t.clientHeight,m=l-a.get("config.scroll.horizontal.size");J!==l&&(J=l,a.update("$data.chart.dimensions",{width:l,innerWidth:m,height:h}))}),Q.observe(t),a.update("$data.elements.chart",t))})),l(()=>{Q.disconnect()});const Z=h.create(U,{api:r,state:a}),tt=r.generateSlots("chart",t,s);return s=>F(b`
        <div class=${B} data-actions=${Z} @wheel=${K}>
          ${tt.html("before",s)}${G.html()}${tt.html("inside",s)}${H.html()}${W.html()}${q?null:j.html()}${tt.html("after",s)}
        </div>
      `,{vido:t,props:{},templateProps:s})}function ChartCalendar(t,s){const{api:r,state:a,onDestroy:l,Actions:h,update:m,reuseComponents:b,html:x,StyleMap:S}=t,O=r.getActions("chart-calendar"),L=Object.assign(Object.assign({},s),{api:r,state:a}),z=a.get("config.components.ChartCalendarDate");let G,H,j;l(a.subscribe("config.wrappers.ChartCalendar",t=>G=t)),l(a.subscribe("config.classNames",t=>{H=r.getClass("chart-calendar"),m()}));const W=new S({height:"","--headerHeight":"","margin-left":""});l(a.subscribe("config.headerHeight",t=>{j=t,W.style.height=j+"px",W.style["--calendar-height"]=j+"px",m()}));const F=[[],[]];l(a.subscribe("$data.chart.time.levels",t=>{let s=0;for(const a of t){if(!a.length)continue;let t="YYYY-MM-DD HH";switch(a[0].period){case"day":t="YYYY-MM-DD";break;case"week":t="YYYY-MM-ww";break;case"month":t="YYYY-MM";break;case"year":t="YYYY"}const l=r.time.date().format(t);b(F[s],a,r=>r&&{level:s,date:r,currentDate:l,currentDateFormat:t},z),s++}m()})),l(()=>{F.forEach(t=>t.forEach(t=>t.destroy()))}),O.push(t=>{a.update("$data.elements.chart-calendar",t)});const B=h.create(O,L),U=r.generateSlots("chart-calendar",t,s);return r=>G(x`
        <div class=${H} data-actions=${B} style=${W}>
          ${U.html("before",r)}
          ${F.map((t,s)=>x`
              <div class=${H+"-dates "+H+`-dates--level-${s}`}>
                ${U.html("inside",r)}${t.map(t=>t.html())}
              </div>
            `)}
          ${U.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}class BindElementAction$2 extends Action{constructor(t,s){super(),s.state.update("$data.elements.chart-calendar-dates",s=>(void 0===s&&(s=[]),s.includes(t)||s.push(t),s))}}function ChartCalendarDay(t,s){const{api:r,state:a,onDestroy:l,Actions:h,update:m,onChange:b,html:x,StyleMap:S,Detach:O}=t,L=r.getActions("chart-calendar-date");let z,G;l(a.subscribe("config.wrappers.ChartCalendarDate",t=>z=t)),l(a.subscribe("config.classNames",()=>{G=r.getClass("chart-calendar-date")}));let H,j,W="";const F=new S({width:"0px"});let B="";function updateDate(){if(!s)return;const t=a.get(`config.chart.calendar.levels.${s.level}`);F.style.width=s.date.currentView.width+"px",H=a.get("$data.chart.time");const r=t.formats.find(t=>+H.zoom<=+t.zoomTo);W=s.date.current?" gstc-current":s.date.next?" gstc-next":s.date.previous?" gstc-previous":"";let l=G+"-content "+G+`-content--${s.date.period}`+W;r.className?(l+=" "+r.className,B=" "+r.className):B="",j=x`
      <div class=${l}>
        ${s.date.formatted}
      </div>
    `,m()}let U=!1;const q=new O(()=>U),K=r.generateSlots("chart-calendar-date",t,s);let Q;const J={date:s.date,period:s.period,api:r,state:a};b((t,r)=>{if(r.leave)return U=!0,K.change(t,r),m();U=!1,s=t,J.date=s.date,J.period=s.period,Q&&Q(),Q=a.subscribeAll(["$data.chart.time","config.chart.calendar.levels"],updateDate,{bulk:!0}),K.change(t,r)}),l(()=>{Q()}),L.includes(BindElementAction$2)||L.push(BindElementAction$2);const Z=h.create(L,J);return r=>z(x`
        <div
          detach=${q}
          class=${G+" "+G+`--${s.date.period}`+" "+G+`--level-${s.level}`+W+B}
          style=${F}
          data-actions=${Z}
        >
          ${K.html("before",r)}${j}${K.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}function ChartTimeline(t,s){const{api:r,state:a,onDestroy:l,Action:h,Actions:m,update:b,html:x,createComponent:S,StyleMap:O}=t,L=Object.assign(Object.assign({},s),{api:r,state:a});let z,G,H,j;l(a.subscribe("config.wrappers.ChartTimeline",t=>z=t)),l(a.subscribe("config.components.ChartTimelineGrid",t=>{G&&G.destroy(),G=S(t)})),l(()=>{G&&G.destroy()}),l(a.subscribe("config.components.ChartTimelineItems",t=>{H&&H.destroy(),H=S(t)})),l(()=>{H&&H.destroy()}),l(a.subscribe("config.components.ListToggle",t=>{j&&j.destroy(),j=S(t)})),l(()=>{j&&j.destroy()});const W=r.generateSlots("chart-timeline",t,s);let F,B,U;l(a.subscribe("config.classNames",()=>{F=r.getClass("chart-timeline"),B=r.getClass("chart-timeline-inner"),b()})),l(a.subscribe("config.list.toggle.display",t=>U=t));const q=new O({}),K=new O({});l(a.subscribeAll(["$data.innerHeight","config.scroll.vertical.offset","$data.chart.dimensions.width","$data.list.visibleRowsHeight","$data.chart.time.dates.day"],(function calculateStyle(){const t=a.get("$data.chart.dimensions.width"),s=a.get("$data.list.visibleRowsHeight");q.style.height=a.get("$data.innerHeight")+"px",q.style["--height"]=q.style.height,t?(q.style.width=t+"px",q.style["--width"]=t+"px"):(q.style.width="0px",q.style["--width"]="0px"),K.style.height=s+"px",K.style.width=t?t+"px":"0px";const r=a.get("config.scroll.vertical.offset")||0;K.style.transform=`translateY(-${r}px)`,b()})));let Q=[];l(a.subscribe("config.actions.chart-timeline",t=>{Q=t})),Q.push(class BindElementAction extends h{constructor(t){super(),a.get("$data.elements.chart-timeline")!==t&&a.update("$data.elements.chart-timeline",t)}});const J=m.create(Q,L);return r=>z(x`
        <div class=${F} style=${q} data-actions=${J}>
          <div class=${B} style=${K}>
            ${W.html("before",r)}${G.html()}${W.html("inside",r)}${H.html()}${U?j.html():""}${W.html("after",r)}
          </div>
        </div>
      `,{props:s,vido:t,templateProps:r})}class BindElementAction$3{constructor(t,s){s.state.get("$data.elements.chart-timeline-grid")!==t&&s.state.update("$data.elements.chart-timeline-grid",t)}destroy(t,s){s.state.update("$data.elements",t=>(delete t["chart-timeline-grid"],t))}}function ChartTimelineGrid(t,s){const{api:r,state:a,onDestroy:l,Actions:h,update:m,html:b,reuseComponents:x,StyleMap:S}=t,O=r.getActions("chart-timeline-grid"),L={api:r,state:a};let z;l(a.subscribe("config.wrappers.ChartTimelineGrid",t=>z=t));const G=a.get("config.components.ChartTimelineGridRow");let H,j;l(a.subscribe("config.classNames",()=>{H=r.getClass("chart-timeline-grid"),m()})),l(a.subscribe("config.chart.grid.cell.onCreate",t=>j=t));const W=[],F=[],B=new Map,U=new S({});l(a.subscribeAll(["$data.list.rowsHeight","$data.list.visibleRows;","$data.list.visibleRowsHeight","$data.chart.items.*.rowId","$ddata.chart.items.*.time","$data.chart.time.levels","$data.innerHeight","$data.chart.dimensions.width"],(function generateCells(){const t=a.get("$data.chart.dimensions.width"),s=a.get("$data.innerHeight"),l=a.get("config.scroll.vertical.offset")||0,h=a.get("$data.chart.time"),m=a.get(`$data.chart.time.levels.${h.level}`);if(!m||0===m.length)return void a.update("$data.chart.grid.rowsWithCells",[]);const b=a.get("$data.list.visibleRows");U.style.height=s+l+"px",U.style.width=t+"px";let x=0;F.length=0;for(const s of b){const a=[];for(const t of m){let l;B.has(t.leftGlobal)?l=B.get(t.leftGlobal):(l=r.time.date(t.leftGlobal).format("YYYY-MM-DD HH:mm"),B.set(t.leftGlobal,l));let h={id:s.id+":"+l,time:t,row:s,top:x};for(const t of j)h=t(h);a.push(h)}F.push({row:s,cells:a,top:x,width:t}),x+=s.$data.outerHeight}a.update("$data.chart.grid.rowsWithCells",F)}),{bulk:!0})),l(a.subscribe("$data.chart.grid.rowsWithCells;",(function generateRowsComponents(t){x(W,t||[],t=>t,G,!1),m()}))),l(()=>{W.forEach(t=>t.destroy())}),O.push(BindElementAction$3);const q=h.create(O,L),K=r.generateSlots("chart-timeline-grid",t,s);return r=>z(b`
        <div class=${H} data-actions=${q} style=${U}>
          ${K.html("before",r)}${W.map(t=>t.html())}${K.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}class BindElementAction$4{constructor(t,s){let r=!1,a=s.state.get("$data.elements.chart-timeline-grid-rows");void 0===a&&(a=[],r=!0),a.includes(t)||(a.push(t),r=!0),r&&s.state.update("$data.elements.chart-timeline-grid-rows",a,{only:null})}destroy(t,s){s.state.update("$data.elements.chart-timeline-grid-rows",s=>s.filter(s=>s!==t))}}function ChartTimelineGridRow(t,s){const{api:r,state:a,onDestroy:l,Detach:h,Actions:m,update:b,html:x,reuseComponents:S,onChange:O,StyleMap:L}=t,z=Object.assign(Object.assign({},s),{api:r,state:a});let G,H;l(a.subscribe("config.wrappers.ChartTimelineGridRow",t=>{G=t,b()})),l(a.subscribe("config.components.ChartTimelineGridRowCell",t=>H=t));const j=r.getActions("chart-timeline-grid-row");let W;l(a.subscribe("config.classNames",()=>{W=r.getClass("chart-timeline-grid-row")}));const F=new L({width:s.width+"px",height:s.row.height+"px"},!0);let B=!1;const U=new h(()=>B),q=r.generateSlots("chart-timeline-grid-row",t,s),K=[];O((function onPropsChange(t,r){var l,h,m,x,O,L,G;if(r.leave||void 0===t.row)return B=!0,S(K,[],t=>t,H,!1),q.change(t,r),void b();B=!1,S(K,(s=t).cells,t=>t,H,!1),F.setStyle({}),F.style.height=s.row.$data.outerHeight+"px",F.style.width=s.width+"px";const j=a.get("config.list.rows");for(const t of s.row.$data.parents){const s=j[t],r=null===(m=null===(h=null===(l=null==s?void 0:s.style)||void 0===l?void 0:l.grid)||void 0===h?void 0:h.row)||void 0===m?void 0:m.children;if(r)for(const t in r)F.style[t]=r[t]}const W=null===(G=null===(L=null===(O=null===(x=null==s?void 0:s.row)||void 0===x?void 0:x.style)||void 0===O?void 0:O.grid)||void 0===L?void 0:L.row)||void 0===G?void 0:G.current;if(W)for(const t in W)F.style[t]=W[t];for(const t in s)z[t]=s[t];q.change(t,r),b()})),l((function destroy(){K.forEach(t=>t.destroy())})),-1===j.indexOf(BindElementAction$4)&&j.push(BindElementAction$4);const Q=m.create(j,z);return r=>G(x`
        <div detach=${U} class=${W} data-actions=${Q} style=${F}>
          ${q.html("before",r)}${K.map(t=>t.html())}
          ${q.html("after",r)}
        </div>
      `,{vido:t,props:s,templateProps:r})}class BindElementAction$5{constructor(t,s){let r=!1,a=s.state.get("$data.elements.chart-timeline-grid-row-cells");void 0===a&&(a=[],r=!0),a.includes(t)||(a.push(t),r=!0),r&&s.state.update("$data.elements.chart-timeline-grid-row-cells",a,{only:null})}destroy(t,s){s.state.update("$data.elements.chart-timeline-grid-row-cells",s=>s.filter(s=>s!==t),{only:[""]})}}function ChartTimelineGridRowCell(t,s){const{api:r,state:a,onDestroy:l,Detach:h,Actions:m,update:b,html:x,onChange:S,StyleMap:O}=t,L="chart-timeline-grid-row-cell",z=Object.assign(Object.assign({},s),{api:r,state:a});let G=!1;const H=new h(()=>G),j=r.getActions(L);let W;l(a.subscribe("config.wrappers.ChartTimelineGridRowCell",t=>{W=t,b()}));const F=r.generateSlots(L,t,s);let B;function updateClassName(t){B=r.getClass(L),t.current&&(B+=" current")}updateClassName(s.time);const U=new O({width:"",height:""});S((function onPropsChange(t,r){var l,h,m,x,S,O,L,H,j,W;if(r.leave||void 0===t.row)return G=!0,F.change(t,r),b();G=!1,s=t;for(const t in s)z[t]=s[t];updateClassName(s.time),U.setStyle({}),U.style.width=((null===(l=null==s?void 0:s.time)||void 0===l?void 0:l.width)||0)+"px",U.style.height=((null===(m=null===(h=null==s?void 0:s.row)||void 0===h?void 0:h.$data)||void 0===m?void 0:m.outerHeight)||0)+"px";const B=a.get("config.list.rows");for(const t of s.row.$data.parents){const s=B[t],r=null===(O=null===(S=null===(x=null==s?void 0:s.style)||void 0===x?void 0:x.grid)||void 0===S?void 0:S.cell)||void 0===O?void 0:O.children;r&&U.setStyle(Object.assign(Object.assign({},U.style),r))}const q=null===(W=null===(j=null===(H=null===(L=null==s?void 0:s.row)||void 0===L?void 0:L.style)||void 0===H?void 0:H.grid)||void 0===j?void 0:j.cell)||void 0===W?void 0:W.current;q&&U.setStyle(Object.assign(Object.assign({},U.style),q)),F.change(s,r),b()})),j.push(BindElementAction$5);const q=m.create(j,z);return r=>W(x`${F.html("before",r)}
        <div detach=${H} class=${B} data-actions=${q} style=${U}>
          ${F.html("inside",r)}
        </div>
        ${F.html("after",r)}`,{props:s,vido:t,templateProps:r})}function ChartTimelineItems(t,s={}){const{api:r,state:a,onDestroy:l,Actions:h,update:m,html:b,reuseComponents:x,StyleMap:S}=t;let O,L,z,G;l(a.subscribe("config.wrappers.ChartTimelineItems",t=>O=t)),l(a.subscribe("config.actions.chart-timeline-items",t=>L=t)),l(a.subscribe("config.components.ChartTimelineItemsRow",t=>z=t)),l(a.subscribe("config.classNames",()=>{G=r.getClass("chart-timeline-items"),m()}));const H=new S({},!0);l(a.subscribeAll(["$data.innerHeight","$data.chart.dimensions.width","config.scroll.vertical.offset"],(function calculateStyle(){const t=a.get("$data.chart.dimensions.width"),s=a.get("$data.innerHeight"),r=a.get("config.scroll.vertical.offset")||0;H.style.width=t+"px",H.style.height=s+r+"px"})));const j=[];l(a.subscribeAll(["$data.list.visibleRows;","config.components.ChartTimelineItemsRow","config.chart.items.*.rowId"],(function createRowComponents(){const t=a.get("$data.list.visibleRows")||[];x(j,t,t=>({row:t}),z,!1),m()}))),l(()=>{j.forEach(t=>t.destroy())});const W=h.create(L,{api:r,state:a}),F=r.generateSlots("chart-timeline-items",t,s);return r=>O(b`
        <div class=${G} style=${H} data-actions=${W}>
          ${F.html("before",r)}${j.map(t=>t.html())}${F.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}class BindElementAction$6{constructor(t,s){let r=!1,a=s.state.get("$data.elements.chart-timeline-items-rows");void 0===a&&(a=[],r=!0),a.includes(t)||(a.push(t),r=!0),r&&s.state.update("$data.elements.chart-timeline-items-rows",a,{only:null})}destroy(t,s){s.state.update("$data.elements.chart-timeline-items-rows",s=>s.filter(s=>s!==t))}}function ChartTimelineItemsRow(t,s){const{api:r,state:a,onDestroy:l,Detach:h,Actions:m,update:b,html:x,onChange:S,reuseComponents:O,StyleMap:L}=t,z=Object.assign(Object.assign({},s),{api:r,state:a});let G,H;l(a.subscribe("config.wrappers.ChartTimelineItemsRow",t=>G=t)),l(a.subscribe("config.components.ChartTimelineItemsRowItem",t=>H=t));let j,W,F=`config.list.rows.${s.row.id}.$data.items`,B="";const U=[],q=new L({width:"",height:""},!0);let K=!1;const Q=new h(()=>K),updateDom=()=>{const t=a.get("$data.chart");K=!1,q.style.width=t.dimensions.width+"px",s?(q.style.height=s.row.$data.outerHeight+"px",q.style["--row-height"]=s.row.$data.outerHeight+"px"):K=!0};let J;l(a.subscribe("config.classNames",()=>{J=r.getClass("chart-timeline-items-row"),b()}));const Z=r.generateSlots("chart-timeline-items-row",t,s);S((function onPropsChange(t,r){if(r.leave||void 0===t.row)return K=!0,O(U,[],t=>null,H,!1),Z.change(t,r),b();s=t;for(const t in s)z[t]=s[t];B=s.row.classNames&&s.row.classNames.length?J+" "+s.row.classNames.join(" "):J,function updateRow(t){F=`config.list.rows.${t.id}.$data.items`,"function"==typeof j&&j(),"function"==typeof W&&W(),j=a.subscribe("$data.chart.dimensions",t=>{if(void 0===t)return K=!0,b();updateDom(),b()}),W=a.subscribeAll([F,"config.chart.items"],()=>{const s=a.get(F);if(void 0===s)return K=!0,O(U,[],()=>null,H,!1),b();const r=a.get("config.chart.items");O(U,s,s=>({row:t,item:s?r[s.id]:s}),H,!1),updateDom(),b()})}(s.row),Z.change(t,r)})),l(()=>{W(),j(),U.forEach(t=>t.destroy())});const tt=r.getActions("chart-timeline-items-row");tt.push(BindElementAction$6);const et=m.create(tt,z);return r=>G(x`
        <div detach=${Q} class=${B} data-actions=${et} style=${q}>
          ${Z.html("before",r)}${U.map(t=>t.html())}${Z.html("after",r)}
        </div>
      `,{props:s,vido:t,templateProps:r})}class BindElementAction$7{constructor(t,s){let r=!1,a=s.state.get("$data.elements.chart-timeline-items-row-items");void 0===a&&(a=[],r=!0),a.includes(t)||(a.push(t),r=!0),r&&s.state.update("$data.elements.chart-timeline-items-row-items",a,{only:null})}destroy(t,s){s.state.update("$data.elements.chart-timeline-items-row-items",s=>s.filter(s=>s!==t))}}function ChartTimelineItemsRowItem(t,s){const{api:r,state:a,onDestroy:l,Detach:h,Actions:m,update:b,html:x,svg:S,onChange:O,unsafeHTML:L,StyleMap:z}=t;let G;l(a.subscribe("config.wrappers.ChartTimelineItemsRowItem",t=>G=t));let H=0,j=0,W=!1,F="";const B=new z({width:"",height:"",left:"",top:""}),U=new z({}),q=new z({}),K={item:s.item,row:s.row,left:H,width:j,api:r,state:a};let Q=!1;function updateItem(t=a.get("$data.chart.time")){var l,h,m,x,S,O,L,z;if(W||0===t.levels.length||!t.levels[t.level]||0===t.levels[t.level].length)return Q=!0,s.item.$data.detached=Q,b();if(H=s.item.$data.position.actualLeft,j=s.item.$data.actualWidth,s.item.time.end<=t.leftGlobal||s.item.time.start>=t.rightGlobal||j<=0)return Q=!0,s.item.$data.detached=Q,b();F=it,s.item.time.start<t.leftGlobal?(U.style.display="block",F+=" "+it+"--left-cut"):U.style.display="none",s.item.$data.position.right>t.width?(q.style.display="block",F+=" "+it+"--right-cut"):q.style.display="none",s.item.classNames&&s.item.classNames.length&&(F+=" "+s.item.classNames.join(" ")),s.item.selected&&(F+=" "+r.getClass(J)+"--selected");const G=B.style.width,Z=B.style.left,tt=B.style.top,et=B.style.height;B.setStyle({});const nt=r.isItemInViewport(s.item,t.leftGlobal,t.rightGlobal);Q=!nt,s.item.$data.detached=Q,nt?(B.style.width=j+"px",B.style.left=H+"px",B.style.top=s.item.$data.position.actualTop+"px",B.style.height=s.item.$data.actualHeight+"px"):(B.style.width=G,B.style.left=Z,B.style.top=tt,B.style.height=et);const st=a.get("config.list.rows");for(const t of s.row.$data.parents){const s=st[t],r=null===(m=null===(h=null===(l=null==s?void 0:s.style)||void 0===l?void 0:l.items)||void 0===h?void 0:h.item)||void 0===m?void 0:m.children;r&&B.setStyle(Object.assign(Object.assign({},B.style),r))}const ot=null===(L=null===(O=null===(S=null===(x=null==s?void 0:s.row)||void 0===x?void 0:x.style)||void 0===S?void 0:S.items)||void 0===O?void 0:O.item)||void 0===L?void 0:L.current;ot&&B.setStyle(Object.assign(Object.assign({},B.style),ot));const rt=null===(z=null==s?void 0:s.item)||void 0===z?void 0:z.style;rt&&B.setStyle(Object.assign(Object.assign({},B.style),rt)),K.left=H,K.width=j,b()}const J="chart-timeline-items-row-item",Z=r.getClass(J)+"-cut",tt=r.generateSlots(J,t,s);O((function onPropsChange(t,r){if(r.leave||void 0===t.row||void 0===t.item)return W=!0,Q=!0,s.item.$data.detached=Q,tt.change(t,r),b();Q=!1,s.item.$data.detached=Q,W=!1,s=t,K.item=s.item,K.row=s.row,updateItem(),tt.change(t,r)}));const et=r.getActions(J);let it,nt;l(a.subscribe("config.classNames",()=>{it=r.getClass(J),nt=r.getClass(J+"-label"),b()})),l(a.subscribe("$data.chart.time",updateItem)),et.push(BindElementAction$7);const st=m.create(et,K),ot=new h(()=>Q);return r=>G(x`
        <div detach=${ot} class=${F} data-actions=${st} style=${B}>
          ${x`
    <div class=${Z} style=${U}>
      ${S`<svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 18 16" width="16">
        <path fill-opacity="0.5" fill="#ffffff" d="m5,3l-5,5l5,5l0,-10z" />
      </svg>`}
    </div>
  `}${tt.html("before",r)}
          <div class=${nt} title=${function getTitle(){return s.item.isHTML||"function"==typeof s.item.label?"":s.item.label}()}>
            ${tt.html("inside",r)}${s.item.isHTML?function getHtml(){return s.item&&s.item.label?"function"==typeof s.item.label?L(s.item.label({item:s.item,vido:t})):L(s.item.label):null}():function getText(){return s.item&&s.item.label?"function"==typeof s.item.label?s.item.label({item:s.item,vido:t}):s.item.label:null}()}
          </div>
          ${tt.html("after",r)}${x`
    <div class=${Z} style=${q}>
      ${S`<svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 4 16" width="16">
        <path transform="rotate(-180 2.5,8) " fill-opacity="0.5" fill="#ffffff" d="m5,3l-5,5l5,5l0,-10z" />
      </svg>`}
    </div>
  `}
        </div>
      `,{vido:t,props:s,templateProps:r})}const Ot=["main","scroll-bar","list","list-column","list-column-header","list-column-header-resizer","list-column-header-resizer-dots","list-column-row","list-column-row-expander","list-column-row-expander-toggle","list-toggle","chart","chart-calendar","chart-calendar-date","chart-timeline","chart-timeline-grid","chart-timeline-grid-row","chart-timeline-grid-row-cell","chart-timeline-items","chart-timeline-items-row","chart-timeline-items-row-item"];function generateEmptyActions(){const t={};return Ot.forEach(s=>t[s]=[]),t}function generateEmptySlots(){const t={};return Ot.forEach(s=>{t[s]={before:[],inside:[],after:[]}}),t}var It=createCommonjsModule((function(t,s){t.exports=function(){var t="millisecond",s="second",r="minute",a="hour",l="day",h="week",m="month",b="quarter",x="year",S=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,O=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,s,r){var a=String(t);return!a||a.length>=s?t:""+Array(s+1-a.length).join(r)+t},L={s:c,z:function(t){var s=-t.utcOffset(),r=Math.abs(s),a=Math.floor(r/60),l=r%60;return(s<=0?"+":"-")+c(a,2,"0")+":"+c(l,2,"0")},m:function(t,s){var r=12*(s.year()-t.year())+(s.month()-t.month()),a=t.clone().add(r,m),l=s-a<0,h=t.clone().add(r+(l?-1:1),m);return Number(-(r+(s-a)/(l?a-h:h-a))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(S){return{M:m,y:x,w:h,d:l,D:"date",h:a,m:r,s:s,ms:t,Q:b}[S]||String(S||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},z={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},G="en",H={};H[G]=z;var y=function(t){return t instanceof W},M=function(t,s,r){var a;if(!t)return G;if("string"==typeof t)H[t]&&(a=t),s&&(H[t]=s,a=t);else{var l=t.name;H[l]=t,a=l}return!r&&a&&(G=a),a||!r&&G},g=function(t,s,r){if(y(t))return t.clone();var a=s?"string"==typeof s?{format:s,pl:r}:s:{};return a.date=t,new W(a)},j=L;j.l=M,j.i=y,j.w=function(t,s){return g(t,{locale:s.$L,utc:s.$u,$offset:s.$offset})};var W=function(){function c(t){this.$L=this.$L||M(t.locale,null,!0),this.parse(t)}var L=c.prototype;return L.parse=function(t){this.$d=function(t){var s=t.date,r=t.utc;if(null===s)return new Date(NaN);if(j.u(s))return new Date;if(s instanceof Date)return new Date(s);if("string"==typeof s&&!/Z$/i.test(s)){var a=s.match(S);if(a)return r?new Date(Date.UTC(a[1],a[2]-1,a[3]||1,a[4]||0,a[5]||0,a[6]||0,a[7]||0)):new Date(a[1],a[2]-1,a[3]||1,a[4]||0,a[5]||0,a[6]||0,a[7]||0)}return new Date(s)}(t),this.init()},L.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},L.$utils=function(){return j},L.isValid=function(){return!("Invalid Date"===this.$d.toString())},L.isSame=function(t,s){var r=g(t);return this.startOf(s)<=r&&r<=this.endOf(s)},L.isAfter=function(t,s){return g(t)<this.startOf(s)},L.isBefore=function(t,s){return this.endOf(s)<g(t)},L.$g=function(t,s,r){return j.u(t)?this[s]:this.set(r,t)},L.year=function(t){return this.$g(t,"$y",x)},L.month=function(t){return this.$g(t,"$M",m)},L.day=function(t){return this.$g(t,"$W",l)},L.date=function(t){return this.$g(t,"$D","date")},L.hour=function(t){return this.$g(t,"$H",a)},L.minute=function(t){return this.$g(t,"$m",r)},L.second=function(t){return this.$g(t,"$s",s)},L.millisecond=function(s){return this.$g(s,"$ms",t)},L.unix=function(){return Math.floor(this.valueOf()/1e3)},L.valueOf=function(){return this.$d.getTime()},L.startOf=function(t,b){var S=this,O=!!j.u(b)||b,L=j.p(t),d=function(t,s){var r=j.w(S.$u?Date.UTC(S.$y,s,t):new Date(S.$y,s,t),S);return O?r:r.endOf(l)},$=function(t,s){return j.w(S.toDate()[t].apply(S.toDate(),(O?[0,0,0,0]:[23,59,59,999]).slice(s)),S)},z=this.$W,G=this.$M,H=this.$D,W="set"+(this.$u?"UTC":"");switch(L){case x:return O?d(1,0):d(31,11);case m:return O?d(1,G):d(0,G+1);case h:var F=this.$locale().weekStart||0,B=(z<F?z+7:z)-F;return d(O?H-B:H+(6-B),G);case l:case"date":return $(W+"Hours",0);case a:return $(W+"Minutes",1);case r:return $(W+"Seconds",2);case s:return $(W+"Milliseconds",3);default:return this.clone()}},L.endOf=function(t){return this.startOf(t,!1)},L.$set=function(h,b){var S,O=j.p(h),L="set"+(this.$u?"UTC":""),z=(S={},S.day=L+"Date",S.date=L+"Date",S[m]=L+"Month",S[x]=L+"FullYear",S[a]=L+"Hours",S[r]=L+"Minutes",S[s]=L+"Seconds",S[t]=L+"Milliseconds",S)[O],G=O===l?this.$D+(b-this.$W):b;if(O===m||O===x){var H=this.clone().set("date",1);H.$d[z](G),H.init(),this.$d=H.set("date",Math.min(this.$D,H.daysInMonth())).toDate()}else z&&this.$d[z](G);return this.init(),this},L.set=function(t,s){return this.clone().$set(t,s)},L.get=function(t){return this[j.p(t)]()},L.add=function(t,b){var S,O=this;t=Number(t);var L=j.p(b),d=function(s){var r=g(O);return j.w(r.date(r.date()+Math.round(s*t)),O)};if(L===m)return this.set(m,this.$M+t);if(L===x)return this.set(x,this.$y+t);if(L===l)return d(1);if(L===h)return d(7);var z=(S={},S[r]=6e4,S[a]=36e5,S[s]=1e3,S)[L]||1,G=this.$d.getTime()+t*z;return j.w(G,this)},L.subtract=function(t,s){return this.add(-1*t,s)},L.format=function(t){var s=this;if(!this.isValid())return"Invalid Date";var r=t||"YYYY-MM-DDTHH:mm:ssZ",a=j.z(this),l=this.$locale(),h=this.$H,m=this.$m,b=this.$M,x=l.weekdays,S=l.months,c=function(t,a,l,h){return t&&(t[a]||t(s,r))||l[a].substr(0,h)},d=function(t){return j.s(h%12||12,t,"0")},L=l.meridiem||function(t,s,r){var a=t<12?"AM":"PM";return r?a.toLowerCase():a},z={YY:String(this.$y).slice(-2),YYYY:this.$y,M:b+1,MM:j.s(b+1,2,"0"),MMM:c(l.monthsShort,b,S,3),MMMM:S[b]||S(this,r),D:this.$D,DD:j.s(this.$D,2,"0"),d:String(this.$W),dd:c(l.weekdaysMin,this.$W,x,2),ddd:c(l.weekdaysShort,this.$W,x,3),dddd:x[this.$W],H:String(h),HH:j.s(h,2,"0"),h:d(1),hh:d(2),a:L(h,m,!0),A:L(h,m,!1),m:String(m),mm:j.s(m,2,"0"),s:String(this.$s),ss:j.s(this.$s,2,"0"),SSS:j.s(this.$ms,3,"0"),Z:a};return r.replace(O,(function(t,s){return s||z[t]||a.replace(":","")}))},L.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},L.diff=function(t,l,S){var O,L=j.p(l),z=g(t),G=6e4*(z.utcOffset()-this.utcOffset()),H=this-z,W=j.m(this,z);return W=(O={},O[x]=W/12,O[m]=W,O[b]=W/3,O[h]=(H-G)/6048e5,O.day=(H-G)/864e5,O[a]=H/36e5,O[r]=H/6e4,O[s]=H/1e3,O)[L]||H,S?W:j.a(W)},L.daysInMonth=function(){return this.endOf(m).$D},L.$locale=function(){return H[this.$L]},L.locale=function(t,s){if(!t)return this.$L;var r=this.clone(),a=M(t,s,!0);return a&&(r.$L=a),r},L.clone=function(){return j.w(this.$d,this)},L.toDate=function(){return new Date(this.valueOf())},L.toJSON=function(){return this.isValid()?this.toISOString():null},L.toISOString=function(){return this.$d.toISOString()},L.toString=function(){return this.$d.toUTCString()},c}();return g.prototype=W.prototype,g.extend=function(t,s){return t(s,W,g),g},g.locale=M,g.isDayjs=y,g.unix=function(t){return g(1e3*t)},g.en=H[G],g.Ls=H,g}()})),At=createCommonjsModule((function(t,s){t.exports=function(t,s,r){var a=(new Date).getTimezoneOffset(),l=s.prototype;r.utc=function(t,r){return new s({date:t,utc:!0,format:r})},l.utc=function(){return r(this.toDate(),{locale:this.$L,utc:!0})},l.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var h=l.parse;l.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),h.call(this,t)};var m=l.init;l.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else m.call(this)};var b=l.utcOffset;l.utcOffset=function(t){var s=this.$utils().u;if(s(t))return this.$u?0:s(this.$offset)?b.call(this):this.$offset;var r,l=Math.abs(t)<=16?60*t:t;return 0!==t?(r=this.local().add(l+a,"minute")).$offset=l:r=this.utc(),r};var x=l.format;l.format=function(t){var s=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return x.call(this,s)},l.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+a;return this.$d.valueOf()-6e4*t},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()}}}));class Time{constructor(t,s){this.utcMode=!1,this.state=t,this.api=s,this.dayjs=It,this.locale=t.get("config.locale"),this.utcMode=t.get("config.utcMode"),this.resetCurrentDate(),this.utcMode&&It.extend(At),It.locale(this.locale,null,!0)}resetCurrentDate(){const t=It();this.currentDate={timestamp:t.valueOf(),hour:t.startOf("hour"),day:t.startOf("day"),week:t.startOf("week"),month:t.startOf("month"),year:t.startOf("year")}}date(t){const s=this.utcMode?It.utc:It;return t?s(t).locale(this.locale.name):s().locale(this.locale.name)}addAdditionalSpace(t){if(!t.additionalSpaceAdded&&t.additionalSpaces&&t.additionalSpaces[t.period]){t.additionalSpaceAdded=!0;const s=t.additionalSpaces[t.period];s.before&&(t.from=this.date(t.from).subtract(s.before,s.period).valueOf()),s.after&&(t.to=this.date(t.to).add(s.after,s.period).valueOf()),t.additionalSpaceAdded=!0}return t}recalculateFromTo(t,s){const r=t.period;(t=Object.assign({},t)).from=+t.from,t.to=+t.to,t.fromDate=this.date(t.from),t.toDate=this.date(t.to).endOf(r);let a=Number.MAX_SAFE_INTEGER,l=0;const h=this.state.get("config.chart.items");if(Object.keys(h).length>0&&(0===t.from||0===t.to)){for(const t in h){const s=h[t];s.time.start<a&&s.time.start&&(a=s.time.start),s.time.end>l&&(l=s.time.end)}0===t.from&&(t.from=this.date(a).startOf(r).valueOf()),0===t.to&&(t.to=this.date(l).endOf(r).valueOf()),t.fromDate=this.date(t.from),t.toDate=this.date(t.to).endOf(r)}return t.from=t.fromDate.startOf(r).valueOf(),t.to=t.toDate.endOf(r).valueOf(),t.additionalSpaceAdded||((t=this.addAdditionalSpace(t)).additionalSpaceAdded=!0),t}getCenter(t){return t.leftGlobal+Math.round((t.rightGlobal-t.leftGlobal)/2)}getGlobalOffsetPxFromDates(t,s=this.state.get("$data.chart.time")){const r=t.valueOf(),a=s.allDates[s.level];if(!a)return-1;let l;for(let t=0,s=a.length;t<s;t++){const s=a[t];if(r<=s.rightGlobal){l=s;break}}if(l)return r<l.leftGlobal?l.leftPx:l.rightPx-(l.rightGlobal-r)/s.timePerPixel;{const r=t.valueOf();if(r<=s.leftGlobal)return 0;if(r>=s.rightGlobal)return s.totalViewDurationPx}}getViewOffsetPxFromDates(t,s=!0,r=this.state.get("$data.chart.time")){const a=this.getGlobalOffsetPxFromDates(t,r)-r.leftPx;return s&&this.limitOffsetPxToView(a),a}limitOffsetPxToView(t,s=this.state.get("$data.chart.time")){return t<0?0:t>s.width?s.width:t}findDateAtOffsetPx(t,s){return s.find(s=>s.leftPx>=t)}findDateAtTime(t,s){return s.find(s=>s.rightGlobal>=t)}getTimeFromViewOffsetPx(t,s,r=!0){const a=t+s.leftPx;let l=s.allDates[s.level];if(a<0){let t,r=s.fromDate.subtract(1,s.period),l=0;for(let h=0;h<1e3;h++){const h=this.generatePeriodDates({leftDate:r,rightDate:r.add(1,s.period),period:s.period,time:s,level:this.state.get(`config.chart.calendar.levels.${s.level}`),levelIndex:s.level,callOnDate:!0,callOnLevelDates:!1});if(h.length&&(t=h[0],l-=t.width,l<=a))return t.leftGlobal+(a-l)*s.timePerPixel;r=r.subtract(1,s.period).startOf(s.period)}}else if(a>s.totalViewDurationPx){let t,r,l=s.toDate.startOf("day").add(1,"day"),h=s.rightPx;for(let m=0;m<1e3;m++){const m=this.generatePeriodDates({leftDate:l,rightDate:l.add(1,s.period),period:s.period,time:s,level:this.state.get(`config.chart.calendar.levels.${s.level}`),levelIndex:s.level,callOnDate:!0,callOnLevelDates:!1});if(m.length&&(t=m[0],h+=t.width,h>=a))return r&&(t=r),t.rightGlobal-(h-a)*s.timePerPixel;l=l.add(1,s.period).startOf(s.period),r=t}}for(let t=0,h=l.length;t<h;t++){let h=l[t];if(h.rightPx>=a){const t=h.rightGlobal-Math.round((h.rightPx-a)*s.timePerPixel);return r?t+1:t}}return 0}calculateScrollPosPxFromTime(t,s,r){if(r||(r=this.state.get("config.scroll.horizontal")),!r.maxPosPx)return 0;s||(s=this.state.get("$data.chart.time"));const a=this.findDateAtTime(t,s.allDates[s.level]);return Math.round((r.maxPosPx-r.innerSize)*a.leftPercent)}getCurrentFormatForLevel(t,s){return t.formats.find(t=>+s.zoom<=+t.zoomTo)}generatePeriodDates({leftDate:t,rightDate:s,period:r,level:a,levelIndex:l,time:h,callOnDate:m,callOnLevelDates:b}){if(!h.timePerPixel)return[];let x=0;const S=Math.ceil(s.diff(t,r,!0));let O=[];for(let s=0;s<S;s++){const s=t.endOf(r);let a={leftGlobal:t.valueOf(),leftGlobalDate:t,rightGlobalDate:s,rightGlobal:s.valueOf(),width:0,leftPx:0,rightPx:0,period:r,formatted:null,current:t.valueOf()===this.currentDate[r].valueOf(),previous:t.add(1,r).valueOf()===this.currentDate[r].valueOf(),next:t.subtract(1,r).valueOf()===this.currentDate[r].valueOf()};const l=a.rightGlobal-a.leftGlobal;a.width=l/h.timePerPixel,a.leftPx=x,x+=a.width,a.rightPx=x,O.push(a),t=t.add(1,r)}const L=this.getCurrentFormatForLevel(a,h);if(m)for(let t=0,s=h.onDate.length;t<s;t++)O=O.map(s=>h.onDate[t]({date:s,format:L,time:h,level:a,levelIndex:l})).filter(t=>null!==t);if(b)for(let t=0,s=h.onLevelDates.length;t<s;t++)O=h.onLevelDates[t]({dates:O,format:L,time:h,level:a,levelIndex:l});return O}getDatesDiffPx(t,s,r,a=!0){if(t.valueOf()===s.valueOf())return 0;const l=r.allDates[r.level];if(0===l.length)return 0;let h=0,m=!1;if(s.valueOf()<t.valueOf()){const r=t;t=s,s=r,m=!0}let b=[];if(t.valueOf()<l[0].leftGlobal){const s=l[0].period,a=r.level,h=this.state.get(`config.chart.calendar.levels.${a}`);b=this.generatePeriodDates({leftDate:t,rightDate:l[0].leftGlobalDate,period:s,level:h,levelIndex:a,time:r,callOnDate:!0,callOnLevelDates:!1})}b=[...b,...l];const x=l[l.length-1].leftGlobalDate;if(s.valueOf()>x.valueOf()){const t=l[0].period,a=r.level,h=this.state.get(`config.chart.calendar.levels.${a}`),m=this.generatePeriodDates({leftDate:s,rightDate:x,period:t,level:h,levelIndex:a,time:r,callOnDate:!0,callOnLevelDates:!1});b=[...b,...m]}const S=this.state.get(`config.chart.calendar.levels.${r.level}`),O=this.getCurrentFormatForLevel(S,r);for(const t of r.onLevelDates)b=t({dates:b,time:r,format:O,level:S,levelIndex:r.level});let L,z,G=!1;for(L of b){if(L.leftGlobal>=t.valueOf()&&(G=!0,z=L),L.rightGlobal>=s.valueOf())break;G&&(h+=L.width)}if(a){let a=(t.valueOf()-L.leftGlobal)/r.timePerPixel;z&&(a=(t.valueOf()-z.leftGlobal)/r.timePerPixel);const l=(s.valueOf()-L.leftGlobal)/r.timePerPixel-a;return m?-h-l:h+l}return m?-h:h}getLeftViewDate(t=this.state.get("$data.chart.time")){if(!t.levels||!t.levels.length)return null;const s=t.levels[t.level];return s.length?s[0]:null}getRightViewDate(t=this.state.get("$data.chart.time")){if(!t.levels||!t.levels.length||!t.levels[t.level])return null;const s=t.levels[t.level];return s.length?s[s.length-1]:null}getLowerPeriod(t){switch(t){case"year":return"month";case"month":return"week";case"week":return"day";case"day":return"hour";case"hour":return"minute";case"minute":return"second";case"second":return"millisecond";default:return t}}getHigherPeriod(t){switch(t){case"month":return"year";case"week":return"month";case"day":return"week";case"hour":return"day";case"minute":return"hour";case"second":return"minute";case"millisecond":return"second";default:return t}}}function Matcher(t,s="*"){this.wchar=s,this.pattern=t,this.segments=[],this.starCount=0,this.minLength=0,this.maxLength=0,this.segStartIndex=0;for(let r=0,a=t.length;r<a;r+=1){const a=t[r];a===s&&(this.starCount+=1,r>this.segStartIndex&&this.segments.push(t.substring(this.segStartIndex,r)),this.segments.push(a),this.segStartIndex=r+1)}this.segStartIndex<t.length&&this.segments.push(t.substring(this.segStartIndex)),this.starCount?(this.minLength=t.length-this.starCount,this.maxLength=1/0):this.maxLength=this.minLength=t.length}function WildcardObject(t,s,r,a){this.obj=t,this.delimeter=s,this.wildcard=r,this.is_match=a}Matcher.prototype.match=function match(match){if(this.pattern===this.wchar)return!0;if(0===this.segments.length)return this.pattern===match;const{length:t}=match;if(t<this.minLength||t>this.maxLength)return!1;let s=this.segments.length-1,r=match.length-1,a=!1;for(;;){const t=this.segments[s];if(s-=1,t===this.wchar)a=!0;else{const s=r+1-t.length,l=match.lastIndexOf(t,s);if(-1===l||l>s)return!1;if(a)r=l-1,a=!1;else{if(l!==s)return!1;r-=t.length}}if(0>s)break}return!0},WildcardObject.prototype.simpleMatch=function simpleMatch(t,s){if(t===s)return!0;if(t===this.wildcard)return!0;if(this.is_match)return this.is_match(t,s);const r=t.indexOf(this.wildcard);if(r>-1){const a=t.substr(r+1);if(0===r||s.substring(0,r)===t.substring(0,r)){const t=a.length;return!(t>0)||s.substr(-t)===a}}return!1},WildcardObject.prototype.match=function match(t,s){return this.is_match?this.is_match(t,s):t===s||t===this.wildcard||s===this.wildcard||this.simpleMatch(t,s)||new Matcher(t).match(s)},WildcardObject.prototype.handleArray=function handleArray(t,s,r,a,l={}){let h=t.indexOf(this.delimeter,r),m=!1;-1===h&&(m=!0,h=t.length);const b=t.substring(r,h);let x=0;for(const r of s){const s=x.toString(),S=""===a?s:a+this.delimeter+x;(b===this.wildcard||b===s||this.simpleMatch(b,s))&&(m?l[S]=r:this.goFurther(t,r,h+1,S,l)),x++}return l},WildcardObject.prototype.handleObject=function handleObject(t,s,r,a,l={}){let h=t.indexOf(this.delimeter,r),m=!1;-1===h&&(m=!0,h=t.length);const b=t.substring(r,h);for(let r in s){r=r.toString();const x=""===a?r:a+this.delimeter+r;(b===this.wildcard||b===r||this.simpleMatch(b,r))&&(m?l[x]=s[r]:this.goFurther(t,s[r],h+1,x,l))}return l},WildcardObject.prototype.goFurther=function goFurther(t,s,r,a,l={}){return Array.isArray(s)?this.handleArray(t,s,r,a,l):this.handleObject(t,s,r,a,l)},WildcardObject.prototype.get=function get(t){return this.goFurther(t,this.obj,0,"")};class ObjectPath{static get(t,s,r=!1){let a=s;for(const s of t)if(a.hasOwnProperty(s))a=a[s];else{if(!r)return;a[s]={},a=a[s]}return a}static set(t,s,r){if(0===t.length){for(const t in s)r[t]=s[t];return}const a=t.slice(),l=a.pop(),h=ObjectPath.get(a,r,!0);return"object"==typeof h&&(h[l]=s),s}}let Nt,Rt=0,Lt=null;function getUint8Memory0(){return null!==Lt&&Lt.buffer===Nt.memory.buffer||(Lt=new Uint8Array(Nt.memory.buffer)),Lt}let zt=new TextEncoder("utf-8");const Vt="function"==typeof zt.encodeInto?function(t,s){return zt.encodeInto(t,s)}:function(t,s){const r=zt.encode(t);return s.set(r),{read:t.length,written:r.length}};function passStringToWasm0(t,s,r){if(void 0===r){const r=zt.encode(t),a=s(r.length);return getUint8Memory0().subarray(a,a+r.length).set(r),Rt=r.length,a}let a=t.length,l=s(a);const h=getUint8Memory0();let m=0;for(;m<a;m++){const s=t.charCodeAt(m);if(s>127)break;h[l+m]=s}if(m!==a){0!==m&&(t=t.slice(m)),l=r(l,a,a=m+3*t.length);const s=getUint8Memory0().subarray(l+m,l+a);m+=Vt(t,s).written}return Rt=m,l}function is_match(t,s){var r=passStringToWasm0(t,Nt.__wbindgen_malloc,Nt.__wbindgen_realloc),a=Rt,l=passStringToWasm0(s,Nt.__wbindgen_malloc,Nt.__wbindgen_realloc),h=Rt;return 0!==Nt.is_match(r,a,l,h)}async function init(t){("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:s,module:r}=await async function load(t,s){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,s)}catch(s){if("application/wasm"==t.headers.get("Content-Type"))throw s;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",s)}const r=await t.arrayBuffer();return await WebAssembly.instantiate(r,s)}{const r=await WebAssembly.instantiate(t,s);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}(await t,{});return Nt=s.exports,init.__wbindgen_wasm_module=r,Nt}const Gt={delimeter:".",notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,maxSimultaneousJobs:1e3,log:function log(t,s){console.debug(t,s)}},Ht={bulk:!1,debug:!1,source:"",data:void 0,queue:!1},Yt={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1};class DeepState{constructor(t={},s=Gt){this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.data=t,this.options=Object.assign(Object.assign({},Gt),s),this.id=0,this.pathGet=ObjectPath.get,this.pathSet=ObjectPath.set,this.scan=new WildcardObject(this.data,this.options.delimeter,this.options.wildcard)}loadWasmMatcher(t){return __awaiter(this,void 0,void 0,(function*(){yield init(t),this.is_match=is_match,this.scan=new WildcardObject(this.data,this.options.delimeter,this.options.wildcard,this.is_match)}))}same(t,s){return(["number","string","undefined","boolean"].includes(typeof t)||null===t)&&s===t}getListeners(){return this.listeners}destroy(){this.data=void 0,this.listeners=new Map}match(t,s){return this.is_match?this.is_match(t,s):t===s||(t===this.options.wildcard||s===this.options.wildcard||this.scan.match(t,s))}getIndicesOf(t,s){const r=t.length;if(0==r)return[];let a,l=0,h=[];for(;(a=s.indexOf(t,l))>-1;)h.push(a),l=a+r;return h}getIndicesCount(t,s){const r=t.length;if(0==r)return 0;let a,l=0,h=0;for(;(a=s.indexOf(t,l))>-1;)h++,l=a+r;return h}cutPath(t,s){t=this.cleanNotRecursivePath(t),s=this.cleanNotRecursivePath(s);const r=this.getIndicesCount(this.options.delimeter,s),a=this.getIndicesOf(this.options.delimeter,t);return t.substr(0,a[r])}trimPath(t){return(t=this.cleanNotRecursivePath(t)).charAt(0)===this.options.delimeter?t.substr(1):t}split(t){return""===t?[]:t.split(this.options.delimeter)}isWildcard(t){return t.includes(this.options.wildcard)}isNotRecursive(t){return t.endsWith(this.options.notRecursive)}cleanNotRecursivePath(t){return this.isNotRecursive(t)?t.substring(0,t.length-1):t}hasParams(t){return t.includes(this.options.param)}getParamsInfo(t){let s={replaced:"",original:t,params:{}},r=0,a=[];for(const l of this.split(t)){s.params[r]={original:l,replaced:"",name:""};const t=new RegExp(`\\${this.options.param}([^\\${this.options.delimeter}\\${this.options.param}]+)`,"g");let h=t.exec(l);h?(s.params[r].name=h[1],t.lastIndex=0,s.params[r].replaced=l.replace(t,this.options.wildcard),a.push(s.params[r].replaced),r++):(delete s.params[r],a.push(l),r++)}return s.replaced=a.join(this.options.delimeter),s}getParams(t,s){if(!t)return;const r=this.split(s),a={};for(const s in t.params){a[t.params[s].name]=r[s]}return a}waitForAll(t,s){const r={};for(let s of t)r[s]={dirty:!1},this.hasParams(s)&&(r[s].paramsInfo=this.getParamsInfo(s)),r[s].isWildcard=this.isWildcard(s),r[s].isRecursive=!this.isNotRecursive(s);return this.waitingListeners.set(t,{fn:s,paths:r}),s(r),function unsubscribe(){this.waitingListeners.delete(t)}}executeWaitingListeners(t){for(const s of this.waitingListeners.values()){const{fn:r,paths:a}=s;let l=0,h=0;for(let s in a){const r=a[s];let m=!1;r.isRecursive&&(t=this.cutPath(t,s)),r.isWildcard&&this.match(s,t)&&(m=!0),t===s&&(m=!0),m&&(r.dirty=!0),r.dirty&&l++,h++}l===h&&r(a)}}subscribeAll(t,s,r=Ht){let a=[];for(const l of t)a.push(this.subscribe(l,s,r));return function unsubscribe(){for(const t of a)t()}}getCleanListenersCollection(t={}){return Object.assign({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,count:0},t)}getCleanListener(t,s=Ht){return{fn:t,options:Object.assign(Object.assign({},Ht),s)}}getListenerCollectionMatch(t,s,r){t=this.cleanNotRecursivePath(t);const a=this;return function listenerCollectionMatch(l){return s&&(l=a.cutPath(l,t)),!(!r||!a.match(t,l))||t===l}}getListenersCollection(t,s){if(this.listeners.has(t)){let r=this.listeners.get(t);return r.listeners.set(++this.id,s),r}let r={isRecursive:!0,isWildcard:!1,hasParams:!1,paramsInfo:void 0,originalPath:t,path:t};this.hasParams(r.path)&&(r.paramsInfo=this.getParamsInfo(r.path),r.path=r.paramsInfo.replaced,r.hasParams=!0),r.isWildcard=this.isWildcard(r.path),this.isNotRecursive(r.path)&&(r.isRecursive=!1);let a=this.getCleanListenersCollection(Object.assign(Object.assign({},r),{match:this.getListenerCollectionMatch(r.path,r.isRecursive,r.isWildcard)}));return this.id++,a.listeners.set(this.id,s),this.listeners.set(r.path,a),a}subscribe(t,s,r=Ht,a="subscribe"){this.jobsRunning++;let l=this.getCleanListener(s,r);this.listenersIgnoreCache.set(l,{truthy:[],falsy:[]});const h=this.getListenersCollection(t,l);if(h.count++,t=h.path,h.isWildcard){const m=this.scan.get(this.cleanNotRecursivePath(t));if(r.bulk){const b=[];for(const t in m)b.push({path:t,params:this.getParams(h.paramsInfo,t),value:m[t]});s(b,{type:a,listener:l,listenersCollection:h,path:{listener:t,update:void 0,resolved:void 0},options:r,params:void 0})}else for(const b in m)s(m[b],{type:a,listener:l,listenersCollection:h,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(b)},params:this.getParams(h.paramsInfo,b),options:r})}else s(this.pathGet(this.split(this.cleanNotRecursivePath(t)),this.data),{type:a,listener:l,listenersCollection:h,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(t)},params:this.getParams(h.paramsInfo,t),options:r});return this.debugSubscribe(l,h,t),this.jobsRunning--,this.unsubscribe(t,this.id)}unsubscribe(t,s){const r=this.listeners,a=r.get(t);return function unsub(){a.listeners.delete(s),a.count--,0===a.count&&r.delete(t)}}runQueuedListeners(){if(0!==this.subscribeQueue.length)if(0===this.jobsRunning){const t=[...this.subscribeQueue];for(let s=0,r=t.length;s<r;s++)t[s]();this.subscribeQueue.length=0}else Promise.resolve().then(()=>this.runQueuedListeners())}notifyListeners(t,s=[],r=!0){const a=[];for(const l in t){let{single:h,bulk:m}=t[l];for(const t of h){if(s.includes(t))continue;const l=this.debugTime(t);t.listener.options.queue&&this.jobsRunning?this.subscribeQueue.push(()=>{t.listener.fn(t.value(),t.eventInfo)}):t.listener.fn(t.value(),t.eventInfo),r&&a.push(t),this.debugListener(l,t)}for(const t of m){if(s.includes(t))continue;const l=this.debugTime(t),h=[];for(const s of t.value)h.push(Object.assign(Object.assign({},s),{value:s.value()}));t.listener.options.queue&&this.jobsRunning?this.subscribeQueue.push(()=>!this.jobsRunning&&(t.listener.fn(h,t.eventInfo),!0)):t.listener.fn(h,t.eventInfo),r&&a.push(t),this.debugListener(l,t)}}return Promise.resolve().then(()=>this.runQueuedListeners()),a}shouldIgnore(t,s){if(!t.options.ignore)return!1;for(const r of t.options.ignore){if(s.startsWith(r))return!0;if(this.is_match&&this.is_match(r,s))return!0;{const t=this.cutPath(s,r);if(this.match(r,t))return!0}}return!1}getSubscribedListeners(t,s,r,a="update",l=null){r=Object.assign(Object.assign({},Yt),r);const h={};for(let[m,b]of this.listeners)if(h[m]={single:[],bulk:[],bulkData:[]},b.match(t)){const x=b.paramsInfo?this.getParams(b.paramsInfo,t):void 0,S=this.cutPath(t,m),O=b.isRecursive||b.isWildcard?()=>this.get(S):()=>s,L=[{value:O,path:t,params:x}];for(const s of b.listeners.values())this.shouldIgnore(s,t)||(s.options.bulk?h[m].bulk.push({listener:s,listenersCollection:b,eventInfo:{type:a,listener:s,path:{listener:m,update:l||t,resolved:void 0},params:x,options:r},value:L}):h[m].single.push({listener:s,listenersCollection:b,eventInfo:{type:a,listener:s,path:{listener:m,update:l||t,resolved:this.cleanNotRecursivePath(t)},params:x,options:r},value:O}))}return h}notifySubscribedListeners(t,s,r,a="update",l=null){return this.notifyListeners(this.getSubscribedListeners(t,s,r,a,l))}getNestedListeners(t,s,r,a="update",l=null){const h={};for(let[m,b]of this.listeners){h[m]={single:[],bulk:[]};const x=this.cutPath(m,t);if(this.match(x,t)){const S=this.trimPath(m.substr(x.length)),O=new WildcardObject(s,this.options.delimeter,this.options.wildcard).get(S),L=b.paramsInfo?this.getParams(b.paramsInfo,t):void 0,z=[],G={};for(const s in O){const value=()=>O[s],x=[t,s].join(this.options.delimeter);for(const[s,S]of b.listeners){const O={type:a,listener:S,listenersCollection:b,path:{listener:m,update:l||t,resolved:this.cleanNotRecursivePath(x)},params:L,options:r};this.shouldIgnore(S,t)||(S.options.bulk?(z.push({value:value,path:x,params:L}),G[s]=S):h[m].single.push({listener:S,listenersCollection:b,eventInfo:O,value:value}))}}for(const s in G){const l=G[s],x={type:a,listener:l,listenersCollection:b,path:{listener:m,update:t,resolved:void 0},options:r,params:L};h[m].bulk.push({listener:l,listenersCollection:b,eventInfo:x,value:z})}}}return h}notifyNestedListeners(t,s,r,a="update",l,h=null){return this.notifyListeners(this.getNestedListeners(t,s,r,a,h),l,!1)}getNotifyOnlyListeners(t,s,r,a="update",l=null){const h={};if("object"!=typeof r.only||!Array.isArray(r.only)||void 0===r.only[0]||!this.canBeNested(s))return h;for(const m of r.only){const b=new WildcardObject(s,this.options.delimeter,this.options.wildcard).get(m);h[m]={bulk:[],single:[]};for(const s in b){const x=t+this.options.delimeter+s;for(const[S,O]of this.listeners){const L=O.paramsInfo?this.getParams(O.paramsInfo,x):void 0;if(this.match(S,x)){const value=()=>b[s],z=[{value:value,path:x,params:L}];for(const s of O.listeners.values()){const b={type:a,listener:s,listenersCollection:O,path:{listener:S,update:l||t,resolved:this.cleanNotRecursivePath(x)},params:L,options:r};this.shouldIgnore(s,t)||(s.options.bulk?h[m].bulk.some(t=>t.listener===s)||h[m].bulk.push({listener:s,listenersCollection:O,eventInfo:b,value:z}):h[m].single.push({listener:s,listenersCollection:O,eventInfo:b,value:value}))}}}}}return h}notifyOnly(t,s,r,a="update",l=""){return void 0!==this.notifyListeners(this.getNotifyOnlyListeners(t,s,r,a,l))[0]}canBeNested(t){return"object"==typeof t&&null!==t}getUpdateValues(t,s,r){let a=r;return"function"==typeof r&&(a=r(this.pathGet(s,this.data))),{newValue:a,oldValue:t}}wildcardNotify(t,s){let r=[];for(const s of t){const t=this.notifyListeners(s,r);for(const s of t)r.push(s)}for(const t of s)this.executeWaitingListeners(t);this.jobsRunning--}wildcardUpdate(t,s,r=Yt,a=!1){++this.jobsRunning,r=Object.assign(Object.assign({},Yt),r);const l=this.scan.get(t),h={};for(const t in l){const a=this.split(t),{oldValue:m,newValue:b}=this.getUpdateValues(l[t],a,s);this.same(b,m)&&!r.force||(this.pathSet(a,b,this.data),h[t]=b)}const m=[],b=[];for(const s in h){const a=h[s];r.only.length?m.push(this.getNotifyOnlyListeners(s,a,r,"update",t)):(m.push(this.getSubscribedListeners(s,a,r,"update",t)),this.canBeNested(a)&&m.push(this.getNestedListeners(s,a,r,"update",t))),r.debug&&this.options.log("Wildcard update",{path:s,newValue:a}),b.push(s)}if(a){const t=this;return function(){return t.wildcardNotify(m,b)}}this.wildcardNotify(m,b)}runUpdateQueue(){for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){const t=this.updateQueue.shift();t.options.queue=!1,this.update(t.updatePath,t.fnOrValue,t.options,t.multi)}}updateNotify(t,s,r){const a=this.notifySubscribedListeners(t,s,r);this.canBeNested(s)&&this.notifyNestedListeners(t,s,r,"update",a),this.executeWaitingListeners(t)}updateNotifyOnly(t,s,r){this.notifyOnly(t,s,r),this.executeWaitingListeners(t)}update(t,s,r=Object.assign({},Yt),a=!1){const l=this.jobsRunning;if((this.options.queue||r.queue)&&l){if(l>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:t,fnOrValue:s,options:r,multi:a});const h=Promise.resolve().then(()=>{this.runUpdateQueue()});return a?function(){return h}:h}if(this.isWildcard(t))return this.wildcardUpdate(t,s,r,a);++this.jobsRunning;const h=this.split(t),{oldValue:m,newValue:b}=this.getUpdateValues(this.pathGet(h,this.data),h,s);if(r.debug&&this.options.log(`Updating ${t} ${r.source?`from ${r.source}`:""}`,{oldValue:m,newValue:b}),this.same(b,m)&&!r.force)return--this.jobsRunning,a?function(){return b}:b;if(this.pathSet(h,b,this.data),null===(r=Object.assign(Object.assign({},Yt),r)).only)return--this.jobsRunning,a?function(){}:b;if(r.only.length){if(--this.jobsRunning,a){const s=this;return function(){return s.updateNotifyOnly(t,b,r)}}return this.updateNotifyOnly(t,b,r),b}if(a){--this.jobsRunning;const s=this;return function(){return s.updateNotify(t,b,r)}}return this.updateNotify(t,b,r),--this.jobsRunning,b}multi(){const t=this,s=[];return{update(r,a,l=Yt){return s.push(t.update(r,a,l,!0)),this},done(){for(let t=0,r=s.length;t<r;t++)s[t]();s.length=0}}}get(t){return void 0===t||""===t?this.data:this.pathGet(this.split(t),this.data)}debugSubscribe(t,s,r){t.options.debug&&this.options.log("listener subscribed",{listenerPath:r,listener:t,listenersCollection:s})}debugListener(t,s){(s.eventInfo.options.debug||s.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-t,info:s})}debugTime(t){return t.listener.options.debug||t.eventInfo.options.debug?Date.now():0}}class Slots$1 extends Slots{constructor(t,s,r){super(s,r),this.subs=[],this.name=t,this.subs.push(s.state.subscribe(`config.slots.${t}`,this.setComponents,{queue:!0}))}destroy(){this.subs.forEach(t=>t()),super.destroy()}getName(){return this.name}}function generateSlots(t,s,r){return new Slots$1(t,s,r)}const n=t=>null!=t&&"boolean"==typeof t.isDirective,jt="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,o=(t,s,r=null,a=null)=>{for(;s!==r;){const r=s.nextSibling;t.insertBefore(s,a),s=r}},i=(t,s,r=null)=>{for(;s!==r;){const r=s.nextSibling;t.removeChild(s),s=r}},kt={},Wt={},Ft=`{{lit-${String(Math.random()).slice(2)}}}`,Xt=`\x3c!--${Ft}--\x3e`,Bt=new RegExp(`${Ft}|${Xt}`);class d{constructor(t,s){this.parts=[],this.element=s;const r=[],a=[],l=document.createTreeWalker(s.content,133,null,!1);let h=0,m=-1,b=0;const{strings:x,values:{length:S}}=t;for(;b<S;){const t=l.nextNode();if(null!==t){if(m++,1===t.nodeType){if(t.hasAttributes()){const s=t.attributes,{length:r}=s;let a=0;for(let t=0;t<r;t++)p(s[t].name,"$lit$")&&a++;for(;a-- >0;){const s=x[b],r=qt.exec(s)[2],a=r.toLowerCase()+"$lit$",l=t.getAttribute(a);t.removeAttribute(a);const h=l.split(Bt);this.parts.push({type:"attribute",index:m,name:r,strings:h,sanitizer:void 0}),b+=h.length-1}}"TEMPLATE"===t.tagName&&(a.push(t),l.currentNode=t.content)}else if(3===t.nodeType){const s=t.data;if(s.indexOf(Ft)>=0){const a=t.parentNode,l=s.split(Bt),h=l.length-1;for(let s=0;s<h;s++){let r,h=l[s];if(""===h)r=v();else{const t=qt.exec(h);null!==t&&p(t[2],"$lit$")&&(h=h.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),r=document.createTextNode(h)}a.insertBefore(r,t),this.parts.push({type:"node",index:++m})}""===l[h]?(a.insertBefore(v(),t),r.push(t)):t.data=l[h],b+=h}}else if(8===t.nodeType)if(t.data===Ft){const s=t.parentNode;null!==t.previousSibling&&m!==h||(m++,s.insertBefore(v(),t)),h=m,this.parts.push({type:"node",index:m}),null===t.nextSibling?t.data="":(r.push(t),m--),b++}else{let s=-1;for(;-1!==(s=t.data.indexOf(Ft,s+1));)this.parts.push({type:"node",index:-1}),b++}}else l.currentNode=a.pop()}for(const t of r)t.parentNode.removeChild(t)}}const p=(t,s)=>{const r=t.length-s.length;return r>=0&&t.slice(r)===s},u=t=>-1!==t.index,Ut=document.createComment(""),v=()=>Ut.cloneNode(),qt=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class f{constructor(t,s,r){this.__parts=[],this.template=t,this.processor=s,this.options=r}update(t){let s=0;for(const r of this.__parts)void 0!==r&&r.setValue(t[s]),s++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=jt?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),s=[],r=this.template.parts,a=document.createTreeWalker(t,133,null,!1);let l,h=0,m=0,b=a.nextNode();for(;h<r.length;)if(l=r[h],u(l)){for(;m<l.index;)m++,"TEMPLATE"===b.nodeName&&(s.push(b),a.currentNode=b.content),null===(b=a.nextNode())&&(a.currentNode=s.pop(),b=a.nextNode());if("node"===l.type){const t=this.processor.handleTextExpression(this.options,l);t.insertAfterNode(b.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(b,l.name,l.strings,this.options,l));h++}else this.__parts.push(void 0),h++;return jt&&(document.adoptNode(t),customElements.upgrade(t)),t}}let Kt;const Qt=` ${Ft} `,Jt=document.createElement("template");class _{constructor(t,s,r,a){this.strings=t,this.values=s,this.type=r,this.processor=a}getHTML(){const t=this.strings.length-1;let s="",r=!1;for(let a=0;a<t;a++){const t=this.strings[a],l=t.lastIndexOf("\x3c!--");r=(l>-1||r)&&-1===t.indexOf("--\x3e",l+1);const h=qt.exec(t);s+=null===h?t+(r?Qt:Xt):t.substr(0,h.index)+h[1]+h[2]+"$lit$"+h[3]+Ft}return s+=this.strings[t],s}getTemplateElement(){const t=Jt.cloneNode();return t.innerHTML=function(t){const s=window,r=s.trustedTypes||s.TrustedTypes;return r&&!Kt&&(Kt=r.createPolicy("lit-html",{createHTML:t=>t})),Kt?Kt.createHTML(t):t}(this.getHTML()),t}}class w extends _{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),s=t.content,r=s.firstChild;return s.removeChild(r),o(s,r.firstChild),t}}const N=t=>null===t||!("object"==typeof t||"function"==typeof t),P=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]),E=t=>t,I=(t,s,r)=>E;let Zt=I;const te=document.createTextNode("");class A{constructor(t,s,r,a,l="attribute"){this.dirty=!0,this.element=t,this.name=s,this.strings=r,this.parts=[];let h=a&&a.sanitizer;void 0===h&&(h=Zt(t,s,l),void 0!==a&&(a.sanitizer=h)),this.sanitizer=h;for(let t=0;t<r.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new T(this)}_getValue(){const t=this.strings,s=this.parts,r=t.length-1;if(1===r&&""===t[0]&&""===t[1]&&void 0!==s[0]){const t=s[0].value;if(!P(t))return t}let a="";for(let l=0;l<r;l++){a+=t[l];const r=s[l];if(void 0!==r){const t=r.value;if(N(t)||!P(t))a+="string"==typeof t?t:String(t);else for(const s of t)a+="string"==typeof s?s:String(s)}}return a+=t[r],a}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),"symbol"==typeof t&&(t=String(t)),this.element.setAttribute(this.name,t)}}}class T{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===kt||N(t)&&t===this.value||(this.value=t,n(t)||(this.committer.dirty=!0))}commit(){for(;n(this.value);){const t=this.value;this.value=kt,t.isClass?t.body(this):t(this)}this.value!==kt&&this.committer.commit()}}class Y{constructor(t,s){this.value=void 0,this.__pendingValue=void 0,this.textSanitizer=void 0,this.options=t,this.templatePart=s}appendInto(t){this.startNode=t.appendChild(v()),this.endNode=t.appendChild(v())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=v()),t.__insert(this.endNode=v())}insertAfterPart(t){t.__insert(this.startNode=v()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=kt,t.isClass?t.body(this):t(this)}const t=this.__pendingValue;t!==kt&&(N(t)?t!==this.value&&this.__commitText(t):t instanceof _?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):P(t)?this.__commitIterable(t):t===Wt?(this.value=Wt,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const s=this.startNode.nextSibling;if(t=null==t?"":t,s===this.endNode.previousSibling&&3===s.nodeType){void 0===this.textSanitizer&&(this.textSanitizer=Zt(s,"data","property"));const r=this.textSanitizer(t);s.data="string"==typeof r?r:String(r)}else{const s=te.cloneNode();this.__commitNode(s),void 0===this.textSanitizer&&(this.textSanitizer=Zt(s,"data","property"));const r=this.textSanitizer(t);s.data="string"==typeof r?r:String(r)}this.value=t}__commitTemplateResult(t){const s=this.options.templateFactory(t);if(this.value instanceof f&&this.value.template===s)this.value.update(t.values);else{const r=this.endNode.parentNode;if(Zt!==I&&"STYLE"===r.nodeName||"SCRIPT"===r.nodeName)return void this.__commitText("/* lit-html will not write TemplateResults to scripts and styles */");const a=new f(s,t.processor,this.options),l=a._clone();a.update(t.values),this.__commitNode(l),this.value=a}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const s=this.value;let r,a=0;for(const l of t)r=s[a],void 0===r&&(r=new Y(this.options,this.templatePart),s.push(r),0===a?r.appendIntoPart(this):r.insertAfterPart(s[a-1])),r.setValue(l),r.commit(),a++;a<s.length&&(s.length=a,this.clear(r&&r.endNode))}clear(t=this.startNode){i(this.startNode.parentNode,t.nextSibling,this.endNode)}}class C{constructor(t,s,r){if(this.value=void 0,this.__pendingValue=void 0,2!==r.length||""!==r[0]||""!==r[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=s,this.strings=r}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=kt,t.isClass?t.body(this):t(this)}if(this.__pendingValue===kt)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=kt}}class X extends A{constructor(t,s,r,a){super(t,s,r,a,"property"),this.single=2===r.length&&""===r[0]&&""===r[1]}_createPart(){return new V(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),this.element[this.name]=t}}}class V extends T{}let ee=!1;(()=>{try{const t={get capture(){return ee=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class k{constructor(t,s,r){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=s,this.eventContext=r,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=kt,t.isClass?t.body(this):t(this)}if(this.__pendingValue===kt)return;const t=this.__pendingValue,s=this.value,r=null==t||null!=s&&(t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive),a=null!=t&&(null==s||r);r&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),a&&(this.__options=D(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=kt}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const D=t=>t&&(ee?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);class ${handleAttributeExpressions(t,s,r,a,l){const h=s[0];return"."===h?new X(t,s.slice(1),r,l).parts:"@"===h?[new k(t,s.slice(1),a.eventContext)]:"?"===h?[new C(t,s.slice(1),r)]:new A(t,s,r,l).parts}handleTextExpression(t,s){return new Y(t,s)}}const ie=new $;function R(t){let s=ne.get(t.type);void 0===s&&(s={stringsArray:new WeakMap,keyString:new Map},ne.set(t.type,s));let r=s.stringsArray.get(t.strings);if(void 0!==r)return r;const a=t.strings.join(Ft);return r=s.keyString.get(a),void 0===r&&(r=new d(t,t.getTemplateElement()),s.keyString.set(a,r)),s.stringsArray.set(t.strings,r),r}const ne=new Map,se=new WeakMap;"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.7");var oe=Object.freeze({__proto__:null,html:(t,...s)=>new _(t,s,"html",ie),svg:(t,...s)=>new w(t,s,"svg",ie),DefaultTemplateProcessor:$,defaultTemplateProcessor:ie,directive:t=>(...s)=>{const r=t(...s);return r.isDirective=!0,r},Directive:class e{constructor(){this.isDirective=!0,this.isClass=!0}body(t){}},isDirective:n,removeNodes:i,reparentNodes:o,noChange:kt,nothing:Wt,AttributeCommitter:A,AttributePart:T,BooleanAttributePart:C,EventPart:k,isIterable:P,isPrimitive:N,NodePart:Y,PropertyCommitter:X,PropertyPart:V,get sanitizerFactory(){return Zt},setSanitizerFactory:t=>{if(Zt!==I)throw new Error("Attempted to overwrite existing lit-html security policy. setSanitizeDOMValueFactory should be called at most once.");Zt=t},parts:se,render:(t,s,r)=>{let a=se.get(s);void 0===a&&(i(s,s.firstChild),se.set(s,a=new Y(Object.assign({templateFactory:R},r),void 0)),a.appendInto(s)),a.setValue(t),a.commit()},templateCaches:ne,templateFactory:R,TemplateInstance:f,SVGTemplateResult:w,TemplateResult:_,createMarker:v,isTemplatePartActive:u,Template:d});document.createElement("template");(class xt{constructor(){this.isAction=!0}}).prototype.isAction=!0;document.createTextNode("");const re=mt.mergeDeep,ae="gantt-schedule-timeline-calendar";function getClass(t){let s=`${ae}__${t}`;return t===ae&&(s=ae),s}function prepareState(t){let s=function merge(t,s){return mt.mergeDeep(t,s)};"function"==typeof t.merge&&(s=t.merge);const r=function defaultConfig(){return{plugins:[],plugin:{},innerHeight:822,headerHeight:72,components:{Main:Main,ScrollBar:ScrollBar,List:List,ListColumn:ListColumn,ListColumnHeader:ListColumnHeader,ListColumnHeaderResizer:ListColumnHeaderResizer,ListColumnRow:ListColumnRow,ListColumnRowExpander:ListColumnRowExpander,ListColumnRowExpanderToggle:ListColumnRowExpanderToggle,ListToggle:ListToggle,Chart:Chart,ChartCalendar:ChartCalendar,ChartCalendarDate:ChartCalendarDay,ChartTimeline:ChartTimeline,ChartTimelineGrid:ChartTimelineGrid,ChartTimelineGridRow:ChartTimelineGridRow,ChartTimelineGridRowCell:ChartTimelineGridRowCell,ChartTimelineItems:ChartTimelineItems,ChartTimelineItemsRow:ChartTimelineItemsRow,ChartTimelineItemsRowItem:ChartTimelineItemsRowItem},wrappers:{Main:t=>t,ScrollBar:t=>t,List:t=>t,ListColumn:t=>t,ListColumnHeader:t=>t,ListColumnHeaderResizer:t=>t,ListColumnRow:t=>t,ListColumnRowExpander:t=>t,ListColumnRowExpanderToggle:t=>t,ListToggle:t=>t,Chart:t=>t,ChartCalendar:t=>t,ChartCalendarDate:t=>t,ChartTimeline:t=>t,ChartTimelineGrid:t=>t,ChartTimelineGridRow:t=>t,ChartTimelineGridRowCell:t=>t,ChartTimelineItems:t=>t,ChartTimelineItemsRow:t=>t,ChartTimelineItemsRowItem:t=>t},slots:generateEmptySlots(),list:{rows:{},row:{height:40,gap:{top:0,bottom:0}},columns:{percent:100,resizer:{width:10,inRealTime:!0,dots:6},minWidth:50,data:{}},expander:{padding:18,size:20,icon:{width:16,height:16},icons:{child:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><ellipse ry="4" rx="4" id="svg_1" cy="12" cx="12" fill="#000000B0"/></svg>',open:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>',closed:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>'}},toggle:{display:!0,icons:{open:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path stroke="null" d="m16.406954,16.012672l4.00393,-4.012673l-4.00393,-4.012673l1.232651,-1.232651l5.245324,5.245324l-5.245324,5.245324l-1.232651,-1.232651z"/><path stroke="null" d="m-0.343497,12.97734zm1.620144,0l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,3.909362l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,-9.773404l0,1.95468l11.341011,0l0,-1.95468l-11.341011,0z"/></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="rotate(-180 4.392796516418457,12) " stroke="null" d="m1.153809,16.012672l4.00393,-4.012673l-4.00393,-4.012673l1.232651,-1.232651l5.245324,5.245324l-5.245324,5.245324l-1.232651,-1.232651z"/><path stroke="null" d="m9.773297,12.97734zm1.620144,0l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,3.909362l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,-9.773404l0,1.95468l11.341011,0l0,-1.95468l-11.341011,0z"/></svg>'}}},scroll:{bodyClassName:"gstc-scrolling",horizontal:{size:20,minInnerSize:40,data:null,posPx:0,maxPosPx:0,area:0,multiplier:3,offset:0,smooth:!1},vertical:{size:20,minInnerSize:40,data:null,posPx:0,maxPosPx:0,area:0,multiplier:3,offset:0,smooth:!1}},chart:{time:{period:"day",from:0,to:0,zoom:20,leftGlobal:0,centerGlobal:0,rightGlobal:0,levels:[],calculatedZoomMode:!1,onLevelDates:[],onCurrentViewLevelDates:[],onDate:[],allDates:[],additionalSpaceAdded:!1},calendar:{expand:!0,levels:[{formats:[{zoomTo:17,period:"day",className:"gstc-date-medium gstc-date-left",format:({timeStart:t})=>t.format("DD MMMM YYYY (dddd)")},{zoomTo:23,period:"month",format:({timeStart:t})=>t.format("MMMM YYYY")},{zoomTo:24,period:"month",format:({timeStart:t,className:s,vido:r})=>t.format("MMMM 'YY")},{zoomTo:25,period:"month",format:({timeStart:t})=>t.format("MMM YYYY")},{zoomTo:27,period:"year",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:100,period:"year",default:!0,format:()=>null}]},{main:!0,formats:[{zoomTo:16,period:"hour",format:({timeStart:t})=>t.format("HH:mm")},{zoomTo:17,period:"hour",default:!0,format:({timeStart:t})=>t.format("HH")},{zoomTo:19,period:"day",className:"gstc-date-medium",format:({timeStart:t,className:s,vido:r})=>r.html`<span class="${s}-content gstc-date-bold">${t.format("DD")}</span> <span class="${s}-content gstc-date-thin">${t.format("dddd")}</span>`},{zoomTo:20,period:"day",default:!0,format:({timeStart:t,vido:s,className:r})=>s.html`<div class="${r}-content gstc-date-top">${t.format("DD")}</div><div class="${r}-content gstc-date-small">${t.format("dddd")}</div>`},{zoomTo:21,period:"day",format:({timeStart:t,vido:s,className:r})=>s.html`<div class="${r}-content gstc-date-top">${t.format("DD")}</div><div class="${r}-content gstc-date-small">${t.format("ddd")}</div>`},{zoomTo:22,period:"day",className:"gstc-date-vertical",format:({timeStart:t,className:s,vido:r})=>r.html`<div class="${s}-content gstc-date-top">${t.format("DD")}</div><div class="${s}-content gstc-date-extra-small">${t.format("ddd")}</div>`},{zoomTo:23,period:"week",default:!0,format:({timeStart:t,timeEnd:s,className:r,vido:a})=>a.html`<div class="${r}-content gstc-date-top">${t.format("DD")} - ${s.format("DD")}</div><div class="${r}-content gstc-date-small gstc-date-thin">${t.format("ddd")} - ${s.format("dd")}</div>`},{zoomTo:25,period:"week",className:"gstc-date-vertical",format:({timeStart:t,timeEnd:s,className:r,vido:a})=>a.html`<div class="${r}-content gstc-date-top gstc-date-small gstc-date-normal">${t.format("DD")}</div><div class="gstc-dash gstc-date-small">-</div><div class="${r}-content gstc-date-small gstc-date-normal">${s.format("DD")}</div>`},{zoomTo:26,period:"month",default:!0,className:"gstc-date-month-level-1",format:({timeStart:t,vido:s,className:r})=>s.html`<div class="${r}-content gstc-date-top">${t.format("MMM")}</div><div class="${r}-content gstc-date-small gstc-date-bottom">${t.format("MM")}</div>`},{zoomTo:27,period:"month",className:"gstc-date-vertical",format:({timeStart:t,className:s,vido:r})=>r.html`<div class="${s}-content gstc-date-top">${t.format("MM")}</div><div class="${s}-content gstc-date-extra-small">${t.format("MMM")}</div>`},{zoomTo:28,period:"year",default:!0,className:"gstc-date-big",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:29,period:"year",className:"gstc-date-medium",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:30,period:"year",className:"gstc-date-medium",format:({timeStart:t})=>t.format("YY")},{zoomTo:100,period:"year",default:!0,format:()=>null}]}]},grid:{cell:{onCreate:[]}},item:{gap:{top:4,bottom:4},top:0,height:32,minWidth:10},items:{},spacing:1},classNames:{},actions:generateEmptyActions(),locale:{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:t=>{const s=["th","st","nd","rd"],r=t%100;return`[${t}${s[(r-20)%10]||s[r]||s[0]}]`}},utcMode:!1,usageStatistics:!0,merge:(t,s)=>mt.mergeDeep({},t,s)}}(),a=function mergeActions(t,s,r){const a=r({},s.actions),l=r({},t.actions);let h=[...Object.keys(a),...Object.keys(l)];h=h.filter(t=>h.includes(t));const m={};for(const t of h)m[t]=[],void 0!==a[t]&&Array.isArray(a[t])&&(m[t]=[...a[t]]),void 0!==l[t]&&Array.isArray(l[t])&&(m[t]=[...m[t],...l[t]]);return delete t.actions,delete s.actions,m}(t,r,s),l={config:s(r,t)};return l.config.actions=a,l}const le={name:ae,stateFromConfig:function stateFromConfig(t){return this.state=new DeepState(prepareState(t),{delimeter:".",maxSimultaneousJobs:1e3})},wasmStateFromConfig:function wasmStateFromConfig(t,s="./wildcard_matcher_bg.wasm"){return __awaiter(this,void 0,void 0,(function*(){return this.state=new DeepState(prepareState(t),{delimeter:".",maxSimultaneousJobs:1e3}),yield this.state.loadWasmMatcher(s),this.state}))},merge:re,lithtml:oe,date:t=>t?It(t):It(),setPeriod(t){return this.state.update("config.chart.time.period",t),this.state.get("config.chart.time.zoom")},dayjs:It};class Api{constructor(t){this.name=ae,this.debug=!1,this.iconsCache={},this.unsubscribes=[],this.generateSlots=generateSlots,this.mergeDeep=re,this.getClass=getClass,this.allActions=[],this.state=t,this.time=new Time(this.state,this),this.debug&&(window.state=t,window.api=api)}setVido(t){this.vido=t}log(...t){this.debug&&console.log.call(console,...t)}getActions(t){this.allActions.includes(t)||this.allActions.push(t);let s=this.state.get("config.actions."+t);return void 0===s&&(s=[]),s.slice()}isItemInViewport(t,s,r){return t.time.start<=r&&t.time.end>=s}getAllLinkedItemsIds(t,s,r=[]){if(t.linkedWith&&t.linkedWith.length){r.includes(t.id)||r.push(t.id);for(const a of t.linkedWith){if(r.includes(a))continue;r.push(a);const l=s[a];if(!l)throw new Error(`Linked item not found [id:'${a}'] found in item [id:'${t.id}']`);l.linkedWith&&l.linkedWith.length&&this.getAllLinkedItemsIds(l,s,r)}}return r}prepareLinkedItems(t,s){const r=this.getAllLinkedItemsIds(t,s);for(const a of r){const l=s[a];if(!l)throw new Error(`Linked item not found [id:'${a}'] found in item [id:'${t.id}']`);l.linkedWith=r.filter(t=>t!==l.id)}}prepareItems(t){const s=this.state.get("config.chart.item.height");for(const r in t){const a=t[r];this.prepareLinkedItems(a,t),a.time.start=+a.time.start,a.time.end=+a.time.end,a.id=String(a.id);const l=this.state.get("config.chart.item");"number"!=typeof a.height&&(a.height=s),a.$data||(a.$data={actualHeight:0,outerHeight:0,time:null,position:{left:0,actualLeft:0,right:0,actualRight:0,top:a.top||0,actualTop:a.top||0,viewTop:0},width:-1,actualWidth:-1,detached:!1}),a.$data.time={startDate:this.time.date(a.time.start),endDate:this.time.date(a.time.end)},a.$data.actualHeight=a.height,"number"!=typeof a.top&&(a.top=0),a.gap||(a.gap={}),"number"!=typeof a.gap.top&&(a.gap.top=l.gap.top),"number"!=typeof a.gap.bottom&&(a.gap.bottom=l.gap.bottom),"number"!=typeof a.minWidth&&(a.minWidth=l.minWidth),a.$data.outerHeight=a.$data.actualHeight+a.gap.top+a.gap.bottom,a.$data.position.actualTop=a.$data.position.top+a.gap.top}return t}fillEmptyRowValues(t){const s=this.state.get("config.list.row.height");let r=0;for(const a in t){const l=t[a];l.$data||(l.$data={parents:[],children:[],position:{top:0,topPercent:0,bottomPercent:0,viewTop:0},items:[],actualHeight:0,outerHeight:0}),"number"!=typeof l.height&&(l.height=s),l.$data.actualHeight=l.height,"boolean"!=typeof l.expanded&&(l.expanded=!1),l.$data.position.top=r,"object"!=typeof l.gap&&(l.gap={}),"number"!=typeof l.gap.top&&(l.gap.top=0),"number"!=typeof l.gap.bottom&&(l.gap.bottom=0),l.$data.outerHeight=l.$data.actualHeight+l.gap.top+l.gap.bottom,r+=l.$data.outerHeight}return t}itemsOnTheSameLevel(t,s){const r=t.$data.position.top+t.$data.outerHeight,a=s.$data.position.top+s.$data.outerHeight;return s.$data.position.top<=t.$data.position.top&&a>t.$data.position.top||(s.$data.position.top>=t.$data.position.top&&s.$data.position.top<r||s.$data.position.top>=t.$data.position.top&&a<r)}itemsOverlaps(t,s){return!!this.itemsOnTheSameLevel(t,s)&&(s.time.start>=t.time.start&&s.time.start<=t.time.end||(s.time.end>=t.time.start&&s.time.end<=t.time.end||(s.time.start>=t.time.start&&s.time.end<=t.time.end||s.time.start<=t.time.start&&s.time.end>=t.time.end)))}itemOverlapsWithOthers(t,s){for(let r=0,a=s.length;r<a;r++){const a=s[r],l=a.time.start&&t.time.start&&a.time.end&&t.time.end;if(t.id!==a.id&&this.itemsOverlaps(t,a)&&l)return a}return null}fixOverlappedItems(t){if(0===t.length)return;let s=0;for(let r of t){r.$data.position.top=r.top,r.$data.position.actualTop=r.$data.position.top+r.gap.top;let a=this.itemOverlapsWithOthers(r,t);if(s&&a)for(;a=this.itemOverlapsWithOthers(r,t);)r.$data.position.top+=a.$data.outerHeight,r.$data.position.actualTop=r.$data.position.top+r.gap.top;s++}}sortItemsByPositionTop(t){return t.sort((t,s)=>t.$data.position.top-s.$data.position.top)}recalculateRowHeight(t,s=!1){let r=0;s&&(this.fixOverlappedItems(t.$data.items),t.$data.items=this.sortItemsByPositionTop(t.$data.items));for(const s of t.$data.items)r=Math.max(r,s.$data.position.top+s.$data.outerHeight);return r<t.height&&(r=t.height),t.$data.actualHeight=r,t.$data.outerHeight=t.$data.actualHeight+t.gap.top+t.gap.bottom,t.$data.outerHeight}recalculateRowsHeightsAndFixOverlappingItems(t){let s=0;for(const r of t)this.recalculateRowHeight(r,!0),r.$data.position.top=s,s+=r.$data.outerHeight;return s}recalculateRowsPercents(t,s){let r=0;for(const a of t)s<=0?(a.$data.position.topPercent=0,a.$data.position.bottomPercent=0):(a.$data.position.topPercent=r?r/s:0,a.$data.position.bottomPercent=(r+a.$data.outerHeight)/s),r+=a.$data.outerHeight;return t}generateParents(t,s="parentId"){const r={};for(const a in t){const l=t[a],h=void 0!==l[s]&&null!==l[s]?l[s]:"";void 0===r[h]&&(r[h]={}),r[h][l.id]=l}return r}fastTree(t,s,r=[]){const a=t[s.id];if(s.$data.parents=r,void 0===a)return s.$data.children=[],s;""!==s.id&&(r=[...r,s.id]),s.$data.children=Object.values(a);for(const s in a){const l=a[s];this.fastTree(t,l,r)}return s}makeTreeMap(t,s){const r=this.generateParents(s,"rowId");for(const s in t){if(!t[s].$data)return;t[s].$data.items=void 0!==r[s]?Object.values(r[s]):[]}const a=this.generateParents(t);return this.fastTree(a,{id:"",$data:{children:[],parents:[],items:[]}})}getRowsWithParentsExpanded(t){const s=[];t:for(const r in t){if(!t[r].$data||!t[r].$data.parents)return[];for(const s of t[r].$data.parents){const r=t[s];if(!r||!r.expanded)continue t}s.push(t[r])}return s}getVisibleRows(t){if(0===t.length)return[];const s=[],r=this.state.get("config.scroll.vertical");let a=r.data;a||(a=t[0]);let l=this.state.get("$data.innerHeight");if(!l)return[];l+=r.offset||0;let h=t.find(t=>t.id===a.id),m=t.indexOf(h);if(void 0===m)return[];let b=0;for(let r=t.length;m<=r;m++){const r=t[m];if(void 0!==r&&(b<=l&&(r.$data.position.viewTop=b,s.push(r)),b+=r.$data.outerHeight,b>=l))break}return s}normalizeMouseWheelEvent(t){let s=t.deltaX||0,r=t.deltaY||0,a=t.deltaZ||0;const l=t.deltaMode,h=this.state.get("config.list.rowHeight");let m=1;switch(l){case 1:h&&(m=h);break;case 2:m=window.height}return s*=m,r*=m,a*=m,{x:s,y:r,z:a,event:t}}scrollToTime(t,s=!0,r=this.state.get("$data.chart.time")){if(s){t-=this.state.get("$data.chart.dimensions.width")/2*r.timePerPixel}const a=this.time.findDateAtTime(t,r.allDates[r.level]);let l=r.allDates[r.level].indexOf(a);return-1===l?0:this.setScrollLeft(l,r).posPx}setScrollLeft(t,s=this.state.get("$data.chart.time"),r,a="scroll"){void 0===t&&(t=0);let l=!0;void 0===r&&(l=!1,r=this.state.multi());const h=s.allDates[s.level];if(!h)return;const m=h[t];if(!m)return;let b;return r=r.update("config.scroll.horizontal",r=>{r.data=Object.assign({},m);const a=s.allDates[s.level].length-r.lastPageCount;t>a&&(t=a),r.dataIndex=t,r.posPx=this.time.calculateScrollPosPxFromTime(r.data.leftGlobal,s,r);const l=r.maxPosPx-r.innerSize;return r.posPx>l&&(r.posPx=l),b=r,r}),a&&(r=r.update("$data.chart.time.recalculateTimesLastReason",a)),l?r:(r.done(),b)}getScrollLeft(){return this.state.get("config.scroll.horizontal")}setScrollTop(t,s=0){void 0===t&&(t=0);const r=this.state.get("$data.list.rowsWithParentsExpanded");r[t]||0===t||(t=0),r[t]&&this.state.update("config.scroll.vertical",a=>{const l=r.length-a.lastPageCount;return t+a.lastPageCount>r.length&&(t=l),t===l&&(s=0),a.data=r[t],a.offset=s,a.posPx=r[t].$data.position.topPercent*a.maxPosPx+Math.floor(a.scrollArea*(s/a.area)),a.dataIndex=t,a})}getScrollTop(){return this.state.get("config.scroll.vertical")}getSVGIconSrc(t){return"string"==typeof this.iconsCache[t]||(this.iconsCache[t]="data:image/svg+xml;base64,"+btoa(t)),this.iconsCache[t]}destroy(){for(const t of this.unsubscribes)t();this.unsubscribes=[],this.debug&&delete window.state}}function GSTC(t){const s=t.state,r=new Api(s),a={treeMap:{id:"",$data:{children:[],parents:[],items:[]}},list:{visibleRows:[],visibleRowsHeight:0,rowsWithParentsExpanded:[],rowsHeight:0,width:0},dimensions:{width:0,height:0},chart:{dimensions:{width:0,innerWidth:0,height:0},visibleItems:[],time:{zoom:0,format:{period:"day",zoomTo:0,format:()=>""},level:0,levels:[],timePerPixel:0,totalViewDurationMs:0,totalViewDurationPx:0,leftGlobal:0,rightGlobal:0,leftPx:0,rightPx:0,leftInner:0,rightInner:0,period:"day",leftGlobalDate:null,rightGlobalDate:null,centerGlobal:0,centerGlobalDate:null,from:0,to:0,fromDate:null,toDate:null,additionalSpaceAdded:!1}},elements:{}};"boolean"==typeof t.debug&&t.debug&&(window.state=s),s.update("",t=>({config:t.config,$data:a}));const l=Vido(s,r);r.setVido(l);const h=s.get("config.components.Main"),m=l.createApp({component:h,props:{},element:t.element}),b=m.vidoInstance.api;const x={state:s,api:b,component:m,destroy:function destroy(){m.destroy()},reload:function reload(){x.component.destroy();const r=s.get("config.components.Main");x.component=l.createApp({component:r,props:{},element:t.element}),x.api=m.vidoInstance.api,x.component.update()}};return x}return GSTC.api=le,GSTC}));
