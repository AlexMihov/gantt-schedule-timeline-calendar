function t(t){return t&&"object"==typeof t&&t.constructor&&"Object"===t.constructor.name}const e={enabled:!0,bodyClassName:"gstc-scrolling"};function n(n=e){let i,o,r,s=n.enabled;class a{constructor(t){this.moving=!1,this.initialDataIndex={x:0,y:0},this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this),this.pointerMove=i.schedule(this.pointerMove.bind(this)),t.addEventListener("pointerdown",this.pointerDown),document.addEventListener("pointermove",this.pointerMove,{passive:!0}),document.addEventListener("pointerup",this.pointerUp),t.style.cursor="grab"}destroy(t){t.removeEventListener("pointerdown",this.pointerDown),document.removeEventListener("pointermove",this.pointerMove),document.removeEventListener("pointerup",this.pointerUp)}resetInitialPoint(t){this.initialPoint={x:t.screenX,y:t.screenY}}pointerDown(t){if(!s)return;document.body.classList.add(n.bodyClassName),this.moving=!0,this.resetInitialPoint(t);const e=r.get("config.scroll");this.initialDataIndex={x:e.horizontal.dataIndex||0,y:e.vertical.dataIndex||0}}pointerUp(){s&&(document.body.classList.remove(n.bodyClassName),this.moving&&(this.moving=!1))}handleHorizontalMovement(t,e){const n=r.get("$data.chart.time");if(t.x>0){if(0===this.initialDataIndex.x)return this.resetInitialPoint(e);const i=n.allDates[n.level];let r=this.initialDataIndex.x-1,s=0;for(;r>0;r--){if(s+=i[r].width,s>=t.x)break}o.setScrollLeft(r,n)}else if(t.x<0){let i=this.initialDataIndex.x;const s=r.get("config.scroll.horizontal"),a=n.allDates[n.level];if(i-1>=a.length-s.lastPageCount)return this.resetInitialPoint(e);let l=0;for(let e=a.length;i<e;i++){if(l+=a[i].width,-l<=t.x)break}if(i-1>=a.length-s.lastPageCount)return;o.setScrollLeft(i,n)}}pointerMove(t){if(!s||!this.moving)return;const e={x:t.screenX-this.initialPoint.x,y:t.screenY-this.initialPoint.y};this.handleHorizontalMovement(e,t)}}return function(e){i=e,o=i.api,r=i.state;const l=e.state.get("config.plugin.CalendarScroll");return l&&(n=function e(n,...i){const o=i.shift();if(t(n)&&t(o))for(const i in o)if(t(o[i]))"function"==typeof o[i].clone?n[i]=o[i].clone():(void 0===n[i]&&(n[i]={}),n[i]=e(n[i],o[i]));else if(Array.isArray(o[i])){n[i]=new Array(o[i].length);let r=0;for(let s of o[i])t(s)?"function"==typeof s.clone?n[i][r]=s.clone():n[i][r]=e({},s):n[i][r]=s,r++}else n[i]=o[i];return i.length?e(n,...i):n}({},n,l)),r.update("config.plugin.CalendarScroll",n),r.subscribe("config.plugin.CalendarScroll.enabled",t=>s=t),r.update("config.actions.chart-calendar",t=>(t.push(a),t)),function(){r.update("config.actions.chart-calendar",t=>t.filter(t=>t!==a))}}}export{n as Plugin};
