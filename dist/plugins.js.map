{"version":3,"file":"plugins.js","sources":["../src/plugins/ItemHold.plugin.js","../src/plugins/ItemMovement.plugin.js","../src/plugins/SaveAsImage.plugin.js"],"sourcesContent":["/**\n * ItemsHold plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0\n */\n\nexport default function ItemHold(options = {}) {\n  const defaultOptions = {\n    time: 1000,\n    movementThreshold: 2,\n    action(element, data) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  const holding = {};\n  const mouse = { x: 0, y: 0 };\n\n  function onMouseDown(item, element, event) {\n    if (typeof holding[item.id] === 'undefined') {\n      holding[item.id] = { x: event.x, y: event.y };\n      setTimeout(() => {\n        if (typeof holding[item.id] !== 'undefined') {\n          let exec = true;\n          let xMovement = holding[item.id].x - mouse.x;\n          if (Math.sign(xMovement) === -1) {\n            xMovement = -xMovement;\n          }\n          let yMovement = holding[item.id].y - mouse.y;\n          if (Math.sign(yMovement) === -1) {\n            yMovement = -yMovement;\n          }\n          if (xMovement > options.movementThreshold) {\n            exec = false;\n          }\n          if (yMovement > options.movementThreshold) {\n            exec = false;\n          }\n          delete holding[item.id];\n          if (exec) {\n            options.action(element, item);\n          }\n        }\n      }, options.time);\n    }\n  }\n\n  function onMouseUp(itemId) {\n    if (typeof holding[itemId] !== 'undefined') {\n      delete holding[itemId];\n    }\n  }\n\n  function action(element, data) {\n    function elementMouseDown(event) {\n      onMouseDown(data.item, element, event);\n    }\n    element.addEventListener('mousedown', elementMouseDown);\n    function mouseUp() {\n      onMouseUp(data.item.id);\n    }\n\n    document.addEventListener('mouseup', mouseUp);\n    function onMouseMove(event) {\n      mouse.x = event.x;\n      mouse.y = event.y;\n    }\n\n    document.addEventListener('mousemove', onMouseMove);\n    return {\n      update(element, changedData) {\n        data = changedData;\n      },\n      destroy(element, data) {\n        document.removeEventListener('mouseup', onMouseUp);\n        document.removeEventListener('mousemove', onMouseMove);\n        element.removeEventListener('mousedown', elementMouseDown);\n      }\n    };\n  }\n\n  return function initializePlugin(state, api) {\n    state.update('config.actions.chart-timeline-items-row-item', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n","/**\n * ItemMovement plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0\n */\n\n//- @ts-nocheck\nexport default function ItemMovement(options = {}) {\n  const defaultOptions = {\n    moveable: true,\n    resizeable: true,\n    resizerContent: '',\n    collisionDetection: true,\n    outOfBorders: false,\n    snapStart: (timeStart, startDiff) => timeStart + startDiff,\n    snapEnd: (timeEnd, endDiff) => timeEnd + endDiff,\n    ghostNode: true\n  };\n  options = { ...defaultOptions, ...options };\n  const movementState = {};\n\n  /**\n   * Add moving functionality to items as action\n   *\n   * @param {Node} node DOM Node\n   * @param {Object} data\n   */\n  function action(node, data) {\n    const element = node.querySelector('.gantt-schedule-timeline-calendar__chart-timeline-items-row-item-content');\n    if (!options.moveable && !options.resizeable) {\n      return;\n    }\n    let moveable = options.moveable;\n    if (data.item.hasOwnProperty('moveable') && moveable) {\n      moveable = data.item.moveable;\n    }\n    if (data.row.hasOwnProperty('moveable') && moveable) {\n      moveable = data.row.moveable;\n    }\n    let resizeable = options.resizeable && (!data.item.hasOwnProperty('resizeable') || data.item.resizeable === true);\n    if (data.row.hasOwnProperty('resizeable') && resizeable) {\n      resizeable = data.row.resizeable;\n    }\n    const api = data.api;\n    let snapStart = options.snapStart;\n    if (typeof data.item.snapStart === 'function') {\n      snapStart = data.item.snapStart;\n    }\n    let snapEnd = options.snapEnd;\n    if (typeof data.item.snapEnd === 'function') {\n      snapEnd = data.item.snapEnd;\n    }\n\n    if (resizeable) {\n      const resizerHTML = `<div class=\"${api.getClass('chart-timeline-items-row-item-content-resizer')}\">${\n        options.resizerContent\n      }</div>`;\n      // @ts-ignore\n      element.insertAdjacentHTML('beforeend', resizerHTML);\n    }\n\n    const el = element;\n    const resizerEl = el.querySelector(\n      '.gantt-schedule-timeline-calendar__chart-timeline-items-row-item-content-resizer'\n    );\n    const state = data.state;\n\n    function getMovement() {\n      const itemId = data.item.id;\n      if (typeof movementState[itemId] === 'undefined') {\n        movementState[itemId] = { moving: false, resizing: false };\n      }\n      return movementState[itemId];\n    }\n\n    function createGhost(itemId, ev, ganttLeft, ganttTop) {\n      const movement = getMovement();\n      if (!options.ghostNode || typeof movement.ghost !== 'undefined') {\n        return;\n      }\n      const ghost = element.cloneNode(true);\n      const style = getComputedStyle(element);\n      ghost.style.position = 'absolute';\n      ghost.style.left = ev.x - ganttLeft - movement.itemLeftCompensation + 'px';\n      const itemTop = ev.y - ganttTop - data.row.top - element.offsetTop;\n      movement.itemTop = itemTop;\n      ghost.style.top = ev.y - ganttTop - itemTop + 'px';\n      ghost.style.width = style.width;\n      ghost.style['box-shadow'] = '10px 10px 6px #00000020';\n      const height = element.clientHeight + 'px';\n      ghost.style.height = height;\n      ghost.style['line-height'] = height;\n      ghost.style.opacity = '0.75';\n      state.get('_internal.elements.gantt').appendChild(ghost);\n      movement.ghost = ghost;\n      return ghost;\n    }\n\n    function moveGhost(ev) {\n      if (options.ghostNode) {\n        const movement = getMovement();\n        const left = ev.x - movement.ganttLeft - movement.itemLeftCompensation;\n        movement.ghost.style.left = left + 'px';\n        movement.ghost.style.top = ev.y - movement.ganttTop - movement.itemTop + 'px';\n      }\n    }\n\n    function destroyGhost(itemId) {\n      if (!options.ghostNode) {\n        return;\n      }\n      if (typeof movementState[itemId] !== 'undefined' && typeof movementState[itemId].ghost !== 'undefined') {\n        state.get('_internal.elements.gantt').removeChild(movementState[itemId].ghost);\n        delete movementState[itemId].ghost;\n      }\n      element.style.opacity = '1';\n    }\n\n    function labelMouseDown(ev) {\n      if (ev.button !== 0) {\n        return;\n      }\n      const movement = getMovement();\n      movement.moving = true;\n      const item = state.get(`config.chart.items.${data.item.id}`);\n      const chartLeftTime = state.get('_internal.chart.time.leftGlobal');\n      const timePerPixel = state.get('_internal.chart.time.timePerPixel');\n      const ganttRect = state.get('_internal.elements.gantt').getBoundingClientRect();\n      movement.ganttTop = ganttRect.top;\n      movement.ganttLeft = ganttRect.left;\n      movement.itemX = Math.round((item.time.start - chartLeftTime) / timePerPixel);\n      movement.itemLeftCompensation = ev.x - movement.ganttLeft - movement.itemX;\n      createGhost(data.item.id, ev, ganttRect.left, ganttRect.top);\n    }\n\n    function resizerMouseDown(ev) {\n      if (ev.button !== 0) {\n        return;\n      }\n      ev.stopPropagation();\n      const movement = getMovement();\n      movement.resizing = true;\n      const item = state.get(`config.chart.items.${data.item.id}`);\n      const chartLeftTime = state.get('_internal.chart.time.leftGlobal');\n      const timePerPixel = state.get('_internal.chart.time.timePerPixel');\n      const ganttRect = state.get('_internal.elements.gantt').getBoundingClientRect();\n      movement.ganttTop = ganttRect.top;\n      movement.ganttLeft = ganttRect.left;\n      movement.itemX = (item.time.end - chartLeftTime) / timePerPixel;\n      movement.itemLeftCompensation = ev.x - movement.ganttLeft - movement.itemX;\n    }\n\n    function isCollision(rowId, itemId, start, end) {\n      if (!options.collisionDetection) {\n        return false;\n      }\n      const time = state.get('_internal.chart.time');\n      if (options.outOfBorders && (start < time.from || end > time.to)) {\n        return true;\n      }\n      let diff = api.time.date(end).diff(start, 'milliseconds');\n      if (Math.sign(diff) === -1) {\n        diff = -diff;\n      }\n      if (diff <= 1) {\n        return true;\n      }\n      const row = state.get('config.list.rows.' + rowId);\n      for (const rowItem of row._internal.items) {\n        if (rowItem.id !== itemId) {\n          if (start >= rowItem.time.start && start <= rowItem.time.end) {\n            return true;\n          }\n          if (end >= rowItem.time.start && end <= rowItem.time.end) {\n            return true;\n          }\n          if (start <= rowItem.time.start && end >= rowItem.time.end) {\n            return true;\n          }\n        }\n      }\n      return false;\n    }\n\n    function movementX(ev, row, item, zoom, timePerPixel) {\n      const movement = getMovement();\n      const left = ev.x - movement.ganttLeft - movement.itemLeftCompensation;\n      moveGhost(ev);\n      const leftMs = state.get('_internal.chart.time.leftGlobal') + left * timePerPixel;\n      const add = leftMs - item.time.start;\n      const originalStart = item.time.start;\n      const finalStartTime = snapStart(item.time.start, add, item);\n      const finalAdd = finalStartTime - originalStart;\n      const collision = isCollision(row.id, item.id, item.time.start + finalAdd, item.time.end + finalAdd);\n      if (finalAdd && !collision) {\n        state.update(`config.chart.items.${data.item.id}.time`, function moveItem(time) {\n          time.start += finalAdd;\n          time.end = snapEnd(time.end, finalAdd, item) - 1;\n          return time;\n        });\n      }\n    }\n\n    function resizeX(ev, row, item, zoom, timePerPixel) {\n      const time = state.get('_internal.chart.time');\n      const movement = getMovement();\n      const left = ev.x - movement.ganttLeft - movement.itemLeftCompensation;\n      const leftMs = time.leftGlobal + left * timePerPixel;\n      const add = leftMs - item.time.end;\n      if (item.time.end + add < item.time.start) {\n        return;\n      }\n      const originalEnd = item.time.end;\n      const finalEndTime = snapEnd(item.time.end, add, item) - 1;\n      const finalAdd = finalEndTime - originalEnd;\n      const collision = isCollision(row.id, item.id, item.time.start, item.time.end + finalAdd);\n      if (finalAdd && !collision) {\n        state.update(`config.chart.items.${data.item.id}.time`, time => {\n          time.start = snapStart(time.start, 0, item);\n          time.end = snapEnd(time.end, finalAdd, item) - 1;\n          return time;\n        });\n      }\n    }\n\n    function movementY(ev, row, item, zoom, timePerPixel) {\n      moveGhost(ev);\n      const movement = getMovement();\n      const top = ev.y - movement.ganttTop;\n      const visibleRows = state.get('_internal.list.visibleRows');\n      let index = 0;\n      for (const currentRow of visibleRows) {\n        if (currentRow.top > top) {\n          if (index > 0) {\n            return index - 1;\n          }\n          return 0;\n        }\n        index++;\n      }\n      return index;\n    }\n\n    function documentMouseMove(ev) {\n      const movement = getMovement();\n      let item, rowId, row, zoom, timePerPixel;\n      if (movement.moving || movement.resizing) {\n        item = state.get(`config.chart.items.${data.item.id}`);\n        rowId = state.get(`config.chart.items.${data.item.id}.rowId`);\n        row = state.get(`config.list.rows.${rowId}`);\n        zoom = state.get('config.chart.time.zoom');\n        timePerPixel = state.get('_internal.chart.time.timePerPixel');\n      }\n      if (movement.moving) {\n        if (moveable === true || moveable === 'x' || (Array.isArray(moveable) && moveable.includes(rowId))) {\n          movementX(ev, row, item, zoom, timePerPixel);\n        }\n        if (!moveable || moveable === 'x') {\n          return;\n        }\n        let visibleRowsIndex = movementY(ev, row, item, zoom, timePerPixel);\n        const visibleRows = state.get('_internal.list.visibleRows');\n        if (typeof visibleRows[visibleRowsIndex] === 'undefined') {\n          if (visibleRowsIndex > 0) {\n            visibleRowsIndex = visibleRows.length - 1;\n          } else if (visibleRowsIndex < 0) {\n            visibleRowsIndex = 0;\n          }\n        }\n        const newRow = visibleRows[visibleRowsIndex];\n        const newRowId = newRow.id;\n        const collision = isCollision(newRowId, item.id, item.time.start, item.time.end);\n        if (newRowId !== item.rowId && !collision) {\n          if (!Array.isArray(moveable) || moveable.includes(newRowId)) {\n            if (!newRow.hasOwnProperty('moveable') || newRow.moveable) {\n              state.update(`config.chart.items.${item.id}.rowId`, newRowId);\n            }\n          }\n        }\n      } else if (movement.resizing && (typeof item.resizeable === 'undefined' || item.resizeable === true)) {\n        resizeX(ev, row, item, zoom, timePerPixel);\n      }\n    }\n\n    function documentMouseUp(ev) {\n      const movement = getMovement();\n      movement.moving = false;\n      movement.resizing = false;\n      for (const itemId in movementState) {\n        movementState[itemId].moving = false;\n        movementState[itemId].resizing = false;\n        destroyGhost(itemId);\n      }\n    }\n    if (moveable) el.addEventListener('mousedown', labelMouseDown);\n    if (resizeable) resizerEl.addEventListener('mousedown', resizerMouseDown);\n    document.addEventListener('mousemove', documentMouseMove);\n    document.addEventListener('mouseup', documentMouseUp);\n\n    return {\n      update(node, changedData) {\n        data = changedData;\n      },\n      destroy(node, data) {\n        if (moveable) el.removeEventListener('mousedown', labelMouseDown);\n        if (resizeable) resizerEl.removeEventListener('mousedown', resizerMouseDown);\n        document.removeEventListener('mousemove', documentMouseMove);\n        document.removeEventListener('mouseup', documentMouseUp);\n        if (resizeable) element.removeChild(resizerEl);\n      }\n    };\n  }\n\n  return function initializePlugin(state, api) {\n    state.update('config.actions.chart-timeline-items-row-item', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n","/**\n * SaveAsImage plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0\n */\n\n// @ts-nocheck\nexport default function SaveAsImage(options = {}) {\n  const defaultOptions = {\n    style: 'font-family: sans-serif;',\n    filename: 'gantt-schedule-timeline-calendar.jpeg'\n  };\n  options = { ...defaultOptions, options };\n  function downloadImage(data, filename) {\n    const a = document.createElement('a');\n    a.href = data;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n  }\n\n  function saveAsImage(ev) {\n    const element = ev.target;\n    const width = element.clientWidth;\n    const height = element.clientHeight;\n    const html = unescape(encodeURIComponent(element.outerHTML));\n    let style = '';\n    for (const styleSheet of document.styleSheets) {\n      if (styleSheet.title === 'gstc') {\n        for (const rule of styleSheet.rules) {\n          style += rule.cssText;\n        }\n      }\n    }\n    style = `<style>* {${options.style}} ${style}</style>`;\n    const svg = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\" viewBox=\"0 0 ${width} ${height}\">\n      <foreignObject x=\"0\" y=\"0\" width=\"${width}\" height=\"${height}\">\n        <div xmlns=\"http://www.w3.org/1999/xhtml\">\n          ${style}\n          ${html}\n        </div>\n      </foreignObject>\n    </svg>`;\n    const canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    const ctx = canvas.getContext('2d');\n    ctx.fillStyle = 'white';\n    ctx.fillRect(0, 0, width, height);\n    const svg64 = 'data:image/svg+xml;base64,' + btoa(svg);\n    const img = new Image();\n    img.onload = function onLoad() {\n      ctx.drawImage(img, 0, 0);\n      const jpeg = canvas.toDataURL('image/jpeg', 1.0);\n      downloadImage(jpeg, options.filename);\n    };\n    img.src = svg64;\n  }\n\n  return function initializePlugin(state, api) {\n    state.subscribe('_internal.elements.main', main => {\n      if (main) {\n        main.addEventListener('save-as-image', saveAsImage);\n      }\n    });\n  };\n}\n"],"names":[],"mappings":"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"}