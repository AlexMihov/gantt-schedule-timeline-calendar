const t="config.plugin.ItemMovement";class e{constructor(e){this.onDestroy=[],this.lastPointerState="up",this.vido=e,this.api=e.api,this.state=e.state,this.onDestroy.push(this.state.subscribe(t,t=>this.data=t)),this.data.className||(this.data.className=this.api.getClass("chart-timeline-items-row-item--moving")),this.onSelectionChange=this.onSelectionChange.bind(this),this.onDestroy.push(this.state.subscribe("config.plugin.Selection",this.onSelectionChange))}destroy(){this.onDestroy.forEach(t=>t())}updateData(){this.state.update(t,this.data)}getItemTime(t){return t}moveItems(){for(const t of this.data.lastMoved){this.getItemTime(t.$data.time.startDate)}}updatePointerState(){"up"===this.lastPointerState&&"down"===this.selection.pointerState?this.data.onStart(this.data.moving):"down"!==this.lastPointerState&&"move"!==this.lastPointerState||"up"!==this.selection.pointerState?"move"===this.selection.pointerState&&this.data.onMove(this.data.moving):(this.data.moving=[],this.data.onEnd(this.data.lastMoved)),this.lastPointerState=this.selection.pointerState}onSelectionChange(t){this.data.enabled&&(this.selection=t,this.selection.events.move&&(this.selection.events.move.preventDefault(),this.selection.events.move.stopPropagation()),this.selection.events.down&&(this.selection.events.down.preventDefault(),this.selection.events.down.stopPropagation()),this.data.moving=[...this.selection.selected["chart-timeline-items-row-item"]],this.data.moving.length&&(this.data.lastMoved=[...this.data.moving]),this.updatePointerState(),this.data.movement.px.horizontal=this.selection.currentPosition.x-this.selection.initialPosition.x,this.data.movement.px.vertical=this.selection.currentPosition.y-this.selection.initialPosition.y,this.moveItems(),this.updateData())}}function i(i={}){return function(s){s.state.update(t,function(t){return Object.assign({moving:[],lastMoved:[],movement:{px:{horizontal:0,vertical:0},time:0},onStart(t){console.log("start moving",t)},onMove(t){console.log("move",t)},onEnd(t){console.log("end move",t)},snapStart:({startTime:t,time:e})=>t.startOf(e.period),snapEnd:({endTime:t,time:e})=>t.endOf(e.period)},t)}(function(t){return Object.assign({enabled:!0,className:""},t)}(i))),new e(s)}}export{i as Plugin};
