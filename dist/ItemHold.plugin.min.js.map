{"version":3,"file":"ItemHold.plugin.min.js","sources":["../src/plugins/ItemHold.plugin.ts"],"sourcesContent":["/**\n * ItemHold plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nexport default function ItemHold(options = {}) {\n  const defaultOptions = {\n    time: 1000,\n    movementThreshold: 2,\n    action(element, data) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  const holding = {};\n  const mouse = { x: 0, y: 0 };\n\n  function onMouseDown(item, element, event) {\n    if (typeof holding[item.id] === 'undefined') {\n      holding[item.id] = { x: event.x, y: event.y };\n      setTimeout(() => {\n        if (typeof holding[item.id] !== 'undefined') {\n          let exec = true;\n          let xMovement = holding[item.id].x - mouse.x;\n          if (Math.sign(xMovement) === -1) {\n            xMovement = -xMovement;\n          }\n          let yMovement = holding[item.id].y - mouse.y;\n          if (Math.sign(yMovement) === -1) {\n            yMovement = -yMovement;\n          }\n          if (xMovement > options.movementThreshold) {\n            exec = false;\n          }\n          if (yMovement > options.movementThreshold) {\n            exec = false;\n          }\n          delete holding[item.id];\n          if (exec) {\n            options.action(element, item);\n          }\n        }\n      }, options.time);\n    }\n  }\n\n  function onMouseUp(itemId) {\n    if (typeof holding[itemId] !== 'undefined') {\n      delete holding[itemId];\n    }\n  }\n\n  function action(element, data) {\n    function elementMouseDown(event) {\n      onMouseDown(data.item, element, event);\n    }\n    element.addEventListener('mousedown', elementMouseDown);\n    function mouseUp() {\n      onMouseUp(data.item.id);\n    }\n\n    document.addEventListener('mouseup', mouseUp);\n    function onMouseMove(event) {\n      mouse.x = event.x;\n      mouse.y = event.y;\n    }\n\n    document.addEventListener('mousemove', onMouseMove);\n    return {\n      update(element, changedData) {\n        data = changedData;\n      },\n      destroy(element, data) {\n        document.removeEventListener('mouseup', onMouseUp);\n        document.removeEventListener('mousemove', onMouseMove);\n        element.removeEventListener('mousedown', elementMouseDown);\n      }\n    };\n  }\n\n  return function initialize(vido) {\n    vido.state.update('config.actions.chart-timeline-items-row-item', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n"],"names":["ItemHold","options","defaultOptions","time","movementThreshold","[object Object]","element","data","holding","mouse","x","y","onMouseUp","itemId","action","elementMouseDown","event","onMouseDown","item","id","setTimeout","exec","xMovement","Math","sign","yMovement","onMouseMove","addEventListener","document","mouseUp","changedData","removeEventListener","initialize","vido","state","update","actions","push"],"mappings":";;;;;;;;;qBAUwBA,SAASC,EAAU,IACzC,MAAMC,EAAiB,CACrBC,KAAM,IACNC,kBAAmB,EACnBC,OAAOC,EAASC,MAElBN,iCAAeC,GAAmBD,GAElC,MAAMO,EAAU,GACVC,EAAQ,CAAEC,EAAG,EAAGC,EAAG,GA+BzB,SAASC,UAAUC,QACc,IAApBL,EAAQK,WACVL,EAAQK,GAInB,SAASC,OAAOR,EAASC,GACvB,SAASQ,iBAAiBC,IApC5B,SAASC,YAAYC,EAAMZ,EAASU,QACF,IAArBR,EAAQU,EAAKC,MACtBX,EAAQU,EAAKC,IAAM,CAAET,EAAGM,EAAMN,EAAGC,EAAGK,EAAML,GAC1CS,WAAW,KACT,QAAgC,IAArBZ,EAAQU,EAAKC,IAAqB,CAC3C,IAAIE,GAAO,EACPC,EAAYd,EAAQU,EAAKC,IAAIT,EAAID,EAAMC,GACb,IAA1Ba,KAAKC,KAAKF,KACZA,GAAaA,GAEf,IAAIG,EAAYjB,EAAQU,EAAKC,IAAIR,EAAIF,EAAME,GACb,IAA1BY,KAAKC,KAAKC,KACZA,GAAaA,GAEXH,EAAYrB,EAAQG,oBACtBiB,GAAO,GAELI,EAAYxB,EAAQG,oBACtBiB,GAAO,UAEFb,EAAQU,EAAKC,IAChBE,GACFpB,EAAQa,OAAOR,EAASY,KAG3BjB,EAAQE,OAYXc,CAAYV,EAAKW,KAAMZ,EAASU,GAQlC,SAASU,YAAYV,GACnBP,EAAMC,EAAIM,EAAMN,EAChBD,EAAME,EAAIK,EAAML,EAIlB,OAZAL,EAAQqB,iBAAiB,YAAaZ,kBAKtCa,SAASD,iBAAiB,WAJ1B,SAASE,UACPjB,UAAUL,EAAKW,KAAKC,OAStBS,SAASD,iBAAiB,YAAaD,aAChC,CACLrB,OAAOC,EAASwB,GACdvB,EAAOuB,GAETzB,QAAQC,EAASC,GACfqB,SAASG,oBAAoB,UAAWnB,WACxCgB,SAASG,oBAAoB,YAAaL,aAC1CpB,EAAQyB,oBAAoB,YAAahB,oBAK/C,OAAO,SAASiB,WAAWC,GACzBA,EAAKC,MAAMC,OAAO,+CAAgDC,IAChEA,EAAQC,KAAKvB,QACNsB"}