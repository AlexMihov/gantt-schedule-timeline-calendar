{"version":3,"file":"GridSelection.plugin.js","sources":["../src/plugins/GridSelection.plugin.js"],"sourcesContent":["/**\n * GridSelection plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nexport default function GridSelection() {\n  let state, api;\n  let selecting = { x: -1, y: -1, data: [], elements: [] };\n\n  function action(element, data) {\n    function mouseDown(ev) {\n      selecting.x = ev.x;\n      selecting.y = ev.y;\n    }\n\n    function mouseMove(ev) {\n      if (selecting.x === -1 && selecting.y === -1) {\n        return;\n      }\n      if (ev.x === selecting.x || ev.y === selecting.y) {\n        return;\n      }\n      if (!selecting.data.find(selectedData => selectedData.id === data.id)) {\n        selecting.data.push(data);\n      }\n      const target = ev.target.closest('.gantt-schedule-timeline-calendar__chart-timeline-grid-row-block');\n      if (!selecting.elements.includes(target)) {\n        selecting.elements.push(target);\n      }\n      console.log(selecting.elements, selecting.data);\n      state.update('config.plugins.gridSelection.selecting', true);\n    }\n\n    function mouseUp(ev) {\n      selecting.x = -1;\n      selecting.y = -1;\n      selecting.data = [];\n      selecting.elements = [];\n      state.update('config.plugins.gridSelection.selecting', false);\n    }\n\n    element.addEventListener('mousedown', mouseDown);\n    element.addEventListener('mousemove', mouseMove);\n    document.addEventListener('mouseup', mouseUp);\n    return {\n      update(element, changedData) {\n        data = changedData;\n      },\n      destroy() {\n        document.removeEventListener('mouseup', mouseUp);\n        element.removeEventListener('mousemove', mouseMove);\n        element.removeEventListener('mousedown', mouseDown);\n      }\n    };\n  }\n\n  return function initialize(State, Api) {\n    state = State;\n    api = Api;\n    if (typeof state.get('config.plugins.gridSelection') === 'undefined') {\n      state.update('config.plugins.gridSelection', { selecting: false, selected: [] });\n    }\n    state.update('config.actions.chart-timeline-grid-row-block', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n"],"names":[],"mappings":"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"}