{"version":3,"file":"CalendarScroll.plugin.js","sources":["../src/plugins/CalendarScroll.plugin.ts"],"sourcesContent":["/**\n * CalendarScroll plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nexport default function CalendarScroll(options = {}) {\n  let state, api;\n  const defaultOptions = {\n    speed: 1,\n    hideScroll: false,\n    onChange(time) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  class CalendarScrollAction {\n    isMoving: boolean = false;\n    lastX: number = 0;\n    mc: any;\n\n    constructor(element: HTMLElement, data: any) {\n      this.onPanStart = this.onPanStart.bind(this);\n      this.onPanMove = this.onPanMove.bind(this);\n      this.onPanEnd = this.onPanEnd.bind(this);\n      this.mc = new api.Hammer(element);\n      this.mc.on('panstart', this.onPanStart);\n      this.mc.on('panmove', this.onPanMove);\n      this.mc.on('panend', this.onPanEnd);\n      element.style.cursor = 'move';\n      // @ts-ignore\n      if (options.hideScroll) {\n        state.get('_internal.elements.horizontal-scroll').style.visibility = 'hidden';\n      }\n    }\n\n    onPanStart(ev) {\n      this.isMoving = true;\n      this.lastX = ev.deltaX;\n    }\n\n    onPanMove(ev) {\n      const movedX = ev.deltaX - this.lastX;\n      const time = state.get('_internal.chart.time');\n      // @ts-ignore\n      const movedTime = -Math.round(movedX * time.timePerPixel * options.speed);\n      state.update('config.chart.time', configTime => {\n        if (configTime.from === 0) configTime.from = time.from;\n        if (configTime.to === 0) configTime.to = time.to;\n        configTime.from += movedTime;\n        configTime.to += movedTime;\n        // @ts-ignore\n        options.onChange(configTime);\n        return configTime;\n      });\n      this.lastX = ev.deltaX;\n    }\n\n    onPanEnd(ev) {\n      this.isMoving = false;\n      this.lastX = 0;\n    }\n\n    destroy(element: HTMLElement, data: any) {\n      this.mc.off(element);\n    }\n  }\n\n  return function initialize(vido) {\n    api = vido.api;\n    state = vido.state;\n    state.update('config.actions.chart-calendar', actions => {\n      actions.push(CalendarScrollAction);\n      return actions;\n    });\n  };\n}\n"],"names":[],"mappings":"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"}