{"version":3,"file":"CalendarScroll.plugin.js","sources":["../src/plugins/CalendarScroll.plugin.ts"],"sourcesContent":["/**\n * CalendarScroll plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nexport default function CalendarScroll(options = {}) {\n  let state, api;\n  const defaultOptions = {\n    speed: 1,\n    hideScroll: false,\n    onChange(time) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  class CalendarScrollAction {\n    isMoving: boolean = false;\n    lastX: number = 0;\n\n    constructor(element: HTMLElement, data: any) {\n      this.onMouseUp = this.onMouseUp.bind(this);\n      this.onMouseMove = this.onMouseMove.bind(this);\n      this.onMouseDown = this.onMouseDown.bind(this);\n      element.addEventListener('mousedown', this.onMouseDown);\n      document.addEventListener('mousemove', this.onMouseMove);\n      document.addEventListener('mouseup', this.onMouseUp);\n      element.style.cursor = 'move';\n      // @ts-ignore\n      if (options.hideScroll) {\n        state.get('_internal.elements.horizontal-scroll').style.visibility = 'hidden';\n      }\n    }\n\n    onMouseDown(ev: MouseEvent) {\n      this.isMoving = true;\n      this.lastX = ev.x;\n    }\n\n    onMouseUp(ev: MouseEvent) {\n      this.isMoving = false;\n    }\n\n    onMouseMove(ev: MouseEvent) {\n      if (!this.isMoving) return;\n      const movedX = ev.x - this.lastX;\n      const time = state.get('_internal.chart.time');\n      // @ts-ignore\n      const movedTime = -Math.round(movedX * time.timePerPixel * options.speed);\n      state.update('config.chart.time', configTime => {\n        if (configTime.from === 0) configTime.from = time.from;\n        if (configTime.to === 0) configTime.to = time.to;\n        configTime.from += movedTime;\n        configTime.to += movedTime;\n        // @ts-ignore\n        options.onChange(configTime);\n        return configTime;\n      });\n      this.lastX = ev.x;\n    }\n\n    update(element: HTMLElement, data: any) {}\n\n    destroy(element: HTMLElement, data: any) {\n      element.removeEventListener('mousedown', this.onMouseDown);\n      document.removeEventListener('mousemove', this.onMouseMove);\n      document.removeEventListener('mouseup', this.onMouseUp);\n    }\n  }\n\n  return function initialize(vido) {\n    api = vido.api;\n    state = vido.state;\n    state.update('config.actions.chart-calendar', actions => {\n      actions.push(CalendarScrollAction);\n      return actions;\n    });\n  };\n}\n"],"names":[],"mappings":"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"}