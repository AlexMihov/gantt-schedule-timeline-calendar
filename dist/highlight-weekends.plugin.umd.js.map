{"version":3,"file":"highlight-weekends.plugin.umd.js","sources":["../node_modules/@neuronet.io/vido/Action.ts","../node_modules/@neuronet.io/vido/helpers.ts","../src/plugins/highlight-weekends.plugin.ts"],"sourcesContent":["class Action {\n  public isAction: boolean = true;\n}\nAction.prototype.isAction = true;\nexport default Action;\n","/**\n * Schedule - a throttle function that uses requestAnimationFrame to limit the rate at which a function is called.\n *\n * @param {function} fn\n * @returns {function}\n */\nexport function schedule(fn: (argument) => void | any) {\n  let frameId = 0;\n  function wrapperFn(argument) {\n    if (frameId) {\n      return;\n    }\n    function executeFrame() {\n      frameId = 0;\n      fn.apply(undefined, [argument]);\n    }\n    frameId = requestAnimationFrame(executeFrame);\n  }\n  return wrapperFn;\n}\n\n/**\n * Is object - helper function to determine if specified variable is an object\n *\n * @param {any} item\n * @returns {boolean}\n */\nfunction isObject(item) {\n  return item && typeof item === 'object' && !Array.isArray(item);\n}\n\n/**\n * Merge deep - helper function which will merge objects recursively - creating brand new one - like clone\n *\n * @param {object} target\n * @params {[object]} sources\n * @returns {object}\n */\nexport function mergeDeep(target, ...sources) {\n  const source = sources.shift();\n  if (isObject(target) && isObject(source)) {\n    for (const key in source) {\n      if (isObject(source[key])) {\n        if (typeof source[key].clone === 'function') {\n          target[key] = source[key].clone();\n        } else {\n          if (typeof target[key] === 'undefined') {\n            target[key] = {};\n          }\n          target[key] = mergeDeep(target[key], source[key]);\n        }\n      } else if (Array.isArray(source[key])) {\n        target[key] = new Array(source[key].length);\n        let index = 0;\n        for (let item of source[key]) {\n          if (isObject(item)) {\n            if (typeof item.clone === 'function') {\n              target[key][index] = item.clone();\n            } else {\n              target[key][index] = mergeDeep({}, item);\n            }\n          } else {\n            target[key][index] = item;\n          }\n          index++;\n        }\n      } else {\n        target[key] = source[key];\n      }\n    }\n  }\n  if (!sources.length) {\n    return target;\n  }\n  return mergeDeep(target, ...sources);\n}\n\n/**\n * Clone helper function\n *\n * @param source\n * @returns {object} cloned source\n */\nexport function clone(source) {\n  if (typeof source.actions !== 'undefined') {\n    const actns = source.actions.map((action) => {\n      const result = { ...action };\n      const props = { ...result.props };\n      delete props.state;\n      delete props.api;\n      delete result.element;\n      result.props = props;\n      return result;\n    });\n    source.actions = actns;\n  }\n  return mergeDeep({}, source);\n}\n\nexport default {\n  mergeDeep,\n  clone,\n  schedule,\n};\n","/**\n * Weekend highlight plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   AGPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nimport Action from '@neuronet.io/vido/Action';\nimport { Api } from '../api/api';\nimport { Vido } from '../gstc';\nimport { mergeDeep } from '@neuronet.io/vido/helpers';\n\nexport interface Options {\n  weekdays?: number[];\n  className?: string;\n}\n\nexport function Plugin(options: Options = {}) {\n  const weekdays = options.weekdays || [6, 0];\n  let className;\n  let api: Api;\n  let enabled = true;\n\n  class WeekendHighlightAction extends Action {\n    constructor(element, data) {\n      super();\n      this.highlight(element, data.time.leftGlobal);\n    }\n\n    update(element, data) {\n      this.highlight(element, data.time.leftGlobal);\n    }\n\n    highlight(element, time) {\n      const hasClass = element.classList.contains(className);\n      if (!enabled) {\n        if (hasClass) {\n          element.classList.remove(className);\n        }\n        return;\n      }\n      const isWeekend = weekdays.includes(api.time.date(time).day());\n      if (!hasClass && isWeekend) {\n        element.classList.add(className);\n      } else if (hasClass && !isWeekend) {\n        element.classList.remove(className);\n      }\n    }\n  }\n\n  return function initialize(vidoInstance: Vido) {\n    const subs = [];\n    const pluginPath = 'config.plugin.HighlightWeekends';\n    api = vidoInstance.api;\n    className = options.className || api.getClass('chart-timeline-grid-row-cell') + '--weekend';\n    const currentOptions = vidoInstance.state.get(pluginPath);\n    if (currentOptions) {\n      options = mergeDeep({}, options, currentOptions);\n    }\n    subs.push(vidoInstance.state.subscribe('$data.chart.time.format.period', (period) => (enabled = period === 'day')));\n    vidoInstance.state.update('config.actions.chart-timeline-grid-row-cell', (actions) => {\n      actions.push(WeekendHighlightAction);\n      return actions;\n    });\n    return function onDestroy() {\n      subs.forEach((unsub) => unsub());\n      vidoInstance.state.update('config.actions.chart-timeline-grid-row-cell', (actions) => {\n        return actions.filter((action) => action !== WeekendHighlightAction);\n      });\n    };\n  };\n}\n"],"names":[],"mappings":"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"}