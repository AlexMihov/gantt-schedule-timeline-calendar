{"version":3,"file":"ItemHold.plugin.js","sources":["../src/plugins/ItemHold.plugin.js"],"sourcesContent":["export default function ItemHoldPlugin(options = {}) {\n  const defaultOptions = {\n    time: 1000,\n    movementThreshold: 2,\n    action(element, data) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  const holding = {};\n  const mouse = { x: 0, y: 0 };\n\n  function onMouseDown(item, element, event) {\n    if (typeof holding[item.id] === 'undefined') {\n      holding[item.id] = { x: event.x, y: event.y };\n      setTimeout(() => {\n        if (typeof holding[item.id] !== 'undefined') {\n          let exec = true;\n          let xMovement = holding[item.id].x - mouse.x;\n          if (Math.sign(xMovement) === -1) {\n            xMovement = -xMovement;\n          }\n          let yMovement = holding[item.id].y - mouse.y;\n          if (Math.sign(yMovement) === -1) {\n            yMovement = -yMovement;\n          }\n          if (xMovement > options.movementThreshold) {\n            exec = false;\n          }\n          if (yMovement > options.movementThreshold) {\n            exec = false;\n          }\n          delete holding[item.id];\n          if (exec) {\n            options.action(element, item);\n          }\n        }\n      }, options.time);\n    }\n  }\n\n  function onMouseUp(itemId) {\n    if (typeof holding[itemId] !== 'undefined') {\n      delete holding[itemId];\n    }\n  }\n\n  const mouseUps = [];\n  const mouseMoves = [];\n\n  function action(element, data) {\n    console.log('hold created for', data);\n    element.addEventListener('mousedown', event => {\n      onMouseDown(data.item, element, event);\n    });\n    function mouseUp() {\n      onMouseUp(data.item.id);\n    }\n    mouseUps.push(mouseUp);\n    document.addEventListener('mouseup', mouseUp);\n    function mouseMove(event) {\n      mouse.x = event.x;\n      mouse.y = event.y;\n    }\n    mouseMoves.push(mouseMove);\n    document.addEventListener('mousemove', mouseMove);\n    return {\n      destroy(element, data) {\n        mouseUps.forEach(mouseUp => document.removeEventListener('mouseup', mouseUp));\n        mouseMoves.forEach(mouseMove => document.removeEventListener('mousemove', mouseMove));\n      }\n    };\n  }\n\n  return function initializePlugin(state, api) {\n    console.log('initializing hold');\n    state.update('config.actions.chart-gantt-items-row-item', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n"],"names":[],"mappings":"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"}