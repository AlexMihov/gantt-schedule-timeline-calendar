{"version":3,"file":"ItemHold.plugin.js","sources":["../src/plugins/ItemHold.plugin.js"],"sourcesContent":["export default function ItemHoldPlugin(options = {}) {\n  const defaultOptions = {\n    time: 1000,\n    movementThreshold: 2,\n    action(element, data) {}\n  };\n  options = { ...defaultOptions, ...options };\n\n  const holding = {};\n  const mouse = { x: 0, y: 0 };\n\n  function onMouseDown(item, element, event) {\n    if (typeof holding[item.id] === 'undefined') {\n      holding[item.id] = { x: event.x, y: event.y };\n      setTimeout(() => {\n        if (typeof holding[item.id] !== 'undefined') {\n          let exec = true;\n          let xMovement = holding[item.id].x - mouse.x;\n          if (Math.sign(xMovement) === -1) {\n            xMovement = -xMovement;\n          }\n          let yMovement = holding[item.id].y - mouse.y;\n          if (Math.sign(yMovement) === -1) {\n            yMovement = -yMovement;\n          }\n          if (xMovement > options.movementThreshold) {\n            exec = false;\n          }\n          if (yMovement > options.movementThreshold) {\n            exec = false;\n          }\n          delete holding[item.id];\n          if (exec) {\n            options.action(element, item);\n          }\n        }\n      }, options.time);\n    }\n  }\n\n  function onMouseUp(itemId) {\n    if (typeof holding[itemId] !== 'undefined') {\n      delete holding[itemId];\n    }\n  }\n\n  const mouseUps = [];\n  const mouseMoves = [];\n\n  const action = {\n    create(element, data) {\n      element.addEventListener('mousedown', event => {\n        onMouseDown(data.item, element, event);\n      });\n      function mouseUp() {\n        onMouseUp(data.item.id);\n      }\n      mouseUps.push(mouseUp);\n      document.addEventListener('mouseup', mouseUp);\n      function mouseMove(event) {\n        mouse.x = event.x;\n        mouse.y = event.y;\n      }\n      mouseMoves.push(mouseMove);\n      document.addEventListener('mousemove', mouseMove);\n    },\n    destroy() {\n      mouseUps.forEach(mouseUp => document.removeEventListener('mouseup', mouseUp));\n      mouseMoves.forEach(mouseMove => document.removeEventListener('mousemove', mouseMove));\n    }\n  };\n\n  return function initializePlugin(state, api) {\n    state.update('config.actions.chart-gantt-items-row-item', actions => {\n      actions.push(action);\n      return actions;\n    });\n  };\n}\n"],"names":["options","time","movementThreshold","[object Object]","element","data","holding","mouse","x","y","mouseUps","mouseMoves","action","mouseUp","itemId","item","id","mouseMove","event","addEventListener","setTimeout","exec","xMovement","Math","sign","yMovement","onMouseDown","push","document","forEach","removeEventListener","state","api","update","actions"],"mappings":"sMAAe,SAAwBA,EAAU,IAM/CA,EAAU,IALa,CACrBC,KAAM,IACNC,kBAAmB,EACnBC,OAAOC,EAASC,SAEgBL,GAElC,MAAMM,EAAU,GACVC,EAAQ,CAAEC,EAAG,EAAGC,EAAG,GAqCnBC,EAAW,GACXC,EAAa,GAEbC,EAAS,CACbT,OAAOC,EAASC,GAId,SAASQ,IAdb,IAAmBC,EAAAA,EAeHT,EAAKU,KAAKC,QAdO,IAApBV,EAAQQ,WACVR,EAAQQ,GAiBf,SAASG,EAAUC,GACjBX,EAAMC,EAAIU,EAAMV,EAChBD,EAAME,EAAIS,EAAMT,EAVlBL,EAAQe,iBAAiB,YAAaD,KAxC1C,SAAqBH,EAAMX,EAASc,QACF,IAArBZ,EAAQS,EAAKC,MACtBV,EAAQS,EAAKC,IAAM,CAAER,EAAGU,EAAMV,EAAGC,EAAGS,EAAMT,GAC1CW,WAAW,KACT,QAAgC,IAArBd,EAAQS,EAAKC,IAAqB,CAC3C,IAAIK,GAAO,EACPC,EAAYhB,EAAQS,EAAKC,IAAIR,EAAID,EAAMC,GACb,IAA1Be,KAAKC,KAAKF,KACZA,GAAaA,GAEf,IAAIG,EAAYnB,EAAQS,EAAKC,IAAIP,EAAIF,EAAME,GACb,IAA1Bc,KAAKC,KAAKC,KACZA,GAAaA,GAEXH,EAAYtB,EAAQE,oBACtBmB,GAAO,GAELI,EAAYzB,EAAQE,oBACtBmB,GAAO,UAEFf,EAAQS,EAAKC,IAChBK,GACFrB,EAAQY,OAAOR,EAASW,KAG3Bf,EAAQC,OAgBTyB,CAAYrB,EAAKU,KAAMX,EAASc,KAKlCR,EAASiB,KAAKd,GACde,SAAST,iBAAiB,UAAWN,GAKrCF,EAAWgB,KAAKV,GAChBW,SAAST,iBAAiB,YAAaF,IAEzCd,UACEO,EAASmB,QAAQhB,GAAWe,SAASE,oBAAoB,UAAWjB,IACpEF,EAAWkB,QAAQZ,GAAaW,SAASE,oBAAoB,YAAab,MAI9E,OAAO,SAA0Bc,EAAOC,GACtCD,EAAME,OAAO,4CAA6CC,IACxDA,EAAQP,KAAKf,GACNsB"}