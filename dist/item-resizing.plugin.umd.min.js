!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).ItemResizing={})}(this,(function(t){"use strict";function e(t){return t&&"object"==typeof t&&t.constructor&&"Object"===t.constructor.name}var i=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var s=n[i];t.call(e,s[1],s[0])}},e}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,s="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),a="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(s):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var r=["top","right","bottom","left","width","height","size","weight"],o="undefined"!=typeof MutationObserver,h=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,s=0;function r(){i&&(i=!1,t()),n&&h()}function o(){a(r)}function h(){var t=Date.now();if(i){if(t-s<2)return;n=!0}else i=!0,n=!1,setTimeout(o,e);s=t}return h}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),o?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;r.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),d=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var s=n[i];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},c=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||s},u=v(0,0,0,0);function f(t){return parseFloat(t)||0}function l(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+f(t["border-"+i+"-width"])}),0)}function p(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return u;var n=c(t).getComputedStyle(t),s=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var s=n[i],a=t["padding-"+s];e[s]=f(a)}return e}(n),a=s.left+s.right,r=s.top+s.bottom,o=f(n.width),h=f(n.height);if("border-box"===n.boxSizing&&(Math.round(o+a)!==e&&(o-=l(n,"left","right")+a),Math.round(h+r)!==i&&(h-=l(n,"top","bottom")+r)),!function(t){return t===c(t).document.documentElement}(t)){var d=Math.round(o+a)-e,p=Math.round(h+r)-i;1!==Math.abs(d)&&(o-=d),1!==Math.abs(p)&&(h-=p)}return v(s.left,s.top,o,h)}var m="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof c(t).SVGGraphicsElement}:function(t){return t instanceof c(t).SVGElement&&"function"==typeof t.getBBox};function g(t){return n?m(t)?function(t){var e=t.getBBox();return v(0,0,e.width,e.height)}(t):p(t):u}function v(t,e,i,n){return{x:t,y:e,width:i,height:n}}var y=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=g(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),$=function(t,e){var i,n,s,a,r,o,h,c=(n=(i=e).x,s=i.y,a=i.width,r=i.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,h=Object.create(o.prototype),d(h,{x:n,y:s,width:a,height:r,top:s,right:n+a,bottom:r+s,left:n}),h);d(this,{target:t,contentRect:c})},b=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new i,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof c(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new y(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof c(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new $(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),w="undefined"!=typeof WeakMap?new WeakMap:new i,_=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=h.getInstance(),n=new b(e,i,this);w.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){_.prototype[t]=function(){var e;return(e=w.get(this))[t].apply(e,arguments)}}));void 0!==s.ResizeObserver&&s.ResizeObserver;(class{constructor(){this.isAction=!0}}).prototype.isAction=!0;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function M(t,e){return t(e={exports:{}},e.exports),e.exports}M((function(t,e){t.exports=function(){var t="millisecond",e="second",i="minute",n="hour",s="day",a="week",r="month",o="quarter",h="year",d=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,u=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},f={s:u,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),n=Math.floor(i/60),s=i%60;return(e<=0?"+":"-")+u(n,2,"0")+":"+u(s,2,"0")},m:function(t,e){var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,r),s=e-n<0,a=t.clone().add(i+(s?-1:1),r);return Number(-(i+(e-n)/(s?n-a:a-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(d){return{M:r,y:h,w:a,d:s,D:"date",h:n,m:i,s:e,ms:t,Q:o}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},l={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",m={};m[p]=l;var g=function(t){return t instanceof b},v=function(t,e,i){var n;if(!t)return p;if("string"==typeof t)m[t]&&(n=t),e&&(m[t]=e,n=t);else{var s=t.name;m[s]=t,n=s}return!i&&n&&(p=n),n||!i&&p},y=function(t,e,i){if(g(t))return t.clone();var n=e?"string"==typeof e?{format:e,pl:i}:e:{};return n.date=t,new b(n)},$=f;$.l=v,$.i=g,$.w=function(t,e){return y(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var b=function(){function u(t){this.$L=this.$L||v(t.locale,null,!0),this.parse(t)}var f=u.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if($.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n)return i?new Date(Date.UTC(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)):new Date(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)}return new Date(e)}(t),this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return $},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var i=y(t);return this.startOf(e)<=i&&i<=this.endOf(e)},f.isAfter=function(t,e){return y(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<y(t)},f.$g=function(t,e,i){return $.u(t)?this[e]:this.set(i,t)},f.year=function(t){return this.$g(t,"$y",h)},f.month=function(t){return this.$g(t,"$M",r)},f.day=function(t){return this.$g(t,"$W",s)},f.date=function(t){return this.$g(t,"$D","date")},f.hour=function(t){return this.$g(t,"$H",n)},f.minute=function(t){return this.$g(t,"$m",i)},f.second=function(t){return this.$g(t,"$s",e)},f.millisecond=function(e){return this.$g(e,"$ms",t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,o){var d=this,c=!!$.u(o)||o,u=$.p(t),f=function(t,e){var i=$.w(d.$u?Date.UTC(d.$y,e,t):new Date(d.$y,e,t),d);return c?i:i.endOf(s)},l=function(t,e){return $.w(d.toDate()[t].apply(d.toDate(),(c?[0,0,0,0]:[23,59,59,999]).slice(e)),d)},p=this.$W,m=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case h:return c?f(1,0):f(31,11);case r:return c?f(1,m):f(0,m+1);case a:var y=this.$locale().weekStart||0,b=(p<y?p+7:p)-y;return f(c?g-b:g+(6-b),m);case s:case"date":return l(v+"Hours",0);case n:return l(v+"Minutes",1);case i:return l(v+"Seconds",2);case e:return l(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(a,o){var d,c=$.p(a),u="set"+(this.$u?"UTC":""),f=(d={},d.day=u+"Date",d.date=u+"Date",d[r]=u+"Month",d[h]=u+"FullYear",d[n]=u+"Hours",d[i]=u+"Minutes",d[e]=u+"Seconds",d[t]=u+"Milliseconds",d)[c],l=c===s?this.$D+(o-this.$W):o;if(c===r||c===h){var p=this.clone().set("date",1);p.$d[f](l),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).toDate()}else f&&this.$d[f](l);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[$.p(t)]()},f.add=function(t,o){var d,c=this;t=Number(t);var u=$.p(o),f=function(e){var i=y(c);return $.w(i.date(i.date()+Math.round(e*t)),c)};if(u===r)return this.set(r,this.$M+t);if(u===h)return this.set(h,this.$y+t);if(u===s)return f(1);if(u===a)return f(7);var l=(d={},d[i]=6e4,d[n]=36e5,d[e]=1e3,d)[u]||1,p=this.$d.getTime()+t*l;return $.w(p,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var i=t||"YYYY-MM-DDTHH:mm:ssZ",n=$.z(this),s=this.$locale(),a=this.$H,r=this.$m,o=this.$M,h=s.weekdays,d=s.months,u=function(t,n,s,a){return t&&(t[n]||t(e,i))||s[n].substr(0,a)},f=function(t){return $.s(a%12||12,t,"0")},l=s.meridiem||function(t,e,i){var n=t<12?"AM":"PM";return i?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:$.s(o+1,2,"0"),MMM:u(s.monthsShort,o,d,3),MMMM:d[o]||d(this,i),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:u(s.weekdaysMin,this.$W,h,2),ddd:u(s.weekdaysShort,this.$W,h,3),dddd:h[this.$W],H:String(a),HH:$.s(a,2,"0"),h:f(1),hh:f(2),a:l(a,r,!0),A:l(a,r,!1),m:String(r),mm:$.s(r,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:n};return i.replace(c,(function(t,e){return e||p[t]||n.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,s,d){var c,u=$.p(s),f=y(t),l=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,m=$.m(this,f);return m=(c={},c[h]=m/12,c[r]=m,c[o]=m/3,c[a]=(p-l)/6048e5,c.day=(p-l)/864e5,c[n]=p/36e5,c[i]=p/6e4,c[e]=p/1e3,c)[u]||p,d?m:$.a(m)},f.daysInMonth=function(){return this.endOf(r).$D},f.$locale=function(){return m[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=v(t,e,!0);return n&&(i.$L=n),i},f.clone=function(){return $.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},u}();return y.prototype=b.prototype,y.extend=function(t,e){return t(e,b,y),y},y.locale=v,y.isDayjs=g,y.unix=function(t){return y(1e3*t)},y.en=m[p],y.Ls=m,y}()})),M((function(t,e){t.exports=function(t,e,i){var n=(new Date).getTimezoneOffset(),s=e.prototype;i.utc=function(t,i){return new e({date:t,utc:!0,format:i})},s.utc=function(){return i(this.toDate(),{locale:this.$L,utc:!0})},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),a.call(this,t)};var r=s.init;s.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else r.call(this)};var o=s.utcOffset;s.utcOffset=function(t){var e=this.$utils().u;if(e(t))return this.$u?0:e(this.$offset)?o.call(this):this.$offset;var i,s=Math.abs(t)<=16?60*t:t;return 0!==t?(i=this.local().add(s+n,"minute")).$offset=s:i=this.utc(),i};var h=s.format;s.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,e)},s.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+n;return this.$d.valueOf()-6e4*t},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()}}}));new TextEncoder("utf-8");String(Math.random()).slice(2),document.createComment(""),document.createElement("template"),document.createTextNode("");let D=!1;(()=>{try{const t={get capture(){return D=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})(),"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.7");document.createElement("template"),document.createTextNode("");const O=function(t,e=""){let i=`gstc__${t}`;return"gstc"===t&&(i="gstc"),e?`${i} ${i}--${e.replace(/[^\w]+/gi,"-")}`:i}("chart-timeline-items-row-item-resizing-handle-content-line");class E{constructor(t,e){this.spacing=1,this.unsubs=[],this.vido=t,this.state=t.state,this.api=t.api,this.data=function(t={}){const e={onStart:({items:t})=>t.after,onResize:({items:t})=>t.after,onEnd:({items:t})=>t.after},i={start:({startTime:t,time:e})=>t.startOf(e.period),end:({endTime:t,time:e})=>t.endOf(e.period)},n={width:18,horizontalMargin:0,verticalMargin:0,outside:!1,onlyWhenSelected:!0},s=Object.assign({enabled:!0,debug:!1,state:"",content:null,bodyClass:"gstc-item-resizing",bodyClassLeft:"gstc-items-resizing-left",bodyClassRight:"gstc-items-resizing-right",initialPosition:{x:0,y:0},currentPosition:{x:0,y:0},movement:{px:0,time:0},initialItems:[],targetData:null,leftIsMoving:!1,rightIsMoving:!1,handle:Object.assign({},n),events:Object.assign({},e),snapToTime:Object.assign({},i)},t);return t.snapToTime&&(s.snapToTime=Object.assign(Object.assign({},i),t.snapToTime)),t.events&&(s.events=Object.assign(Object.assign({},e),t.events)),t.handle&&(s.handle=Object.assign(Object.assign({},n),t.handle)),s}(e),this.merge=this.state.get("config.merge"),this.minWidth=2*this.data.handle.width,this.state.update("config.chart.item.minWidth",this.minWidth),this.state.update("config.chart.items.*.minWidth",this.minWidth),this.html=t.html,this.data.content||(this.data.content=this.html`<div class=${O}></div><div class=${O}></div>`),this.wrapper=this.wrapper.bind(this),this.onRightPointerDown=this.onRightPointerDown.bind(this),this.onRightPointerMove=this.onRightPointerMove.bind(this),this.onRightPointerUp=this.onRightPointerUp.bind(this),this.onLeftPointerDown=this.onLeftPointerDown.bind(this),this.onLeftPointerMove=this.onLeftPointerMove.bind(this),this.onLeftPointerUp=this.onLeftPointerUp.bind(this),this.destroy=this.destroy.bind(this),this.updateData(),document.body.classList.add(this.data.bodyClass),this.unsubs.push(this.state.subscribe("config.plugin.ItemResizing",t=>{t.enabled?t.enabled&&document.body.classList.add(this.data.bodyClass):document.body.classList.remove(this.data.bodyClass),this.data=t})),document.addEventListener("pointermove",this.onLeftPointerMove),document.addEventListener("pointerup",this.onLeftPointerUp),document.addEventListener("pointermove",this.onRightPointerMove),document.addEventListener("pointerup",this.onRightPointerUp),this.state.update("config.wrappers.ChartTimelineItemsRowItem",t=>(this.oldWrapper||(this.oldWrapper=t),this.initializeWrapper(),this.wrapper))}destroy(){this.unsubs.forEach(t=>t()),document.removeEventListener("pointermove",this.onLeftPointerMove),document.removeEventListener("pointerup",this.onLeftPointerUp),document.removeEventListener("pointermove",this.onRightPointerMove),document.removeEventListener("pointerup",this.onRightPointerUp),this.oldWrapper&&this.state.update("config.wrappers.ChartTimelineItemsRowItem",()=>this.oldWrapper)}updateData(){this.state.update("config.plugin.ItemResizing",this.data)}initializeWrapper(){this.leftClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.leftClassName+=" "+this.leftClassName+"--left",this.rightClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.rightClassName+=" "+this.rightClassName+"--right",this.spacing=this.state.get("config.chart.spacing")}getSelectedItems(){return this.state.get("config.plugin.Selection.selected.chart-timeline-items-row-item").map(t=>this.merge({},this.api.getItem(t)))}getRightStyleMap(t){const e=new this.vido.StyleMap({});return e.style.top=t.$data.position.actualTop+this.data.handle.verticalMargin+"px",this.data.handle.outside?e.style.left=t.$data.position.right+this.data.handle.horizontalMargin-this.spacing+"px":e.style.left=t.$data.position.right-this.data.handle.width-this.data.handle.horizontalMargin-this.spacing+"px",e.style.width=this.data.handle.width+"px",e.style.height=t.$data.actualHeight-2*this.data.handle.verticalMargin+"px",e}getLeftStyleMap(t){const e=new this.vido.StyleMap({});return e.style.top=t.$data.position.actualTop+this.data.handle.verticalMargin+"px",this.data.handle.outside?e.style.left=t.$data.position.left-this.data.handle.width-this.data.handle.horizontalMargin+"px":e.style.left=t.$data.position.left+this.data.handle.horizontalMargin+"px",e.style.width=this.data.handle.width+"px",e.style.height=t.$data.actualHeight-2*this.data.handle.verticalMargin+"px",e}getEventArgument(t){const e=this.api.getAllItems(),i=[];for(const n of t)i.push(this.merge({},e[n.id]));return{items:{initial:this.data.initialItems,before:i,after:t,targetData:this.data.targetData},vido:this.vido,state:this.state,time:this.state.get("$data.chart.time")}}dispatchEvent(t,e){e=e.map(t=>this.merge({},t));const i=this.data.events[t](this.getEventArgument(e));let n=this.state.multi();for(const t of i)n=n.update(`config.chart.items.${t.id}.time`,t.time).update(`config.chart.items.${t.id}.$data`,t.$data);n.done()}getItemsForDiff(){const t=this.getSelectedItems()[0],e=this.data.initialItems.find(e=>e.id===t.id);return{modified:t,original:e}}onPointerDown(t){t.preventDefault(),t.stopPropagation(),this.data.initialItems=this.getSelectedItems(),this.data.targetData=this.merge({},t.target.vido),this.data.initialPosition={x:t.screenX,y:t.screenY},this.data.currentPosition=Object.assign({},this.data.initialPosition),""!==this.data.state&&"end"!==this.data.state||(this.data.state="resize"),this.dispatchEvent("onStart",this.data.initialItems)}onLeftPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassLeft),this.onPointerDown(t),this.data.leftIsMoving=!0,this.updateData())}onRightPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassRight),this.onPointerDown(t),this.data.rightIsMoving=!0,this.updateData())}onPointerMove(t){t.stopPropagation(),t.preventDefault(),this.data.currentPosition.x=t.screenX,this.data.currentPosition.y=t.screenY,this.data.movement.px=this.data.currentPosition.x-this.data.initialPosition.x;const{original:e,modified:i}=this.getItemsForDiff();this.data.movement.time=i.time.start-e.time.start,"resize"!==this.data.state&&"start"!==this.data.state||(this.data.state="resize")}onLeftPointerMove(t){if(!this.data.enabled||!this.data.leftIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i=this.merge({},this.data.movement),n=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t];s.$data.position.left=this.data.initialItems[t].$data.position.left+i.px,s.$data.position.left>s.$data.position.right&&(s.$data.position.left=s.$data.position.right),s.$data.position.actualLeft=s.$data.position.left,s.$data.width=s.$data.position.right-s.$data.position.left,s.$data.width<s.minWidth&&(s.$data.width=s.minWidth),s.$data.actualWidth=s.$data.width;const a=this.api.time.getTimeFromViewOffsetPx(s.$data.position.left,n,!0),r=this.data.snapToTime.start({startTime:this.api.time.date(a),item:s,time:n,movement:i,vido:this.vido});s.time.start=r.valueOf(),s.$data.time.startDate=r}this.dispatchEvent("onResize",e),this.updateData()}onRightPointerMove(t){if(!this.data.enabled||!this.data.rightIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i=this.data.movement,n=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t];s.$data.width=this.data.initialItems[t].$data.width+i.px,s.$data.width<s.minWidth&&(s.$data.width=s.minWidth);const a=s.$data.position.actualLeft===s.$data.position.left?0:s.$data.position.left;s.$data.actualWidth=s.$data.width+a;let r=s.$data.position.left+s.$data.width;s.$data.position.right=r,s.$data.position.actualRight=r;const o=this.api.time.getTimeFromViewOffsetPx(r,n,!1),h=this.data.snapToTime.end({endTime:this.api.time.date(o),item:s,time:n,movement:i,vido:this.vido});s.time.end=h.valueOf(),s.$data.time.endDate=h}this.dispatchEvent("onResize",e),this.updateData()}onEnd(){const t=this.getSelectedItems();this.dispatchEvent("onEnd",t)}onPointerUp(t){t.preventDefault(),t.stopPropagation(),"resize"===this.data.state&&(this.data.state="end")}onLeftPointerUp(t){this.data.enabled&&this.data.leftIsMoving&&(document.body.classList.remove(this.data.bodyClassLeft),this.data.leftIsMoving=!1,this.onPointerUp(t),this.onEnd(),this.updateData())}onRightPointerUp(t){this.data.enabled&&this.data.rightIsMoving&&(document.body.classList.remove(this.data.bodyClassRight),this.data.rightIsMoving=!1,this.onPointerUp(t),this.onEnd(),this.updateData())}wrapper(t,e){const i=this.oldWrapper(t,e),n=e.props.item;let s=!n.$data.detached;this.data.handle.onlyWhenSelected&&(s=s&&n.selected);const a=this.getRightStyleMap(n),r=(this.getLeftStyleMap(n),{handleEvent:t=>this.onRightPointerDown(t)}),o=this.html`<div class=${this.rightClassName} style=${a} @pointerdown=${r}>${this.data.content}</div>`;return this.html`${i}${s?o:null}`}}t.Plugin=function(t={}){return function(i){const n=i.state.get("config.plugin.ItemResizing");return n&&(t=function t(i,...n){const s=n.shift();if(e(i)&&e(s))for(const n in s)if(e(s[n]))"function"==typeof s[n].clone?i[n]=s[n].clone():(void 0===i[n]&&(i[n]={}),i[n]=t(i[n],s[n]));else if(Array.isArray(s[n])){i[n]=new Array(s[n].length);let a=0;for(let r of s[n])e(r)?"function"==typeof r.clone?i[n][a]=r.clone():i[n][a]=t({},r):i[n][a]=r,a++}else i[n]=s[n];return n.length?t(i,...n):i}({},t,n)),new E(i,t).destroy}},Object.defineProperty(t,"__esModule",{value:!0})}));
