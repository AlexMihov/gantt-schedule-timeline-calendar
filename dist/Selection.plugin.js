!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Selection=e()}(this,(function(){"use strict";var t=function(t){var e=[],i=null,o=function(){for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];e=s,i||(i=requestAnimationFrame((function(){i=null,t.apply(void 0,e)})))};return o.cancel=function(){i&&(cancelAnimationFrame(i),i=null)},o};
/**
   * Selection plugin
   *
   * @copyright Rafal Pospiech <https://neuronet.io>
   * @author    Rafal Pospiech <neuronet.io@gmail.com>
   * @package   gantt-schedule-timeline-calendar
   * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)
   * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar
   */return function(e={}){let i,o,s;const r={style:{},grid:!1,items:!0,rows:!1,horizontal:!0,vertical:!0,selected(){},deselected(){}};let n,l,c;e={...e,...r};let a={fromX:-1,fromY:-1,toX:-1,toY:-1,startX:-1,startY:-1,selecting:!1};const d="config.plugin.selection",m="gantt-schedule-timeline-caledar__plugin-selection-rect",u=document.createElement("div");u.classList.add(m),u.style.visibility="hidden",u.style.left="0px",u.style.top="0px",u.style.width="0px",u.style.height="0px",u.style.background="rgba(0, 119, 192, 0.2)",u.style.border="2px dashed rgba(0, 119, 192, 0.75)",u.style.position="absolute",u.style["user-select"]="none",u.style["pointer-events"]="none";for(const t in e.style)u.style[t]=e.style[t];function f(e,s){if(!(n=o.get("_internal.elements.chart-timeline")).querySelector("."+m)){n.insertAdjacentElement("beforeend",u);const t=n.getBoundingClientRect();c=t.left,l=t.top}function r(t){0===t.button&&(a.selecting=!0,a.fromX=t.x-c,a.fromY=t.y-l,a.startX=a.fromX,a.startY=a.fromY,o.update(d,{selecting:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},selcted:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]}}),o.update("_internal.chart.grid.rowsWithBlocks",t=>{for(const e of t)for(const t of e.blocks)t.selected=!1,t.selecting=!1;return t}),i.update())}function f(t,e){let i=!1,o=!1;return(t.left>=e.left&&t.left<=e.right||t.right>=e.left&&t.right<=e.right||t.left<=e.left&&t.right>=e.right)&&(i=!0),(t.top>=e.top&&t.top<=e.bottom||t.bottom>=e.top&&t.bottom<=e.bottom||t.top<=e.top&&t.bottom>=e.bottom)&&(o=!0),i&&o}function g(t){if(!a.selecting)return;if(t.x-c===a.fromX||t.y-l===a.fromY)return;t.stopPropagation(),function(t){const e=t.x-c,i=t.y-l;e<=a.startX?(a.fromX=e,a.toX=a.startX):(a.fromX=a.startX,a.toX=e),i<=a.startY?(a.fromY=i,a.toY=a.startY):(a.fromY=a.startY,a.toY=i)}(t),u.style.left=a.fromX+"px",u.style.top=a.fromY+"px",u.style.visibility="visible",u.style.width=a.toX-a.fromX+"px",u.style.height=a.toY-a.fromY+"px";const e=function(t,e,i){const s=[],r=e[i+"s"];for(const e of r){f(e.getBoundingClientRect(),t)&&s.push(e.vido.id)}const n=o.get(`${d}.selecting.${i}s`);for(const t of n);return s}(u.getBoundingClientRect(),o.get("_internal.elements"),"chart-timeline-grid-row-block");o.update(`${d}.selecting`,{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":e,"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]}),o.update("_internal.chart.grid.rowsWithBlocks",t=>{for(const i of t)for(const t of i.blocks)e.includes(t.id)?t.selecting=!0:t.selecting=!1;return t})}function h(t){if(!a.selecting)return;t.stopPropagation(),a.selecting=!1,u.style.visibility="hidden";const e={};o.update(d,t=>(e.selected={...t.selecting},e.selecting={"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},e));const i=e.selected;o.update("_internal.chart.grid.rowsWithBlocks",t=>{for(const e of t)for(const t of e.blocks)i["chart-timeline-grid-row-blocks"].includes(t.id)?t.selected=!0:t.selected=!1;return t})}return e.addEventListener("mousedown",r),e.addEventListener("mousemove",t(g)),document.body.addEventListener("mouseup",h),{destroy(){document.body.removeEventListener("mouseup",h),e.removeEventListener("mousemove",g),e.removeEventListener("mousedown",r)}}}function g(t,e){const i=s.getClass("chart-timeline-grid-row-block")+"--selecting",o=s.getClass("chart-timeline-grid-row-block")+"--selected";return e.selecting?t.classList.add(i):t.classList.remove(i),e.selected?t.classList.add(o):t.classList.remove(o),{update(t,e){e.selecting?t.classList.add(i):t.classList.remove(i),e.selected?t.classList.add(o):t.classList.remove(o)},destroy(t,e){t.classList.remove(i),t.classList.remove(o)}}}function h(t){return o.get("config.plugin.selection").selected["chart-timeline-grid-row-blocks"].find(e=>e===t.id)?t.selected=!0:t.selected=!1,t}return function(t){o=(i=t).state,s=i.api,void 0===o.get(d)&&o.update(d,{selecting:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]},selected:{"chart-timeline-grid-rows":[],"chart-timeline-grid-row-blocks":[],"chart-timeline-items-rows":[],"chart-timeline-items-row-items":[]}}),o.update("config.actions.chart-timeline",t=>(t.push(f),t)),o.update("config.actions.chart-timeline-grid-row-block",t=>(t.push(g),t)),o.update("config.chart.grid.block.onCreate",t=>(t.push(h),t))}}}));
//# sourceMappingURL=Selection.plugin.js.map
