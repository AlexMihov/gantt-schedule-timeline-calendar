var t=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var s=n[i];t.call(e,s[1],s[0])}},e}()}(),e="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,i="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),n="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var s=["top","right","bottom","left","width","height","size","weight"],a="undefined"!=typeof MutationObserver,r=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,s=!1,a=0;function r(){i&&(i=!1,t()),s&&h()}function o(){n(r)}function h(){var t=Date.now();if(i){if(t-a<2)return;s=!0}else i=!0,s=!1,setTimeout(o,e);a=t}return h}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){e&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),a?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){e&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;s.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),o=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var s=n[i];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},h=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||i},d=m(0,0,0,0);function u(t){return parseFloat(t)||0}function c(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+u(t["border-"+i+"-width"])}),0)}function f(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return d;var n=h(t).getComputedStyle(t),s=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var s=n[i],a=t["padding-"+s];e[s]=u(a)}return e}(n),a=s.left+s.right,r=s.top+s.bottom,o=u(n.width),f=u(n.height);if("border-box"===n.boxSizing&&(Math.round(o+a)!==e&&(o-=c(n,"left","right")+a),Math.round(f+r)!==i&&(f-=c(n,"top","bottom")+r)),!function(t){return t===h(t).document.documentElement}(t)){var l=Math.round(o+a)-e,p=Math.round(f+r)-i;1!==Math.abs(l)&&(o-=l),1!==Math.abs(p)&&(f-=p)}return m(s.left,s.top,o,f)}var l="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof h(t).SVGGraphicsElement}:function(t){return t instanceof h(t).SVGElement&&"function"==typeof t.getBBox};function p(t){return e?l(t)?function(t){var e=t.getBBox();return m(0,0,e.width,e.height)}(t):f(t):d}function m(t,e,i,n){return{x:t,y:e,width:i,height:n}}var g=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=p(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),v=function(t,e){var i,n,s,a,r,h,d,u=(n=(i=e).x,s=i.y,a=i.width,r=i.height,h="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,d=Object.create(h.prototype),o(d,{x:n,y:s,width:a,height:r,top:s,right:n+a,bottom:r+s,left:n}),d);o(this,{target:t,contentRect:u})},$=function(){function e(e,i,n){if(this.activeObservations_=[],this.observations_=new t,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=i,this.callbackCtx_=n}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof h(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new g(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof h(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new v(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),y="undefined"!=typeof WeakMap?new WeakMap:new t,b=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=r.getInstance(),n=new $(e,i,this);y.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){b.prototype[t]=function(){var e;return(e=y.get(this))[t].apply(e,arguments)}}));void 0!==i.ResizeObserver&&i.ResizeObserver;(class{constructor(){this.isAction=!0}}).prototype.isAction=!0;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function w(t,e){return t(e={exports:{}},e.exports),e.exports}w((function(t,e){t.exports=function(){var t="millisecond",e="second",i="minute",n="hour",s="day",a="week",r="month",o="quarter",h="year",d=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,u=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,c=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},f={s:c,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),n=Math.floor(i/60),s=i%60;return(e<=0?"+":"-")+c(n,2,"0")+":"+c(s,2,"0")},m:function(t,e){var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,r),s=e-n<0,a=t.clone().add(i+(s?-1:1),r);return Number(-(i+(e-n)/(s?n-a:a-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(d){return{M:r,y:h,w:a,d:s,D:"date",h:n,m:i,s:e,ms:t,Q:o}[d]||String(d||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},l={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},p="en",m={};m[p]=l;var g=function(t){return t instanceof b},v=function(t,e,i){var n;if(!t)return p;if("string"==typeof t)m[t]&&(n=t),e&&(m[t]=e,n=t);else{var s=t.name;m[s]=t,n=s}return!i&&n&&(p=n),n||!i&&p},$=function(t,e,i){if(g(t))return t.clone();var n=e?"string"==typeof e?{format:e,pl:i}:e:{};return n.date=t,new b(n)},y=f;y.l=v,y.i=g,y.w=function(t,e){return $(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var b=function(){function c(t){this.$L=this.$L||v(t.locale,null,!0),this.parse(t)}var f=c.prototype;return f.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(y.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(d);if(n)return i?new Date(Date.UTC(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)):new Date(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)}return new Date(e)}(t),this.init()},f.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},f.$utils=function(){return y},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(t,e){var i=$(t);return this.startOf(e)<=i&&i<=this.endOf(e)},f.isAfter=function(t,e){return $(t)<this.startOf(e)},f.isBefore=function(t,e){return this.endOf(e)<$(t)},f.$g=function(t,e,i){return y.u(t)?this[e]:this.set(i,t)},f.year=function(t){return this.$g(t,"$y",h)},f.month=function(t){return this.$g(t,"$M",r)},f.day=function(t){return this.$g(t,"$W",s)},f.date=function(t){return this.$g(t,"$D","date")},f.hour=function(t){return this.$g(t,"$H",n)},f.minute=function(t){return this.$g(t,"$m",i)},f.second=function(t){return this.$g(t,"$s",e)},f.millisecond=function(e){return this.$g(e,"$ms",t)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(t,o){var d=this,u=!!y.u(o)||o,c=y.p(t),f=function(t,e){var i=y.w(d.$u?Date.UTC(d.$y,e,t):new Date(d.$y,e,t),d);return u?i:i.endOf(s)},l=function(t,e){return y.w(d.toDate()[t].apply(d.toDate(),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),d)},p=this.$W,m=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(c){case h:return u?f(1,0):f(31,11);case r:return u?f(1,m):f(0,m+1);case a:var $=this.$locale().weekStart||0,b=(p<$?p+7:p)-$;return f(u?g-b:g+(6-b),m);case s:case"date":return l(v+"Hours",0);case n:return l(v+"Minutes",1);case i:return l(v+"Seconds",2);case e:return l(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(t){return this.startOf(t,!1)},f.$set=function(a,o){var d,u=y.p(a),c="set"+(this.$u?"UTC":""),f=(d={},d.day=c+"Date",d.date=c+"Date",d[r]=c+"Month",d[h]=c+"FullYear",d[n]=c+"Hours",d[i]=c+"Minutes",d[e]=c+"Seconds",d[t]=c+"Milliseconds",d)[u],l=u===s?this.$D+(o-this.$W):o;if(u===r||u===h){var p=this.clone().set("date",1);p.$d[f](l),p.init(),this.$d=p.set("date",Math.min(this.$D,p.daysInMonth())).toDate()}else f&&this.$d[f](l);return this.init(),this},f.set=function(t,e){return this.clone().$set(t,e)},f.get=function(t){return this[y.p(t)]()},f.add=function(t,o){var d,u=this;t=Number(t);var c=y.p(o),f=function(e){var i=$(u);return y.w(i.date(i.date()+Math.round(e*t)),u)};if(c===r)return this.set(r,this.$M+t);if(c===h)return this.set(h,this.$y+t);if(c===s)return f(1);if(c===a)return f(7);var l=(d={},d[i]=6e4,d[n]=36e5,d[e]=1e3,d)[c]||1,p=this.$d.getTime()+t*l;return y.w(p,this)},f.subtract=function(t,e){return this.add(-1*t,e)},f.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var i=t||"YYYY-MM-DDTHH:mm:ssZ",n=y.z(this),s=this.$locale(),a=this.$H,r=this.$m,o=this.$M,h=s.weekdays,d=s.months,c=function(t,n,s,a){return t&&(t[n]||t(e,i))||s[n].substr(0,a)},f=function(t){return y.s(a%12||12,t,"0")},l=s.meridiem||function(t,e,i){var n=t<12?"AM":"PM";return i?n.toLowerCase():n},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:o+1,MM:y.s(o+1,2,"0"),MMM:c(s.monthsShort,o,d,3),MMMM:d[o]||d(this,i),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:c(s.weekdaysMin,this.$W,h,2),ddd:c(s.weekdaysShort,this.$W,h,3),dddd:h[this.$W],H:String(a),HH:y.s(a,2,"0"),h:f(1),hh:f(2),a:l(a,r,!0),A:l(a,r,!1),m:String(r),mm:y.s(r,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:n};return i.replace(u,(function(t,e){return e||p[t]||n.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(t,s,d){var u,c=y.p(s),f=$(t),l=6e4*(f.utcOffset()-this.utcOffset()),p=this-f,m=y.m(this,f);return m=(u={},u[h]=m/12,u[r]=m,u[o]=m/3,u[a]=(p-l)/6048e5,u.day=(p-l)/864e5,u[n]=p/36e5,u[i]=p/6e4,u[e]=p/1e3,u)[c]||p,d?m:y.a(m)},f.daysInMonth=function(){return this.endOf(r).$D},f.$locale=function(){return m[this.$L]},f.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=v(t,e,!0);return n&&(i.$L=n),i},f.clone=function(){return y.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},c}();return $.prototype=b.prototype,$.extend=function(t,e){return t(e,b,$),$},$.locale=v,$.isDayjs=g,$.unix=function(t){return $(1e3*t)},$.en=m[p],$.Ls=m,$}()})),w((function(t,e){t.exports=function(t,e,i){var n=(new Date).getTimezoneOffset(),s=e.prototype;i.utc=function(t,i){return new e({date:t,utc:!0,format:i})},s.utc=function(){return i(this.toDate(),{locale:this.$L,utc:!0})},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var a=s.parse;s.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),a.call(this,t)};var r=s.init;s.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else r.call(this)};var o=s.utcOffset;s.utcOffset=function(t){var e=this.$utils().u;if(e(t))return this.$u?0:e(this.$offset)?o.call(this):this.$offset;var i,s=Math.abs(t)<=16?60*t:t;return 0!==t?(i=this.local().add(s+n,"minute")).$offset=s:i=this.utc(),i};var h=s.format;s.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,e)},s.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+n;return this.$d.valueOf()-6e4*t},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()}}}));new TextEncoder("utf-8");const _="gantt-schedule-timeline-calendar";const M=function(t){let e=`${_}__${t}`;return t===_&&(e=_),e}("chart-timeline-items-row-item-resizing-handle-content-line");class O{constructor(t,e){this.spacing=1,this.unsubs=[],this.vido=t,this.state=t.state,this.api=t.api,this.data=function(t={}){const e={onStart:({items:t})=>t.after,onResize:({items:t})=>t.after,onEnd:({items:t})=>t.after},i={start:({startTime:t,time:e})=>t.startOf(e.period),end:({endTime:t,time:e})=>t.endOf(e.period)},n={width:18,horizontalMargin:0,verticalMargin:0,outside:!1,onlyWhenSelected:!0},s=Object.assign({enabled:!0,debug:!1,state:"",content:null,bodyClass:"gstc-item-resizing",bodyClassLeft:"gstc-items-resizing-left",bodyClassRight:"gstc-items-resizing-right",initialPosition:{x:0,y:0},currentPosition:{x:0,y:0},movement:{px:0,time:0},initialItems:[],leftIsMoving:!1,rightIsMoving:!1,handle:Object.assign({},n),events:Object.assign({},e),snapToTime:Object.assign({},i)},t);return t.snapToTime&&(s.snapToTime=Object.assign(Object.assign({},i),t.snapToTime)),t.events&&(s.events=Object.assign(Object.assign({},e),t.events)),t.handle&&(s.handle=Object.assign(Object.assign({},n),t.handle)),s}(e),this.merge=this.state.get("config.merge"),this.minWidth=2*this.data.handle.width,this.state.update("config.chart.item.minWidth",this.minWidth),this.state.update("config.chart.items.*.minWidth",this.minWidth),this.html=t.html,this.data.content||(this.data.content=this.html`<div class=${M}></div><div class=${M}></div>`),this.wrapper=this.wrapper.bind(this),this.onRightPointerDown=this.onRightPointerDown.bind(this),this.onRightPointerMove=this.onRightPointerMove.bind(this),this.onRightPointerUp=this.onRightPointerUp.bind(this),this.onLeftPointerDown=this.onLeftPointerDown.bind(this),this.onLeftPointerMove=this.onLeftPointerMove.bind(this),this.onLeftPointerUp=this.onLeftPointerUp.bind(this),this.destroy=this.destroy.bind(this),this.updateData(),document.body.classList.add(this.data.bodyClass),this.unsubs.push(this.state.subscribe("config.plugin.ItemResizing",t=>{t.enabled?t.enabled&&document.body.classList.add(this.data.bodyClass):document.body.classList.remove(this.data.bodyClass),this.data=t})),document.addEventListener("pointermove",this.onLeftPointerMove),document.addEventListener("pointerup",this.onLeftPointerUp),document.addEventListener("pointermove",this.onRightPointerMove),document.addEventListener("pointerup",this.onRightPointerUp),this.state.update("config.wrappers.ChartTimelineItemsRowItem",t=>(this.oldWrapper||(this.oldWrapper=t),this.initializeWrapper(),this.wrapper))}destroy(){this.unsubs.forEach(t=>t()),document.removeEventListener("pointermove",this.onLeftPointerMove),document.removeEventListener("pointerup",this.onLeftPointerUp),document.removeEventListener("pointermove",this.onRightPointerMove),document.removeEventListener("pointerup",this.onRightPointerUp),this.oldWrapper&&this.state.update("config.wrappers.ChartTimelineItemsRowItem",()=>this.oldWrapper)}updateData(){this.state.update("config.plugin.ItemResizing",this.data)}initializeWrapper(){this.leftClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.leftClassName+=" "+this.leftClassName+"--left",this.rightClassName=this.api.getClass("chart-timeline-items-row-item-resizing-handle"),this.rightClassName+=" "+this.rightClassName+"--right",this.spacing=this.state.get("config.chart.spacing")}getSelectedItems(){return this.state.get("config.plugin.Selection.selected.chart-timeline-items-row-item").map(t=>this.merge({},t))}getRightStyleMap(t,e){const i=new this.vido.StyleMap({});return i.style.top=t.$data.position.actualTop+this.data.handle.verticalMargin+"px",this.data.handle.outside?i.style.left=t.$data.position.right+this.data.handle.horizontalMargin-this.spacing+"px":i.style.left=t.$data.position.right-this.data.handle.width-this.data.handle.horizontalMargin-this.spacing+"px",i.style.width=this.data.handle.width+"px",i.style.height=t.$data.actualHeight-2*this.data.handle.verticalMargin+"px",i}getLeftStyleMap(t,e){const i=new this.vido.StyleMap({});return i.style.top=t.$data.position.actualTop+this.data.handle.verticalMargin+"px",this.data.handle.outside?i.style.left=t.$data.position.left-this.data.handle.width-this.data.handle.horizontalMargin+"px":i.style.left=t.$data.position.left+this.data.handle.horizontalMargin+"px",i.style.width=this.data.handle.width+"px",i.style.height=t.$data.actualHeight-2*this.data.handle.verticalMargin+"px",i}getEventArgument(t){const e=this.state.get("config.chart.items"),i=[];for(const n of t)i.push(this.merge({},e[n.id]));return{items:{initial:this.data.initialItems,before:i,after:t},vido:this.vido,state:this.state,time:this.state.get("$data.chart.time")}}dispatchEvent(t,e){e=e.map(t=>this.merge({},t));const i=this.data.events[t](this.getEventArgument(e));let n=this.state.multi();for(const t of i)n=n.update(`config.chart.items.${t.id}.time`,t.time).update(`config.chart.items.${t.id}.$data`,t.$data);n.done()}getItemsForDiff(){const t=this.getSelectedItems()[0],e=this.data.initialItems.find(e=>e.id===t.id);return{modified:t,original:e}}onPointerDown(t){t.preventDefault(),t.stopPropagation(),this.data.initialItems=this.getSelectedItems(),this.data.initialPosition={x:t.screenX,y:t.screenY},this.data.currentPosition=Object.assign({},this.data.initialPosition),""!==this.data.state&&"end"!==this.data.state||(this.data.state="resize"),this.dispatchEvent("onStart",this.data.initialItems)}onLeftPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassLeft),this.onPointerDown(t),this.data.leftIsMoving=!0,this.updateData())}onRightPointerDown(t){this.data.enabled&&(document.body.classList.add(this.data.bodyClassRight),this.onPointerDown(t),this.data.rightIsMoving=!0,this.updateData())}onPointerMove(t){t.stopPropagation(),t.preventDefault(),this.data.currentPosition.x=t.screenX,this.data.currentPosition.y=t.screenY,this.data.movement.px=this.data.currentPosition.x-this.data.initialPosition.x;const{original:e,modified:i}=this.getItemsForDiff();this.data.movement.time=i.time.start-e.time.start,"resize"!==this.data.state&&"start"!==this.data.state||(this.data.state="resize")}onLeftPointerMove(t){if(!this.data.enabled||!this.data.leftIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i=this.merge({},this.data.movement),n=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t];s.$data.position.left=this.data.initialItems[t].$data.position.left+i.px,s.$data.position.left>s.$data.position.right&&(s.$data.position.left=s.$data.position.right),s.$data.position.actualLeft=s.$data.position.left,s.$data.width=s.$data.position.right-s.$data.position.left,s.$data.width<s.minWidth&&(s.$data.width=s.minWidth),s.$data.actualWidth=s.$data.width;const a=this.api.time.getTimeFromViewOffsetPx(s.$data.position.left,n,!0),r=this.data.snapToTime.start({startTime:this.api.time.date(a),item:s,time:n,movement:i,vido:this.vido});s.time.start=r.valueOf(),s.$data.time.startDate=r}this.dispatchEvent("onResize",e),this.updateData()}onRightPointerMove(t){if(!this.data.enabled||!this.data.rightIsMoving)return;this.onPointerMove(t);const e=this.getSelectedItems(),i=this.data.movement,n=this.state.get("$data.chart.time");for(let t=0,s=e.length;t<s;t++){const s=e[t];s.$data.width=this.data.initialItems[t].$data.width+i.px,s.$data.width<s.minWidth&&(s.$data.width=s.minWidth);const a=s.$data.position.actualLeft===s.$data.position.left?0:s.$data.position.left;s.$data.actualWidth=s.$data.width+a;let r=s.$data.position.left+s.$data.width;s.$data.position.right=r,s.$data.position.actualRight=r;const o=this.api.time.getTimeFromViewOffsetPx(r,n,!1),h=this.data.snapToTime.end({endTime:this.api.time.date(o),item:s,time:n,movement:i,vido:this.vido});s.time.end=h.valueOf(),s.$data.time.endDate=h}this.dispatchEvent("onResize",e),this.updateData()}onEnd(t){const e=this.getSelectedItems();this.dispatchEvent("onEnd",e)}onPointerUp(t){t.preventDefault(),t.stopPropagation(),"resize"===this.data.state&&(this.data.state="end")}onLeftPointerUp(t){this.data.enabled&&this.data.leftIsMoving&&(document.body.classList.remove(this.data.bodyClassLeft),this.data.leftIsMoving=!1,this.onPointerUp(t),this.onEnd("left"),this.updateData())}onRightPointerUp(t){this.data.enabled&&this.data.rightIsMoving&&(document.body.classList.remove(this.data.bodyClassRight),this.data.rightIsMoving=!1,this.onPointerUp(t),this.onEnd("right"),this.updateData())}wrapper(t,e){const i=this.oldWrapper(t,e),n=e.props.item;let s=!n.$data.detached;this.data.handle.onlyWhenSelected&&(s=s&&n.selected);const a=this.getRightStyleMap(n,s),r=(this.getLeftStyleMap(n,s),{handleEvent:t=>this.onRightPointerDown(t)}),o=this.html`<div class=${this.rightClassName} style=${a} @pointerdown=${r}>${this.data.content}</div>`;return this.html`${i}${s?o:null}`}}function D(t={}){return function(e){return new O(e,t).destroy}}export{D as Plugin};
