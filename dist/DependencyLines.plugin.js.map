{"version":3,"file":"DependencyLines.plugin.js","sources":["../src/plugins/DependencyLines.plugin.ts"],"sourcesContent":["/**\n * DependencyLines plugin\n *\n * @copyright Rafal Pospiech <https://neuronet.io>\n * @author    Rafal Pospiech <neuronet.io@gmail.com>\n * @package   gantt-schedule-timeline-calendar\n * @license   GPL-3.0 (https://github.com/neuronetio/gantt-schedule-timeline-calendar/blob/master/LICENSE)\n * @link      https://github.com/neuronetio/gantt-schedule-timeline-calendar\n */\n\nlet opts: Options;\nlet state, api;\nconst container = document.createElement('div');\ncontainer.style.position = 'absolute';\ncontainer.style.left = '0';\ncontainer.style.top = '0';\ncontainer.style.width = 'var(--width)';\ncontainer.style.height = 'var(--height)';\n\nexport type Type = 'straight' | 'quadratic' | 'cubic';\nexport interface Style {\n  [name: string]: string;\n}\nexport interface HandleOptions {\n  style?: Style;\n  width?: number;\n  height?: number;\n}\nexport interface ConnectorOptions {\n  style?: Style;\n  width?: number;\n  height?: number;\n}\nexport interface Options {\n  type?: Type;\n  handle?: HandleOptions;\n  connector?: ConnectorOptions;\n}\n\nconst defaultOptions: Options = {\n  type: 'quadratic',\n  handle: {\n    style: {},\n    width: 40,\n    height: 40\n  },\n  connector: {\n    style: {},\n    width: 40,\n    height: 40\n  }\n};\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport type Points = Point[];\n\n/**\n * Item dependency line component\n * @param vido\n * @param props\n */\nfunction ItemDependencyLine(vido, props) {\n  const { state, onDestroy, onChange, html, svg, Detach, update, StyleMap } = vido;\n  const componentName = 'chart-timeline-dependency-lines-line';\n\n  let classNameLine;\n  onDestroy(\n    state.subscribe('config.classNames', () => {\n      classNameLine = api.getClass(componentName + '-line');\n    })\n  );\n\n  let wrapper;\n  onDestroy(\n    state.subscribe('config.wrappers.DependencyLineRightHandle', value => {\n      if (value) {\n        wrapper = value;\n      } else {\n        wrapper = function DependencyLineRightHandleWrapper(input) {\n          return input;\n        };\n      }\n    })\n  );\n\n  let shouldDetach = false;\n  const detach = new Detach(() => shouldDetach);\n\n  let timePerPixel = 1;\n  onDestroy(\n    state.subscribe('_internal.chart.time.timePerPixel', value => {\n      timePerPixel = value || 1;\n      updateLines();\n    })\n  );\n\n  const styleMap = new StyleMap({});\n\n  let lines = [];\n  function updateLines() {\n    lines.length = 0;\n    const itemIds = props?.item?.lines || [];\n    const items = state.get('config.chart.items');\n    const rows = state.get('config.list.rows');\n    for (const itemId of itemIds) {\n      const currentItem = items[itemId];\n      if (!currentItem) continue;\n      const currentRow = rows[currentItem.rowId];\n      if (!currentRow) continue;\n      const width = Math.abs(props.width + (props.item.time.start - currentItem.time.start) / timePerPixel);\n      const height = Math.abs(props.row.top - currentRow.top) + currentRow.height;\n      const line = svg`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${width}\" height=\"${height}\" viewBox=\"0 0 ${width} ${height}\"></svg>`;\n      lines.push(line);\n    }\n  }\n\n  onChange(function onChange(changedProps, options) {\n    if (options.leave || !changedProps) {\n      shouldDetach = true;\n      return update();\n    }\n    shouldDetach = false;\n    props = changedProps;\n    styleMap.style['left'] = props.left + props.width + 'px';\n    updateLines();\n    update();\n  });\n\n  return templateProps =>\n    wrapper(\n      html`\n        <div detach=${detach} class=${classNameLine} style=${styleMap}>${lines.map(line => line)}</div>\n      `,\n      { templateProps, props, vido }\n    );\n}\n\n/**\n * DependencyLines Lines Component\n * @param vido\n */\nfunction DependencyLinesLines(vido) {\n  const { html, onDestroy, api, state, reuseComponents } = vido;\n  const componentName = 'chart-timeline-dependency-lines-lines';\n\n  let className;\n  onDestroy(\n    state.subscribe('config.classNames', () => {\n      className = api.getClass(componentName);\n    })\n  );\n\n  let lines = [];\n  onDestroy(\n    state.subscribe('_internal.chart.visibleItems', visibleItems => {\n      const allRows = state.get('config.list.rows');\n      const rows = {};\n      for (const itemId in visibleItems) {\n        const item = visibleItems[itemId];\n        if (typeof item.rowId === 'string' && allRows[item.rowId]) {\n          rows[item.rowId] = allRows[item.rowId];\n        }\n      }\n    })\n  );\n\n  return templateProps =>\n    html`\n      <div class=\"${className}\">${lines.map(line => line.html())}</div>\n    `;\n}\n\n/**\n * Are we connecting the dots?\n */\nlet connecting = false;\n\n/**\n * Item dependency line handle\n * @param vido\n * @param props\n */\nfunction ItemDependencyLineHandle(vido, props) {\n  const { html, onDestroy, api, state, StyleMap, onChange, Detach, update, Actions, PointerAction } = vido;\n  const componentName = 'chart-timeline-dependency-lines-handle';\n  const connectorName = componentName + '--connector';\n\n  const actionProps = { ...props };\n  let className, connectorClassName;\n  onDestroy(\n    state.subscribe('config.classNames', () => {\n      className = api.getClass(componentName);\n      connectorClassName = api.getClass(connectorName);\n    })\n  );\n\n  let shouldDetach = false;\n  const detach = new Detach(() => {\n    const moving = state.get('config.plugin.ItemMovement.movement.moving');\n    return shouldDetach || !props.item.selected || moving;\n  });\n  const connectorDetach = new Detach(() => shouldDetach || !connecting || connecting === props.item.id);\n\n  const styleMap = new StyleMap({\n    left: '0px',\n    top: '0px',\n    width: opts.handle.width + 'px',\n    height: opts.handle.height + 'px'\n  });\n  const connectorStyleMap = new StyleMap({\n    left: '0px',\n    top: '0px',\n    width: opts.connector.width + 'px',\n    height: opts.connector.height + 'px'\n  });\n\n  function updatePosition() {\n    styleMap.style.left = api.time.globalTimeToViewPixelOffset(props.item.time.end, true) + 'px';\n    styleMap.style.top = props.row.top + 'px';\n    connectorStyleMap.style.left =\n      api.time.globalTimeToViewPixelOffset(props.item.time.start, true) - opts.connector.width - 1 + 'px';\n    connectorStyleMap.style.top = props.row.top + 'px';\n    for (const name in opts.handle.style) {\n      styleMap.style[name] = opts.handle.style[name];\n    }\n    for (const name in opts.connector.style) {\n      connectorStyleMap.style[name] = opts.connector.style[name];\n    }\n  }\n\n  function change(changedProps, options) {\n    if (options.leave) {\n      shouldDetach = true;\n      return update();\n    }\n    shouldDetach = false;\n    props = changedProps;\n    for (const prop in props) {\n      actionProps[prop] = props[prop];\n    }\n    updatePosition();\n    update();\n  }\n  onChange(change);\n\n  onDestroy(\n    state.subscribeAll(['_internal.chart.time', 'config.scroll.compensation'], () => {\n      updatePosition();\n      update();\n    })\n  );\n\n  const componentActions = api.getActions(componentName);\n  actionProps.pointerOptions = {\n    axis: 'xy',\n    onDown({ event }) {\n      event.stopPropagation();\n      event.preventDefault();\n      connecting = props.item.id;\n      update();\n    },\n    onMove({ event, movementX, movementY }) {\n      if (connecting) {\n        event.stopPropagation();\n        event.preventDefault();\n        update();\n      }\n    },\n    onUp({ event }) {\n      if (connecting) {\n        event.stopPropagation();\n        event.preventDefault();\n        connecting = false;\n        update();\n      }\n    }\n  };\n  componentActions.push(PointerAction);\n  const actions = Actions.create(componentActions, actionProps);\n\n  return templateProps =>\n    html`\n      <div detach=${detach} class=${className} style=${styleMap} data-actions=${actions}></div>\n      <div detach=${connectorDetach} class=${connectorClassName} style=${connectorStyleMap}></div>\n    `;\n}\n\n/**\n * DependencyLines Handles Component\n * @param vido\n */\nfunction DependencyLinesHandles(vido) {\n  const { html, onDestroy, api, state, reuseComponents } = vido;\n  const componentName = 'chart-timeline-dependency-lines-handles';\n\n  let className;\n  onDestroy(\n    state.subscribe('config.classNames', () => {\n      className = api.getClass(componentName);\n    })\n  );\n\n  const handles = [];\n  onDestroy(\n    state.subscribe('_internal.chart.visibleItems', visibleItems => {\n      const handlesProps = [];\n      const allRows = state.get('config.list.rows');\n      for (const item of visibleItems) {\n        // @ts-ignore\n        const row = allRows[item.rowId];\n        if (!row) continue;\n        handlesProps.push({\n          item: item,\n          row\n        });\n      }\n      return reuseComponents(handles, handlesProps, prop => prop, ItemDependencyLineHandle);\n    })\n  );\n\n  return templateProps =>\n    html`\n      <div class=\"${className}\">${handles.map(handle => handle.html())}</div>\n    `;\n}\n\nexport default function DependencyLinesPlugin(options: Options = defaultOptions) {\n  return function initialize(vido) {\n    state = vido.state;\n    api = vido.api;\n\n    defaultOptions.connector.width = defaultOptions.connector.height = state.get('config.list.rowHeight') || 40;\n\n    opts = { ...defaultOptions, ...options };\n    opts.connector = { ...defaultOptions.connector, ...opts.connector };\n    opts.connector.style = { ...defaultOptions.connector.style, ...opts.connector.style };\n    opts.handle = { ...defaultOptions.handle, ...opts.handle };\n    opts.handle.style = { ...defaultOptions.handle.style, ...opts.handle.style };\n\n    const Lines = vido.createComponent(DependencyLinesLines);\n    state.update('config.wrappers.ChartTimelineGrid', gridWrapper => {\n      return function DependencyLinesGridWrapper(input, data) {\n        const output = vido.html`${input}${Lines.html()}`;\n        return gridWrapper(output, data);\n      };\n    });\n\n    const Handles = vido.createComponent(DependencyLinesHandles);\n    state.update('config.wrappers.ChartTimelineItems', itemsWrapper => {\n      return function DependencyLinesItemsWrapper(input, data) {\n        const output = vido.html`${input}${Handles.html()}`;\n        return itemsWrapper(output, data);\n      };\n    });\n\n    return function destroy() {\n      Lines.destroy();\n      Handles.destroy();\n    };\n  };\n}\n"],"names":[],"mappings":";;;;;;EAAA;;;;;;;;;EAUA,IAAI,IAAa,CAAC;EAClB,IAAI,KAAK,EAAE,GAAG,CAAC;EACf,MAAM,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;EAChD,SAAS,CAAC,KAAK,CAAC,QAAQ,GAAG,UAAU,CAAC;EACtC,SAAS,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;EAC3B,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;EAC1B,SAAS,CAAC,KAAK,CAAC,KAAK,GAAG,cAAc,CAAC;EACvC,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,eAAe,CAAC;EAsBzC,MAAM,cAAc,GAAY;MAC9B,IAAI,EAAE,WAAW;MACjB,MAAM,EAAE;UACN,KAAK,EAAE,EAAE;UACT,KAAK,EAAE,EAAE;UACT,MAAM,EAAE,EAAE;OACX;MACD,SAAS,EAAE;UACT,KAAK,EAAE,EAAE;UACT,KAAK,EAAE,EAAE;UACT,MAAM,EAAE,EAAE;OACX;GACF,CAAC;AASF,EAiFA;;;;EAIA,SAAS,oBAAoB,CAAC,IAAI;MAChC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,eAAe,EAAE,GAAG,IAAI,CAAC;MAC9D,MAAM,aAAa,GAAG,uCAAuC,CAAC;MAE9D,IAAI,SAAS,CAAC;MACd,SAAS,CACP,KAAK,CAAC,SAAS,CAAC,mBAAmB,EAAE;UACnC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;OACzC,CAAC,CACH,CAAC;MAEF,IAAI,KAAK,GAAG,EAAE,CAAC;MACf,SAAS,CACP,KAAK,CAAC,SAAS,CAAC,8BAA8B,EAAE,YAAY;UAC1D,MAAM,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;UAC9C,MAAM,IAAI,GAAG,EAAE,CAAC;UAChB,KAAK,MAAM,MAAM,IAAI,YAAY,EAAE;cACjC,MAAM,IAAI,GAAG,YAAY,CAAC,MAAM,CAAC,CAAC;cAClC,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;kBACzD,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;eACxC;WACF;OACF,CAAC,CACH,CAAC;MAEF,OAAO,aAAa,IAClB,IAAI,CAAA;oBACY,SAAS,KAAK,KAAK,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;KAC3D,CAAC;EACN,CAAC;EAED;;;EAGA,IAAI,UAAU,GAAG,KAAK,CAAC;EAEvB;;;;;EAKA,SAAS,wBAAwB,CAAC,IAAI,EAAE,KAAK;MAC3C,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC;MACzG,MAAM,aAAa,GAAG,wCAAwC,CAAC;MAC/D,MAAM,aAAa,GAAG,aAAa,GAAG,aAAa,CAAC;MAEpD,MAAM,WAAW,qBAAQ,KAAK,CAAE,CAAC;MACjC,IAAI,SAAS,EAAE,kBAAkB,CAAC;MAClC,SAAS,CACP,KAAK,CAAC,SAAS,CAAC,mBAAmB,EAAE;UACnC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;UACxC,kBAAkB,GAAG,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;OAClD,CAAC,CACH,CAAC;MAEF,IAAI,YAAY,GAAG,KAAK,CAAC;MACzB,MAAM,MAAM,GAAG,IAAI,MAAM,CAAC;UACxB,MAAM,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,4CAA4C,CAAC,CAAC;UACvE,OAAO,YAAY,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,IAAI,MAAM,CAAC;OACvD,CAAC,CAAC;MACH,MAAM,eAAe,GAAG,IAAI,MAAM,CAAC,MAAM,YAAY,IAAI,CAAC,UAAU,IAAI,UAAU,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;MAEtG,MAAM,QAAQ,GAAG,IAAI,QAAQ,CAAC;UAC5B,IAAI,EAAE,KAAK;UACX,GAAG,EAAE,KAAK;UACV,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI;UAC/B,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI;OAClC,CAAC,CAAC;MACH,MAAM,iBAAiB,GAAG,IAAI,QAAQ,CAAC;UACrC,IAAI,EAAE,KAAK;UACX,GAAG,EAAE,KAAK;UACV,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,IAAI;UAClC,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI;OACrC,CAAC,CAAC;MAEH,SAAS,cAAc;UACrB,QAAQ,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC;UAC7F,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC;UAC1C,iBAAiB,CAAC,KAAK,CAAC,IAAI;cAC1B,GAAG,CAAC,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC;UACtG,iBAAiB,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,IAAI,CAAC;UACnD,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;cACpC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;WAChD;UACD,KAAK,MAAM,IAAI,IAAI,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;cACvC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;WAC5D;OACF;MAED,SAAS,MAAM,CAAC,YAAY,EAAE,OAAO;UACnC,IAAI,OAAO,CAAC,KAAK,EAAE;cACjB,YAAY,GAAG,IAAI,CAAC;cACpB,OAAO,MAAM,EAAE,CAAC;WACjB;UACD,YAAY,GAAG,KAAK,CAAC;UACrB,KAAK,GAAG,YAAY,CAAC;UACrB,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;cACxB,WAAW,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;WACjC;UACD,cAAc,EAAE,CAAC;UACjB,MAAM,EAAE,CAAC;OACV;MACD,QAAQ,CAAC,MAAM,CAAC,CAAC;MAEjB,SAAS,CACP,KAAK,CAAC,YAAY,CAAC,CAAC,sBAAsB,EAAE,4BAA4B,CAAC,EAAE;UACzE,cAAc,EAAE,CAAC;UACjB,MAAM,EAAE,CAAC;OACV,CAAC,CACH,CAAC;MAEF,MAAM,gBAAgB,GAAG,GAAG,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;MACvD,WAAW,CAAC,cAAc,GAAG;UAC3B,IAAI,EAAE,IAAI;UACV,MAAM,CAAC,EAAE,KAAK,EAAE;cACd,KAAK,CAAC,eAAe,EAAE,CAAC;cACxB,KAAK,CAAC,cAAc,EAAE,CAAC;cACvB,UAAU,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC;cAC3B,MAAM,EAAE,CAAC;WACV;UACD,MAAM,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE;cACpC,IAAI,UAAU,EAAE;kBACd,KAAK,CAAC,eAAe,EAAE,CAAC;kBACxB,KAAK,CAAC,cAAc,EAAE,CAAC;kBACvB,MAAM,EAAE,CAAC;eACV;WACF;UACD,IAAI,CAAC,EAAE,KAAK,EAAE;cACZ,IAAI,UAAU,EAAE;kBACd,KAAK,CAAC,eAAe,EAAE,CAAC;kBACxB,KAAK,CAAC,cAAc,EAAE,CAAC;kBACvB,UAAU,GAAG,KAAK,CAAC;kBACnB,MAAM,EAAE,CAAC;eACV;WACF;OACF,CAAC;MACF,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;MACrC,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;MAE9D,OAAO,aAAa,IAClB,IAAI,CAAA;oBACY,MAAM,UAAU,SAAS,UAAU,QAAQ,iBAAiB,OAAO;oBACnE,eAAe,UAAU,kBAAkB,UAAU,iBAAiB;KACrF,CAAC;EACN,CAAC;EAED;;;;EAIA,SAAS,sBAAsB,CAAC,IAAI;MAClC,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,eAAe,EAAE,GAAG,IAAI,CAAC;MAC9D,MAAM,aAAa,GAAG,yCAAyC,CAAC;MAEhE,IAAI,SAAS,CAAC;MACd,SAAS,CACP,KAAK,CAAC,SAAS,CAAC,mBAAmB,EAAE;UACnC,SAAS,GAAG,GAAG,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC;OACzC,CAAC,CACH,CAAC;MAEF,MAAM,OAAO,GAAG,EAAE,CAAC;MACnB,SAAS,CACP,KAAK,CAAC,SAAS,CAAC,8BAA8B,EAAE,YAAY;UAC1D,MAAM,YAAY,GAAG,EAAE,CAAC;UACxB,MAAM,OAAO,GAAG,KAAK,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;UAC9C,KAAK,MAAM,IAAI,IAAI,YAAY,EAAE;;cAE/B,MAAM,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;cAChC,IAAI,CAAC,GAAG;kBAAE,SAAS;cACnB,YAAY,CAAC,IAAI,CAAC;kBAChB,IAAI,EAAE,IAAI;kBACV,GAAG;eACJ,CAAC,CAAC;WACJ;UACD,OAAO,eAAe,CAAC,OAAO,EAAE,YAAY,EAAE,IAAI,IAAI,IAAI,EAAE,wBAAwB,CAAC,CAAC;OACvF,CAAC,CACH,CAAC;MAEF,OAAO,aAAa,IAClB,IAAI,CAAA;oBACY,SAAS,KAAK,OAAO,CAAC,GAAG,CAAC,MAAM,IAAI,MAAM,CAAC,IAAI,EAAE,CAAC;KACjE,CAAC;EACN,CAAC;AAED,WAAwB,qBAAqB,CAAC,UAAmB,cAAc;MAC7E,OAAO,SAAS,UAAU,CAAC,IAAI;UAC7B,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;UACnB,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;UAEf,cAAc,CAAC,SAAS,CAAC,KAAK,GAAG,cAAc,CAAC,SAAS,CAAC,MAAM,GAAG,KAAK,CAAC,GAAG,CAAC,uBAAuB,CAAC,IAAI,EAAE,CAAC;UAE5G,IAAI,mCAAQ,cAAc,GAAK,OAAO,CAAE,CAAC;UACzC,IAAI,CAAC,SAAS,mCAAQ,cAAc,CAAC,SAAS,GAAK,IAAI,CAAC,SAAS,CAAE,CAAC;UACpE,IAAI,CAAC,SAAS,CAAC,KAAK,mCAAQ,cAAc,CAAC,SAAS,CAAC,KAAK,GAAK,IAAI,CAAC,SAAS,CAAC,KAAK,CAAE,CAAC;UACtF,IAAI,CAAC,MAAM,mCAAQ,cAAc,CAAC,MAAM,GAAK,IAAI,CAAC,MAAM,CAAE,CAAC;UAC3D,IAAI,CAAC,MAAM,CAAC,KAAK,mCAAQ,cAAc,CAAC,MAAM,CAAC,KAAK,GAAK,IAAI,CAAC,MAAM,CAAC,KAAK,CAAE,CAAC;UAE7E,MAAM,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,CAAC;UACzD,KAAK,CAAC,MAAM,CAAC,mCAAmC,EAAE,WAAW;cAC3D,OAAO,SAAS,0BAA0B,CAAC,KAAK,EAAE,IAAI;kBACpD,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAA,GAAG,KAAK,GAAG,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC;kBAClD,OAAO,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;eAClC,CAAC;WACH,CAAC,CAAC;UAEH,MAAM,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,sBAAsB,CAAC,CAAC;UAC7D,KAAK,CAAC,MAAM,CAAC,oCAAoC,EAAE,YAAY;cAC7D,OAAO,SAAS,2BAA2B,CAAC,KAAK,EAAE,IAAI;kBACrD,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAA,GAAG,KAAK,GAAG,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;kBACpD,OAAO,YAAY,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;eACnC,CAAC;WACH,CAAC,CAAC;UAEH,OAAO,SAAS,OAAO;cACrB,KAAK,CAAC,OAAO,EAAE,CAAC;cAChB,OAAO,CAAC,OAAO,EAAE,CAAC;WACnB,CAAC;OACH,CAAC;EACJ,CAAC;;;;;;;;"}