"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function t(t,e){return t(e={exports:{}},e.exports),e.exports}t((function(t,e){t.exports=function(){var t=["bubbles","cancelable","view","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],e=[!1,!1,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0];function i(i,n){n=n||Object.create(null);var s=document.createEvent("Event");s.initEvent(i,n.bubbles||!1,n.cancelable||!1);for(var o,r=2;r<t.length;r++)s[o=t[r]]=n[o]||e[r];s.buttons=n.buttons||0;var a=0;return a=void 0!==n.pressure&&s.buttons?n.pressure:s.buttons?.5:0,s.x=s.clientX,s.y=s.clientY,s.pointerId=n.pointerId||0,s.width=n.width||1,s.height=n.height||1,s.pressure=a,s.tiltX=n.tiltX||0,s.tiltY=n.tiltY||0,s.twist=n.twist||0,s.tangentialPressure=n.tangentialPressure||0,s.pointerType=n.pointerType||"",s.hwTimestamp=n.hwTimestamp||0,s.isPrimary=n.isPrimary||!1,s.detail=0,s}var n=window.Map&&window.Map.prototype.forEach?Map:s;function s(){this.array=[],this.size=0}s.prototype={set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach((function(i,n){t.call(e,i,n,this)}),this)}};var o=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],r=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],a={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},l="undefined"!=typeof SVGElementInstance,c={pointermap:new n,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var i=e,n=i.events;n&&(n.forEach((function(t){i[t]&&(this.eventMap[t]=i[t].bind(i))}),this),this.eventSources[t]=i,this.eventSourceList.push(i))},register:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,i=this.eventMap&&this.eventMap[e];i&&i(t),t._handledByPE=!0}},listen:function(t,e){e.forEach((function(e){this.addEvent(t,e)}),this)},unlisten:function(t,e){e.forEach((function(e){this.removeEvent(t,e)}),this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=new i(t,e);return e.preventDefault&&(n.preventDefault=e.preventDefault),n._target=n._target||e.target,n},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},cloneEvent:function(t){for(var e,i=Object.create(null),n=0;n<o.length;n++)i[e=o[n]]=t[e]||r[n],!l||"target"!==e&&"relatedTarget"!==e||i[e]instanceof SVGElementInstance&&(i[e]=i[e].correspondingUseElement);return t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in a?void 0:e:t._target},propagate:function(t,e,i){for(var n=t.target,s=[];null!=n&&n!==document&&!n.contains(t.relatedTarget);)if(s.push(n),!(n=n.parentNode))return;i&&s.reverse(),s.forEach((function(i){t.target=i,e.call(this,t)}),this)},setCapture:function(t,e,n){this.captureInfo[t]&&this.releaseCapture(t,n),this.captureInfo[t]=e,this.implicitRelease=this.releaseCapture.bind(this,t,n),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var s=new i("gotpointercapture",{bubbles:!0});s.pointerId=t,s._target=e,n||this.asyncDispatchEvent(s)},releaseCapture:function(t,e){var n=this.captureInfo[t];if(n){this.captureInfo[t]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var s=new i("lostpointercapture",{bubbles:!0});s.pointerId=t,s._target=n,e||this.asyncDispatchEvent(s)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};c.boundHandler=c.eventHandler.bind(c);var h={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var i=t.querySelector("shadow");i&&(e=i.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],i=this.shadow(t);i;)e.push(i),i=this.olderShadow(i);return e},searchRoot:function(t,e,i){if(t){var n,s,o=t.elementFromPoint(e,i);for(s=this.targetingShadow(o);s;){if(n=s.elementFromPoint(e,i)){var r=this.targetingShadow(n);return this.searchRoot(r,e,i)||n}s=this.olderShadow(s)}return o}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,i=t.clientY,n=this.owner(t.target);return n.elementFromPoint(e,i)||(n=document),this.searchRoot(n,e,i)}},d=Array.prototype.forEach.call.bind(Array.prototype.forEach),u=Array.prototype.map.call.bind(Array.prototype.map),p=Array.prototype.slice.call.bind(Array.prototype.slice),f=Array.prototype.filter.call.bind(Array.prototype.filter),m=window.MutationObserver||window.WebKitMutationObserver,g={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};function v(t,e,i,n){this.addCallback=t.bind(n),this.removeCallback=e.bind(n),this.changedCallback=i.bind(n),m&&(this.observer=new m(this.mutationWatcher.bind(this)))}function b(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}v.prototype={watchSubtree:function(t){this.observer&&h.canTarget(t)&&this.observer.observe(t,g)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){d(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(p(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=u(t,this.findElements,this);return e.push(f(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var y=[{selector:'[touch-action="none"]',value:"none"},{selector:'[touch-action="auto"]',value:"auto"},{selector:'[touch-action~="pan-x"]',value:"pan-x"},{selector:'[touch-action~="pan-y"]',value:"pan-y"},{selector:'[touch-action~="pan-up"]',value:"pan-up"},{selector:'[touch-action~="pan-down"]',value:"pan-down"},{selector:'[touch-action~="pan-left"]',value:"pan-left"},{selector:'[touch-action~="pan-right"]',value:"pan-right"}],w="",$=window.PointerEvent||window.MSPointerEvent,x=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,P=c.pointermap,D=[1,4,2,8,16],_=!1;try{_=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var T,S={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout"],register:function(t){c.listen(t,this.events)},unregister:function(t){c.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,n=t.clientX,s=t.clientY,o=0,r=i.length;o<r&&(e=i[o]);o++){var a=Math.abs(n-e.x),l=Math.abs(s-e.y);if(a<=25&&l<=25)return!0}},prepareEvent:function(t){var e=c.cloneEvent(t),i=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),i()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,"webkitForce"in t&&(e.pressure=t.webkitForce-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN),e},prepareButtonsForMove:function(t,e){var i=P.get(this.POINTER_ID);0!==e.which&&i?t.buttons=i.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=P.get(this.POINTER_ID),i=this.prepareEvent(t);_||(i.buttons=D[i.button],e&&(i.buttons|=e.buttons),t.buttons=i.buttons),P.set(this.POINTER_ID,t),e&&0!==e.buttons?c.move(i):c.down(i)}},webkitmouseforcechanged:function(t){this.mousemove(t)},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_||this.prepareButtonsForMove(e,t),e.button=-1,P.set(this.POINTER_ID,t),c.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=P.get(this.POINTER_ID),i=this.prepareEvent(t);if(!_){var n=D[i.button];i.buttons=e?e.buttons&~n:0,t.buttons=i.buttons}P.set(this.POINTER_ID,t),i.buttons&=~D[i.button],0===i.buttons?c.up(i):c.move(i)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_||this.prepareButtonsForMove(e,t),e.button=-1,P.set(this.POINTER_ID,t),c.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_||this.prepareButtonsForMove(e,t),e.button=-1,c.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);c.cancel(e),this.deactivateMouse()},deactivateMouse:function(){P.delete(this.POINTER_ID)}},M=c.captureInfo,C=h.findTarget.bind(h),O=h.allShadows.bind(h),E=c.pointermap,I={events:["touchstart","touchmove","touchforcechange","touchend","touchcancel"],register:function(t){T.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute("touch-action"),i=this.touchActionToScrollType(e);"number"==typeof i&&(t._scrollType=i,c.listen(t,this.events),O(t).forEach((function(t){t._scrollType=i,c.listen(t,this.events)}),this))},elementRemoved:function(t){if(E.size>0){var e=this.events;t.addEventListener("touchend",(function(){t._scrollType=void 0,c.unlisten(t,e)}))}else t._scrollType=void 0,c.unlisten(t,this.events);O(t).forEach((function(t){t._scrollType=void 0,c.unlisten(t,this.events)}),this)},elementChanged:function(t,e){var i=t.getAttribute("touch-action"),n=this.touchActionToScrollType(i),s=this.touchActionToScrollType(e);"number"==typeof n&&"number"==typeof s?(t._scrollType=n,O(t).forEach((function(t){t._scrollType=n}),this)):"number"==typeof s?this.elementRemoved(t):"number"==typeof n&&this.elementAdded(t)},scrollTypes:{UP:function(t){return t.includes("pan-y")||t.includes("pan-up")?1:0},DOWN:function(t){return t.includes("pan-y")||t.includes("pan-down")?2:0},LEFT:function(t){return t.includes("pan-x")||t.includes("pan-left")?4:0},RIGHT:function(t){return t.includes("pan-x")||t.includes("pan-right")?8:0}},touchActionToScrollType:function(t){if(t){if("auto"===t)return 15;if("none"===t)return 0;var e=t.split(" "),i=this.scrollTypes;return i.UP(e)|i.DOWN(e)|i.LEFT(e)|i.RIGHT(e)}},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===E.size||1===E.size&&E.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1)},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t&&"touchforcechange"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,i=c.cloneEvent(t),n=i.pointerId=t.identifier+2;if(i.target=M[n]||C(i),i.bubbles=!0,i.cancelable=!0,i.button=0,i.buttons=this.typeToButtons(e.type),i.width=2*(t.radiusX||t.webkitRadiusX||0),i.height=2*(t.radiusY||t.webkitRadiusY||0),i.pressure=void 0!==t.force?t.force:void 0!==t.webkitForce?t.webkitForce:void 0,i.isPrimary=this.isPrimaryTouch(t),t.altitudeAngle){const e=Math.tan(t.altitudeAngle),n=180/Math.PI;i.tiltX=Math.atan(Math.cos(t.azimuthAngle)/e)*n,i.tiltY=Math.atan(Math.sin(t.azimuthAngle)/e)*n}else i.tiltX=0,i.tiltY=0;"stylus"===t.touchType?i.pointerType="pen":i.pointerType=this.POINTER_TYPE,i.altKey=e.altKey,i.ctrlKey=e.ctrlKey,i.metaKey=e.metaKey,i.shiftKey=e.shiftKey;var s=this;return i.preventDefault=function(){s.scrolling=!1,s.firstXY=null,e.preventDefault()},i},processTouches:function(t,e){var i=t.changedTouches;this.currentTouchEvent=t;for(var n,s=0;s<i.length;s++)n=i[s],e.call(this,this.touchToPointer(n))},shouldScroll:function(t){if(this.firstXY){var e,i=t.currentTarget._scrollType;if(0===i)e=!1;else if(15===i)e=!0;else{var n=t.changedTouches[0],s=n.clientY-this.firstXY.Y,o=Math.abs(s),r=n.clientX-this.firstXY.X,a=Math.abs(r),l=1&i,c=2&i,h=4&i,d=8&i;h&&d?e=a>o:h?e=a>o&&r>0:d&&(e=a>o&&r<0),e||(l&&c?e=a<o:l?e=a<o&&s>0:c&&(e=a<o&&s<0))}return this.firstXY=null,e}},findTouch:function(t,e){for(var i,n=0,s=t.length;n<s&&(i=t[n]);n++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(E.size>=e.length){var i=[];E.forEach((function(t,n){if(1!==n&&!this.findTouch(e,n-2)){var s=t.out;i.push(s)}}),this),i.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||this.processTouches(t,this.overDown)},overDown:function(t){E.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),c.enterOver(t),c.down(t)},touchforcechange:function(t){this.touchmove(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,i=E.get(e.pointerId);if(i){var n=i.out,s=i.outTarget;c.move(e),n&&s!==e.target&&(n.relatedTarget=e.target,e.relatedTarget=s,n.target=s,e.target?(c.leaveOut(n),c.enterOver(e)):(e.target=s,e.relatedTarget=null,this.cancelOut(e))),i.out=e,i.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(c.up(t),c.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){c.cancel(t),c.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){E.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=S.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch(i)){var n={x:i.clientX,y:i.clientY};e.push(n);var s=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,n);setTimeout(s,2500)}}};T=new v(I.elementAdded,I.elementRemoved,I.elementChanged,I);var A,R,L,N=c.pointermap,z=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,Y={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){c.listen(t,this.events)},unregister:function(t){c.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return z&&((e=c.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){N.delete(t)},MSPointerDown:function(t){N.set(t.pointerId,t);var e=this.prepareEvent(t);c.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);c.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);c.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);c.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);c.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);c.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=c.makeEvent("lostpointercapture",t);c.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=c.makeEvent("gotpointercapture",t);c.dispatchEvent(e)}};function G(t){if(!c.pointermap.has(t)){var e=new Error("NotFoundError");throw e.name="NotFoundError",e}}function H(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var i=new Error("InvalidStateError");throw i.name="InvalidStateError",i}}function V(t){return 0!==c.pointermap.get(t).buttons}return window.navigator.msPointerEnabled?(A=function(t){G(t),H(this),V(t)&&(c.setCapture(t,this,!0),this.msSetPointerCapture(t))},R=function(t){G(t),c.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(A=function(t){G(t),H(this),V(t)&&c.setCapture(t,this)},R=function(t){G(t),c.releaseCapture(t)}),L=function(t){return!!c.captureInfo[t]},function(){if($){y.forEach((function(t){w+=t.selector+b(t.value)+"\n",x&&(w+=function(t){return"body /shadow-deep/ "+t}(t.selector)+b(t.value)+"\n")}));var t=document.createElement("style");t.textContent=w,document.head.appendChild(t)}}(),function(){if(!window.PointerEvent){if(window.PointerEvent=i,window.navigator.msPointerEnabled){var t=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:t,enumerable:!0}),c.registerSource("ms",Y)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),c.registerSource("mouse",S),void 0!==window.ontouchstart&&c.registerSource("touch",I);c.register(document)}}(),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:A},releasePointerCapture:{value:R},hasPointerCapture:{value:L}}),{dispatcher:c,Installer:v,PointerEvent:i,PointerMap:n,targetFinding:h}}()}));const e=t=>(...e)=>{const i=t(...e);return i.isDirective=!0,i};class i{constructor(){this.isDirective=!0,this.isClass=!0}body(t){}}const n=t=>null!=t&&"boolean"==typeof t.isDirective,s="undefined"!=typeof window&&(null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback),o=(t,e,i=null,n=null)=>{for(;e!==i;){const i=e.nextSibling;t.insertBefore(e,n),e=i}},r=(t,e,i=null)=>{for(;e!==i;){const i=e.nextSibling;t.removeChild(e),e=i}},a={},l={},c=`{{lit-${String(Math.random()).slice(2)}}}`,h=`\x3c!--${c}--\x3e`,d=new RegExp(`${c}|${h}`);class u{constructor(t,e){this.parts=[],this.element=e;const i=[],n=[],s=document.createTreeWalker(e.content,133,null,!1);let o=0,r=-1,a=0;const{strings:l,values:{length:h}}=t;for(;a<h;){const t=s.nextNode();if(null!==t){if(r++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:i}=e;let n=0;for(let t=0;t<i;t++)p(e[t].name,"$lit$")&&n++;for(;n-- >0;){const e=l[a],i=v.exec(e)[2],n=i.toLowerCase()+"$lit$",s=t.getAttribute(n);t.removeAttribute(n);const o=s.split(d);this.parts.push({type:"attribute",index:r,name:i,strings:o,sanitizer:void 0}),a+=o.length-1}}"TEMPLATE"===t.tagName&&(n.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(c)>=0){const n=t.parentNode,s=e.split(d),o=s.length-1;for(let e=0;e<o;e++){let i,o=s[e];if(""===o)i=g();else{const t=v.exec(o);null!==t&&p(t[2],"$lit$")&&(o=o.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),i=document.createTextNode(o)}n.insertBefore(i,t),this.parts.push({type:"node",index:++r})}""===s[o]?(n.insertBefore(g(),t),i.push(t)):t.data=s[o],a+=o}}else if(8===t.nodeType)if(t.data===c){const e=t.parentNode;null!==t.previousSibling&&r!==o||(r++,e.insertBefore(g(),t)),o=r,this.parts.push({type:"node",index:r}),null===t.nextSibling?t.data="":(i.push(t),r--),a++}else{let e=-1;for(;-1!==(e=t.data.indexOf(c,e+1));)this.parts.push({type:"node",index:-1}),a++}}else s.currentNode=n.pop()}for(const t of i)t.parentNode.removeChild(t)}}const p=(t,e)=>{const i=t.length-e.length;return i>=0&&t.slice(i)===e},f=t=>-1!==t.index,m=document.createComment(""),g=()=>m.cloneNode(),v=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;class b{constructor(t,e,i){this.__parts=[],this.template=t,this.processor=e,this.options=i}update(t){let e=0;for(const i of this.__parts)void 0!==i&&i.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=s?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),e=[],i=this.template.parts,n=document.createTreeWalker(t,133,null,!1);let o,r=0,a=0,l=n.nextNode();for(;r<i.length;)if(o=i[r],f(o)){for(;a<o.index;)a++,"TEMPLATE"===l.nodeName&&(e.push(l),n.currentNode=l.content),null===(l=n.nextNode())&&(n.currentNode=e.pop(),l=n.nextNode());if("node"===o.type){const t=this.processor.handleTextExpression(this.options,o);t.insertAfterNode(l.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(l,o.name,o.strings,this.options,o));r++}else this.__parts.push(void 0),r++;return s&&(document.adoptNode(t),customElements.upgrade(t)),t}}let y;const w=` ${c} `,$=document.createElement("template");class x{constructor(t,e,i,n){this.strings=t,this.values=e,this.type=i,this.processor=n}getHTML(){const t=this.strings.length-1;let e="",i=!1;for(let n=0;n<t;n++){const t=this.strings[n],s=t.lastIndexOf("\x3c!--");i=(s>-1||i)&&-1===t.indexOf("--\x3e",s+1);const o=v.exec(t);e+=null===o?t+(i?w:h):t.substr(0,o.index)+o[1]+o[2]+"$lit$"+o[3]+c}return e+=this.strings[t],e}getTemplateElement(){const t=$.cloneNode();return t.innerHTML=function(t){const e=window,i=e.trustedTypes||e.TrustedTypes;return i&&!y&&(y=i.createPolicy("lit-html",{createHTML:t=>t})),y?y.createHTML(t):t}(this.getHTML()),t}}class P extends x{getHTML(){return`<svg>${super.getHTML()}</svg>`}getTemplateElement(){const t=super.getTemplateElement(),e=t.content,i=e.firstChild;return e.removeChild(i),o(e,i.firstChild),t}}const D=t=>null===t||!("object"==typeof t||"function"==typeof t),_=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]),T=t=>t,S=(t,e,i)=>T;let M=S;const C=document.createTextNode("");class O{constructor(t,e,i,n,s="attribute"){this.dirty=!0,this.element=t,this.name=e,this.strings=i,this.parts=[];let o=n&&n.sanitizer;void 0===o&&(o=M(t,e,s),void 0!==n&&(n.sanitizer=o)),this.sanitizer=o;for(let t=0;t<i.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new E(this)}_getValue(){const t=this.strings,e=this.parts,i=t.length-1;if(1===i&&""===t[0]&&""===t[1]&&void 0!==e[0]){const t=e[0].value;if(!_(t))return t}let n="";for(let s=0;s<i;s++){n+=t[s];const i=e[s];if(void 0!==i){const t=i.value;if(D(t)||!_(t))n+="string"==typeof t?t:String(t);else for(const e of t)n+="string"==typeof e?e:String(e)}}return n+=t[i],n}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),"symbol"==typeof t&&(t=String(t)),this.element.setAttribute(this.name,t)}}}class E{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===a||D(t)&&t===this.value||(this.value=t,n(t)||(this.committer.dirty=!0))}commit(){for(;n(this.value);){const t=this.value;this.value=a,t.isClass?t.body(this):t(this)}this.value!==a&&this.committer.commit()}}class I{constructor(t,e){this.value=void 0,this.__pendingValue=void 0,this.textSanitizer=void 0,this.options=t,this.templatePart=e}appendInto(t){this.startNode=t.appendChild(g()),this.endNode=t.appendChild(g())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=g()),t.__insert(this.endNode=g())}insertAfterPart(t){t.__insert(this.startNode=g()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a,t.isClass?t.body(this):t(this)}const t=this.__pendingValue;t!==a&&(D(t)?t!==this.value&&this.__commitText(t):t instanceof x?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):_(t)?this.__commitIterable(t):t===l?(this.value=l,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling;if(t=null==t?"":t,e===this.endNode.previousSibling&&3===e.nodeType){void 0===this.textSanitizer&&(this.textSanitizer=M(e,"data","property"));const i=this.textSanitizer(t);e.data="string"==typeof i?i:String(i)}else{const e=C.cloneNode();this.__commitNode(e),void 0===this.textSanitizer&&(this.textSanitizer=M(e,"data","property"));const i=this.textSanitizer(t);e.data="string"==typeof i?i:String(i)}this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof b&&this.value.template===e)this.value.update(t.values);else{const i=this.endNode.parentNode;if(M!==S&&"STYLE"===i.nodeName||"SCRIPT"===i.nodeName)return void this.__commitText("/* lit-html will not write TemplateResults to scripts and styles */");const n=new b(e,t.processor,this.options),s=n._clone();n.update(t.values),this.__commitNode(s),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let i,n=0;for(const s of t)i=e[n],void 0===i&&(i=new I(this.options,this.templatePart),e.push(i),0===n?i.appendIntoPart(this):i.insertAfterPart(e[n-1])),i.setValue(s),i.commit(),n++;n<e.length&&(e.length=n,this.clear(i&&i.endNode))}clear(t=this.startNode){r(this.startNode.parentNode,t.nextSibling,this.endNode)}}class A{constructor(t,e,i){if(this.value=void 0,this.__pendingValue=void 0,2!==i.length||""!==i[0]||""!==i[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=i}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a,t.isClass?t.body(this):t(this)}if(this.__pendingValue===a)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=a}}class R extends O{constructor(t,e,i,n){super(t,e,i,n,"property"),this.single=2===i.length&&""===i[0]&&""===i[1]}_createPart(){return new L(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){if(this.dirty){this.dirty=!1;let t=this._getValue();t=this.sanitizer(t),this.element[this.name]=t}}}class L extends E{}let N=!1;(()=>{try{const t={get capture(){return N=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class z{constructor(t,e,i){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=i,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;n(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=a,t.isClass?t.body(this):t(this)}if(this.__pendingValue===a)return;const t=this.__pendingValue,e=this.value,i=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),s=null!=t&&(null==e||i);i&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),s&&(this.__options=Y(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=a}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const Y=t=>t&&(N?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);class G{handleAttributeExpressions(t,e,i,n,s){const o=e[0];if("."===o){return new R(t,e.slice(1),i,s).parts}return"@"===o?[new z(t,e.slice(1),n.eventContext)]:"?"===o?[new A(t,e.slice(1),i)]:new O(t,e,i,s).parts}handleTextExpression(t,e){return new I(t,e)}}const H=new G;function V(t){let e=k.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},k.set(t.type,e));let i=e.stringsArray.get(t.strings);if(void 0!==i)return i;const n=t.strings.join(c);return i=e.keyString.get(n),void 0===i&&(i=new u(t,t.getTemplateElement()),e.keyString.set(n,i)),e.stringsArray.set(t.strings,i),i}const k=new Map,W=new WeakMap,j=(t,e,i)=>{let n=W.get(e);void 0===n&&(r(e,e.firstChild),W.set(e,n=new I(Object.assign({templateFactory:V},i),void 0)),n.appendInto(e)),n.setValue(t),n.commit()};"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.1.7");const F=(t,...e)=>new x(t,e,"html",H),X=(t,...e)=>new P(t,e,"svg",H);var U=Object.freeze({__proto__:null,html:F,svg:X,DefaultTemplateProcessor:G,defaultTemplateProcessor:H,directive:e,Directive:i,isDirective:n,removeNodes:r,reparentNodes:o,noChange:a,nothing:l,AttributeCommitter:O,AttributePart:E,BooleanAttributePart:A,EventPart:z,isIterable:_,isPrimitive:D,NodePart:I,PropertyCommitter:R,PropertyPart:L,get sanitizerFactory(){return M},setSanitizerFactory:t=>{if(M!==S)throw new Error("Attempted to overwrite existing lit-html security policy. setSanitizeDOMValueFactory should be called at most once.");M=t},parts:W,render:j,templateCaches:k,templateFactory:V,TemplateInstance:b,SVGTemplateResult:P,TemplateResult:x,createMarker:g,isTemplatePartActive:f,Template:u}),B=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise((function(n,s){(function(t,e,i,n){Promise.resolve(n).then((function(e){t({value:e,done:i})}),e)})(n,s,(e=t[i](e)).done,e.value)}))}}};const q=e((t,e)=>async i=>{var n,s;if(!(i instanceof I))throw new Error("asyncAppend can only be used in text bindings");if(t===i.value)return;let o;i.value=t;let r=0;try{for(var a,l=B(t);!(a=await l.next()).done;){let n=a.value;if(i.value!==t)break;0===r&&i.clear(),void 0!==e&&(n=e(n,r));let s=i.startNode;void 0!==o&&(s=g(),o.endNode=s,i.endNode.parentNode.insertBefore(s,i.endNode)),o=new I(i.options,i.templatePart),o.insertAfterNode(s),o.setValue(n),o.commit(),r++}}catch(t){n={error:t}}finally{try{a&&!a.done&&(s=l.return)&&await s.call(l)}finally{if(n)throw n.error}}});var Q=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise((function(n,s){(function(t,e,i,n){Promise.resolve(n).then((function(e){t({value:e,done:i})}),e)})(n,s,(e=t[i](e)).done,e.value)}))}}};const K=e((t,e)=>async i=>{var n,s;if(!(i instanceof I))throw new Error("asyncReplace can only be used in text bindings");if(t===i.value)return;const o=new I(i.options,i.templatePart);i.value=t;let r=0;try{for(var a,l=Q(t);!(a=await l.next()).done;){let n=a.value;if(i.value!==t)break;0===r&&(i.clear(),o.appendIntoPart(i)),void 0!==e&&(n=e(n,r)),o.setValue(n),o.commit(),r++}}catch(t){n={error:t}}finally{try{a&&!a.done&&(s=l.return)&&await s.call(l)}finally{if(n)throw n.error}}}),J=new WeakMap,Z=e(t=>e=>{if(!(e instanceof I))throw new Error("cache can only be used in text bindings");let i=J.get(e);void 0===i&&(i=new WeakMap,J.set(e,i));const n=e.value;if(n instanceof b){if(t instanceof x&&n.template===e.options.templateFactory(t))return void e.setValue(t);{let t=i.get(n.template);void 0===t&&(t={instance:n,nodes:document.createDocumentFragment()},i.set(n.template,t)),o(t.nodes,e.startNode.nextSibling,e.endNode)}}if(t instanceof x){const n=e.options.templateFactory(t),s=i.get(n);void 0!==s&&(e.setValue(s.nodes),e.commit(),e.value=s.instance)}e.setValue(t)}),tt=new WeakMap,et=e(t=>e=>{if(!(e instanceof E)||e instanceof L||"class"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:i}=e,{element:n}=i;let s=tt.get(e);void 0===s&&(n.className=i.strings.join(" "),tt.set(e,s=new Set));const{classList:o}=n;s.forEach(e=>{e in t||(o.remove(e),s.delete(e))});for(const e in t){const i=t[e];i!=s.has(e)&&(i?(o.add(e),s.add(e)):(o.remove(e),s.delete(e)))}}),it=new WeakMap,nt=e((t,e)=>i=>{const n=it.get(i);if(Array.isArray(t)){if(Array.isArray(n)&&n.length===t.length&&t.every((t,e)=>t===n[e]))return}else if(n===t&&(void 0!==t||it.has(i)))return;i.setValue(e()),it.set(i,Array.isArray(t)?Array.from(t):t)}),st=e(t=>e=>{if(void 0===t&&e instanceof E){if(t!==e.value){const t=e.committer.name;e.committer.element.removeAttribute(t)}}else e.setValue(t)}),ot=(t,e)=>{const i=t.startNode.parentNode,n=null==e?t.endNode:e.startNode,s=i.insertBefore(g(),n);i.insertBefore(g(),n);const o=new I(t.options,void 0);return o.insertAfterNode(s),o},rt=(t,e)=>(t.setValue(e),t.commit(),t),at=(t,e,i)=>{const n=t.startNode.parentNode,s=i?i.startNode:t.endNode,r=e.endNode.nextSibling;r!==s&&o(n,e.startNode,r,s)},lt=t=>{r(t.startNode.parentNode,t.startNode,t.endNode.nextSibling)},ct=(t,e,i)=>{const n=new Map;for(let s=e;s<=i;s++)n.set(t[s],s);return n},ht=new WeakMap,dt=new WeakMap,ut=e((t,e,i)=>{let n;return void 0===i?i=e:void 0!==e&&(n=e),e=>{if(!(e instanceof I))throw new Error("repeat can only be used in text bindings");const s=ht.get(e)||[],o=dt.get(e)||[],r=[],a=[],l=[];let c,h,d=0;for(const e of t)l[d]=n?n(e,d):d,a[d]=i(e,d),d++;let u=0,p=s.length-1,f=0,m=a.length-1;for(;u<=p&&f<=m;)if(null===s[u])u++;else if(null===s[p])p--;else if(o[u]===l[f])r[f]=rt(s[u],a[f]),u++,f++;else if(o[p]===l[m])r[m]=rt(s[p],a[m]),p--,m--;else if(o[u]===l[m])r[m]=rt(s[u],a[m]),at(e,s[u],r[m+1]),u++,m--;else if(o[p]===l[f])r[f]=rt(s[p],a[f]),at(e,s[p],s[u]),p--,f++;else if(void 0===c&&(c=ct(l,f,m),h=ct(o,u,p)),c.has(o[u]))if(c.has(o[p])){const t=h.get(l[f]),i=void 0!==t?s[t]:null;if(null===i){const t=ot(e,s[u]);rt(t,a[f]),r[f]=t}else r[f]=rt(i,a[f]),at(e,i,s[u]),s[t]=null;f++}else lt(s[p]),p--;else lt(s[u]),u++;for(;f<=m;){const t=ot(e,r[m+1]);rt(t,a[f]),r[f++]=t}for(;u<=p;){const t=s[u++];null!==t&&lt(t)}ht.set(e,r),dt.set(e,l)}}),pt=new WeakMap,ft=document.createElement("template"),mt=e(t=>e=>{if(!(e instanceof I))throw new Error("unsafeHTML can only be used in text bindings");const i=pt.get(e);if(void 0!==i&&D(t)&&t===i.value&&e.value===i.fragment)return;const n=ft.cloneNode();n.innerHTML=t;const s=document.importNode(n.content,!0);e.setValue(s),pt.set(e,{value:t,fragment:s})}),gt=new WeakMap,vt=e((...t)=>e=>{let i=gt.get(e);void 0===i&&(i={lastRenderedIndex:2147483647,values:[]},gt.set(e,i));const n=i.values;let s=n.length;i.values=t;for(let o=0;o<t.length&&!(o>i.lastRenderedIndex);o++){const r=t[o];if(D(r)||"function"!=typeof r.then){e.setValue(r),i.lastRenderedIndex=o;break}o<s&&r===n[o]||(i.lastRenderedIndex=2147483647,s=0,Promise.resolve(r).then(t=>{const n=i.values.indexOf(r);n>-1&&n<i.lastRenderedIndex&&(i.lastRenderedIndex=n,e.setValue(t),e.commit())}))}}),bt=new WeakMap;class yt extends i{constructor(t){super(),this.ifFn=t}body(t){const e=this.ifFn(),i=t.committer.element;if(e)bt.has(t)||bt.set(t,{element:i,nextSibling:i.nextSibling,previousSibling:i.previousSibling,parent:i.parentNode}),i.remove();else{const e=bt.get(t);e&&(e.nextSibling&&e.nextSibling.parentNode?e.nextSibling.parentNode.insertBefore(e.element,e.nextSibling):e.previousSibling&&e.previousSibling.parentNode?e.previousSibling.parentNode.appendChild(e.element):e.parent&&e.parent.appendChild(e.element),bt.delete(t))}}}class wt extends i{constructor(t,e=!1){super(),this.toRemove=[],this.toUpdate=[],this.debug=!1,this.previous={},this.style=t,this.detach=e}setStyle(t){this.style=t}setDebug(t=!0){this.debug=t}setDetach(t){this.detach=t}body(t){this.toRemove.length=0,this.toUpdate.length=0;const e=t.committer.element,i=e.style;let n=this.previous;if(e.attributes.getNamedItem("style")){const t=e.attributes.getNamedItem("style").value.split(";").map(t=>t.substr(0,t.indexOf(":")).trim()).filter(t=>!!t);for(const e of t)void 0===this.style[e]&&(this.toRemove.includes(e)||this.toRemove.push(e))}for(const t in n)this.style.hasOwnProperty(t)&&void 0===this.style[t]&&(this.toRemove.includes(t)||this.toRemove.push(t));for(const t in this.style){if(!this.style.hasOwnProperty(t))continue;const e=this.style[t],i=n[t];void 0!==i&&i===e||this.toUpdate.push(t)}if(this.debug&&(console.log("[StyleMap] to remove",[...this.toRemove]),console.log("[StyleMap] to update",[...this.toUpdate])),this.toRemove.length||this.toUpdate.length){let t,n;this.detach&&(t=e.parentNode,t&&(n=e.nextSibling,e.remove()));for(const t of this.toRemove)i.removeProperty(t),i[t]&&delete i[t];for(const t of this.toUpdate){const e=this.style[t];t.includes("-")?i.setProperty(t,e):i[t]=e}this.detach&&t&&t.insertBefore(e,n),this.previous=Object.assign({},this.style)}}}class $t{constructor(){this.isAction=!0}}$t.prototype.isAction=!0;const xt={element:document.createTextNode(""),axis:"xy",threshold:10,onDown(t){},onMove(t){},onUp(t){},onWheel(t){}},Pt="undefined"!=typeof PointerEvent;let Dt=0;class _t extends $t{constructor(t,e){super(),this.moving="",this.initialX=0,this.initialY=0,this.lastY=0,this.lastX=0,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onWheel=this.onWheel.bind(this),this.element=t,this.id=++Dt,this.options=Object.assign(Object.assign({},xt),e.pointerOptions),Pt?(t.addEventListener("pointerdown",this.onPointerDown),document.addEventListener("pointermove",this.onPointerMove),document.addEventListener("pointerup",this.onPointerUp)):(t.addEventListener("touchstart",this.onPointerDown),document.addEventListener("touchmove",this.onPointerMove,{passive:!1}),document.addEventListener("touchend",this.onPointerUp),document.addEventListener("touchcancel",this.onPointerUp),t.addEventListener("mousedown",this.onPointerDown),document.addEventListener("mousemove",this.onPointerMove,{passive:!1}),document.addEventListener("mouseup",this.onPointerUp))}normalizeMouseWheelEvent(t){let e=t.deltaX||0,i=t.deltaY||0,n=t.deltaZ||0;const s=t.deltaMode,o=parseInt(getComputedStyle(t.target).getPropertyValue("line-height"));let r=1;switch(s){case 1:r=o;break;case 2:r=window.height}return e*=r,i*=r,n*=r,{x:e,y:i,z:n,event:t}}onWheel(t){const e=this.normalizeMouseWheelEvent(t);this.options.onWheel(e)}normalizePointerEvent(t){let e={x:0,y:0,pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0,event:t};switch(t.type){case"wheel":const i=this.normalizeMouseWheelEvent(t);e.x=i.x,e.y=i.y,e.pageX=e.x,e.pageY=e.y,e.screenX=e.x,e.screenY=e.y,e.clientX=e.x,e.clientY=e.y;break;case"touchstart":case"touchmove":case"touchend":case"touchcancel":e.x=t.changedTouches[0].screenX,e.y=t.changedTouches[0].screenY,e.pageX=t.changedTouches[0].pageX,e.pageY=t.changedTouches[0].pageY,e.screenX=t.changedTouches[0].screenX,e.screenY=t.changedTouches[0].screenY,e.clientX=t.changedTouches[0].clientX,e.clientY=t.changedTouches[0].clientY;break;default:e.x=t.x,e.y=t.y,e.pageX=t.pageX,e.pageY=t.pageY,e.screenX=t.screenX,e.screenY=t.screenY,e.clientX=t.clientX,e.clientY=t.clientY}return e}onPointerDown(t){if("mousedown"===t.type&&0!==t.button)return;this.moving="xy";const e=this.normalizePointerEvent(t);this.lastX=e.x,this.lastY=e.y,this.initialX=e.x,this.initialY=e.y,this.options.onDown(e)}handleX(t){let e=t.x-this.lastX;return this.lastY=t.y,this.lastX=t.x,e}handleY(t){let e=t.y-this.lastY;return this.lastY=t.y,this.lastX=t.x,e}onPointerMove(t){if(""===this.moving||"mousemove"===t.type&&0!==t.button)return;const e=this.normalizePointerEvent(t);if("x|y"===this.options.axis){let i=0,n=0;("x"===this.moving||"xy"===this.moving&&Math.abs(e.x-this.initialX)>this.options.threshold)&&(this.moving="x",i=this.handleX(e)),("y"===this.moving||"xy"===this.moving&&Math.abs(e.y-this.initialY)>this.options.threshold)&&(this.moving="y",n=this.handleY(e)),this.options.onMove({movementX:i,movementY:n,x:e.x,y:e.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}else if("xy"===this.options.axis){let i=0,n=0;Math.abs(e.x-this.initialX)>this.options.threshold&&(i=this.handleX(e)),Math.abs(e.y-this.initialY)>this.options.threshold&&(n=this.handleY(e)),this.options.onMove({movementX:i,movementY:n,x:e.x,y:e.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}else if("x"===this.options.axis)("x"===this.moving||"xy"===this.moving&&Math.abs(e.x-this.initialX)>this.options.threshold)&&(this.moving="x",this.options.onMove({movementX:this.handleX(e),movementY:0,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t}));else if("y"===this.options.axis){let i=0;("y"===this.moving||"xy"===this.moving&&Math.abs(e.y-this.initialY)>this.options.threshold)&&(this.moving="y",i=this.handleY(e)),this.options.onMove({movementX:0,movementY:i,x:e.x,y:e.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t})}}onPointerUp(t){this.moving="";const e=this.normalizePointerEvent(t);this.options.onUp({movementX:0,movementY:0,x:e.x,y:e.y,initialX:this.initialX,initialY:this.initialY,lastX:this.lastX,lastY:this.lastY,event:t}),this.lastY=0,this.lastX=0}destroy(t){Pt?(t.removeEventListener("pointerdown",this.onPointerDown),document.removeEventListener("pointermove",this.onPointerMove),document.removeEventListener("pointerup",this.onPointerUp)):(t.removeEventListener("mousedown",this.onPointerDown),document.removeEventListener("mousemove",this.onPointerMove),document.removeEventListener("mouseup",this.onPointerUp),t.removeEventListener("touchstart",this.onPointerDown),document.removeEventListener("touchmove",this.onPointerMove),document.removeEventListener("touchend",this.onPointerUp),document.removeEventListener("touchcancel",this.onPointerUp))}}function Tt(t){let e=0;return function(i){e||(e=requestAnimationFrame((function(){e=0,t.apply(void 0,[i])})))}}function St(t){return t&&"object"==typeof t&&t.constructor&&"Object"===t.constructor.name}function Mt(t,...e){const i=e.shift();if(St(t)&&St(i))for(const e in i)if(St(i[e]))"function"==typeof i[e].clone?t[e]=i[e].clone():(void 0===t[e]&&(t[e]={}),t[e]=Mt(t[e],i[e]));else if(Array.isArray(i[e])){t[e]=new Array(i[e].length);let n=0;for(let s of i[e])St(s)?"function"==typeof s.clone?t[e][n]=s.clone():t[e][n]=Mt({},s):t[e][n]=s,n++}else t[e]=i[e];return e.length?Mt(t,...e):t}function Ct(t){if(void 0!==t.actions){const e=t.actions.map(t=>{const e=Object.assign({},t),i=Object.assign({},e.props);return delete i.state,delete i.api,delete e.element,e.props=i,e});t.actions=e}return Mt({},t)}var Ot={mergeDeep:Mt,clone:Ct,schedule:Tt};class Et{constructor(t,e){this.slotInstances={},this.destroyed=!1,this.vido=t,this.props=e,this.destroy=this.destroy.bind(this),this.change=this.change.bind(this),this.html=this.html.bind(this),this.getInstances=this.getInstances.bind(this),this.setComponents=this.setComponents.bind(this),this.vido.onDestroy(()=>{this.destroy()})}setComponents(t){if(t&&!this.destroyed){for(const e in t){const i=t[e];void 0===this.slotInstances[e]&&(this.slotInstances[e]=[]);for(const t of this.slotInstances[e])t.destroy();this.slotInstances[e].length=0;for(const t of i)this.slotInstances[e].push(this.vido.createComponent(t,this.props))}this.vido.update()}}destroy(){if(!this.destroyed){for(const t in this.slotInstances){for(const e of this.slotInstances[t])e.destroy();this.slotInstances[t].length=0}this.destroyed=!0}}change(t,e){if(!this.destroyed)for(const i in this.slotInstances){const n=this.slotInstances[i];for(const i of n)i.change(t,e)}}getInstances(t){if(!this.destroyed)return void 0===t?this.slotInstances:this.slotInstances[t]}html(t,e){if(!this.destroyed)return this.slotInstances[t].map(t=>t.html(e))}getProps(){return this.props}isDestroyed(){return this.destroyed}}function It(t,n){let s=0;const o=new Map;let r,a,l=new Map,c=0;const h=[],d=Promise.resolve(),u={},p=function(t){return class extends i{constructor(t){super(),this.instance=t}set(t,e){return this.actions=t,this.props=e,this}body(e){const i=e.committer.element;for(const e of this.actions)if(void 0!==e){let n;if(t.has(this.instance))for(const s of t.get(this.instance))if(s.componentAction.create===e&&s.element===i){n=s;break}if(n)n.props=this.props;else{void 0!==i.vido&&delete i.vido;const n={create:e,update(){},destroy(){}},s={instance:this.instance,componentAction:n,element:i,props:this.props};let o=[];t.has(this.instance)&&(o=t.get(this.instance)),o.push(s),t.set(this.instance,o)}}}}}(l);class f{constructor(t){this.instance=t}create(t,e){const i=new p(this.instance);return i.set(t,e),i}}const m=function(t,e,i){return class{constructor(t,e,i={}){this.destroyed=!1,this.instance=t,this.name=e.name,this.vidoInstance=e,this.props=i,this.destroy=this.destroy.bind(this),this.update=this.update.bind(this),this.change=this.change.bind(this),this.html=this.html.bind(this)}destroy(){this.destroyed||(this.vidoInstance.debug&&(console.groupCollapsed(`destroying component ${this.instance}`),console.log(i({components:t.keys(),actionsByInstance:e})),console.trace(),console.groupEnd()),this.vidoInstance.destroyComponent(this.instance,this.vidoInstance),this.destroyed=!0)}update(n){return this.vidoInstance.debug&&(console.groupCollapsed(`updating component ${this.instance}`),console.log(i({components:t.keys(),actionsByInstance:e})),console.trace(),console.groupEnd()),this.vidoInstance.updateTemplate(n)}change(n,s){this.vidoInstance.debug&&(console.groupCollapsed(`changing component ${this.instance}`),console.log(i({props:this.props,newProps:n,components:t.keys(),actionsByInstance:e})),console.trace(),console.groupEnd());const o=t.get(this.instance);o&&o.change(n,s)}html(e={}){const i=t.get(this.instance);if(i&&!i.destroyed)return i.update(e,this.vidoInstance)}_getComponents(){return t}_getActions(){return e}}}(o,l,Ct),g=function(t,e,i){return class{constructor(t,e,i,n){this.destroyed=!1,this.instance=t,this.vidoInstance=e,this.renderFunction=i,this.content=n,this.destroy=this.destroy.bind(this),this.update=this.update.bind(this),this.change=this.change.bind(this)}destroy(){if(!this.destroyed){this.vidoInstance.debug&&(console.groupCollapsed(`component destroy method fired ${this.instance}`),console.log(i({props:this.vidoInstance.props,components:t.keys(),destroyable:this.vidoInstance.destroyable,actionsByInstance:e})),console.trace(),console.groupEnd()),this.content&&"function"==typeof this.content.destroy&&this.content.destroy();for(const t of this.vidoInstance.destroyable)t();this.vidoInstance.onChangeFunctions.length=0,this.vidoInstance.destroyable.length=0,this.vidoInstance.destroyed=!0,this.destroyed=!0,this.vidoInstance.update()}}update(n={}){return this.vidoInstance.debug&&(console.groupCollapsed(`component update method fired ${this.instance}`),console.log(i({components:t.keys(),actionsByInstance:e})),console.trace(),console.groupEnd()),this.renderFunction(n)}change(n,s={leave:!1}){const o=n;this.vidoInstance.debug&&(console.groupCollapsed(`component change method fired ${this.instance}`),console.log(i({props:o,components:t.keys(),onChangeFunctions:this.vidoInstance.onChangeFunctions,changedProps:n,actionsByInstance:e})),console.trace(),console.groupEnd());for(const t of this.vidoInstance.onChangeFunctions)t(n,s)}}}(o,l,Ct);class v{constructor(){this.destroyable=[],this.destroyed=!1,this.onChangeFunctions=[],this.debug=!1,this.state=t,this.api=n,this.lastProps={},this.html=F,this.svg=X,this.directive=e,this.asyncAppend=q,this.asyncReplace=K,this.cache=Z,this.classMap=et,this.guard=nt,this.ifDefined=st,this.repeat=ut,this.unsafeHTML=mt,this.until=vt,this.schedule=Tt,this.actionsByInstance=(t,e)=>{},this.StyleMap=wt,this.Detach=yt,this.PointerAction=_t,this.Action=$t,this.Slots=Et,this._components=o,this._actions=l,this.reuseComponents=this.reuseComponents.bind(this),this.onDestroy=this.onDestroy.bind(this),this.onChange=this.onChange.bind(this),this.update=this.update.bind(this),this.destroyComponent=this.destroyComponent.bind(this);for(const t in u)this[t]=u[t].bind(this)}static addMethod(t,e){u[t]=e}onDestroy(t){this.destroyable.push(t)}onChange(t){this.onChangeFunctions.push(t)}update(t){return this.updateTemplate(t)}reuseComponents(t,e,i,n,s=!0,o=!1){const r=[],a=t.length,l=e.length;let c=!1;!s||void 0!==e&&0!==e.length||(c=!0);let h=0;if(a<l){let s=l-a;for(;s;){const o=e[l-s],a=this.createComponent(n,i(o));t.push(a),r.push(a),s--}}else if(a>l){let e=a-l;for(s&&(c=!0,h=a-e);e;){const i=a-e;s||(r.push(t[i]),t[i].destroy()),e--}s||(t.length=l)}let d=0;o&&console.log("modified components",r),o&&console.log("current components",t),o&&console.log("data array",e);for(const n of t){const t=e[d];o&&console.log(`reuse components data at '${d}'`,t),n&&!r.includes(n)&&(o&&console.log("getProps fn result",i(t)),n.change(i(t),{leave:c&&d>=h})),d++}}createComponent(t,e={},i=null){const n=t.name+":"+s++;let r;r=new v,r.instance=n,r.destroyed=!1,r.name=t.name,r.Actions=new f(n);const a=new m(n,r,e),c=new g(n,r,t(r,e,i),i);return o.set(n,c),o.get(n).change(e),r.debug&&(console.groupCollapsed(`component created ${n}`),console.log(Ct({props:e,components:o.keys(),actionsByInstance:l})),console.trace(),console.groupEnd()),a}destroyComponent(t,e){if(e.debug&&(console.groupCollapsed(`destroying component ${t}...`),console.log(Ct({components:o.keys(),actionsByInstance:l})),console.trace(),console.groupEnd()),l.has(t))for(const e of l.get(t))"function"==typeof e.componentAction.destroy&&e.componentAction.destroy(e.element,e.props);l.delete(t);const i=o.get(t);i?(i.destroy(),o.delete(t),e.debug&&(console.groupCollapsed(`component destroyed ${t}`),console.log(Ct({components:o.keys(),actionsByInstance:l})),console.trace(),console.groupEnd())):console.warn(`No component to destroy! [${t}]`)}executeActions(){for(const t of l.values()){for(const e of t)if(void 0===e.element.vido){const t=o.get(e.instance);e.isActive=function(){return t&&!1===t.destroyed};const i=e.componentAction,n=i.create;if(void 0!==n){let t;t=n.prototype&&(n.prototype.isAction||n.prototype.update||n.prototype.destroy)||n.isAction?new n(e.element,e.props):n(e.element,e.props),void 0!==t&&("function"==typeof t?i.destroy=t:("function"==typeof t.update&&(i.update=t.update.bind(t)),"function"==typeof t.destroy&&(i.destroy=t.destroy.bind(t))))}}else e.element.vido=e.props,"function"==typeof e.componentAction.update&&e.isActive()&&e.componentAction.update(e.element,e.props);for(const e of t)e.element.vido=e.props}}updateTemplate(t){return t&&h.push(t),new Promise(t=>{const e=++c,i=this;d.then((function(){if(e===c){c=0,i.render();for(const t of h)t();h.length=0,t()}}))})}createApp(t){a=t.element;const e=this.createComponent(t.component,t.props);return r=e.instance,this.render(),e}render(){const t=o.get(r);t?(j(t.update(),a),this.executeActions()):a&&a.remove()}}return new v}function At(t,e,i,n){return new(i||(i=Promise))((function(s,o){function r(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,a)}l((n=n.apply(t,e||[])).next())}))}It.prototype.lithtml=U,It.prototype.Action=$t,It.prototype.Directive=i,It.prototype.schedule=Tt,It.prototype.Detach=yt,It.prototype.StyleMap=wt,It.prototype.PointerAction=_t,It.prototype.asyncAppend=q,It.prototype.asyncReplace=K,It.prototype.cache=Z,It.prototype.classMap=et,It.prototype.guard=nt,It.prototype.ifDefined=st,It.prototype.repeat=ut,It.prototype.unsafeHTML=mt,It.prototype.until=vt,It.prototype.Slots=Et;var Rt=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var i=-1;return t.some((function(t,n){return t[0]===e&&(i=n,!0)})),i}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var i=t(this.__entries__,e),n=this.__entries__[i];return n&&n[1]},e.prototype.set=function(e,i){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=i:this.__entries__.push([e,i])},e.prototype.delete=function(e){var i=this.__entries__,n=t(i,e);~n&&i.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var i=0,n=this.__entries__;i<n.length;i++){var s=n[i];t.call(e,s[1],s[0])}},e}()}(),Lt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Nt="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),zt="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Nt):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var Yt=["top","right","bottom","left","width","height","size","weight"],Gt="undefined"!=typeof MutationObserver,Ht=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var i=!1,n=!1,s=0;function o(){i&&(i=!1,t()),n&&a()}function r(){zt(o)}function a(){var t=Date.now();if(i){if(t-s<2)return;n=!0}else i=!0,n=!1,setTimeout(r,e);s=t}return a}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,i=e.indexOf(t);~i&&e.splice(i,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Lt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Gt?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Lt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,i=void 0===e?"":e;Yt.some((function(t){return!!~i.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),Vt=function(t,e){for(var i=0,n=Object.keys(e);i<n.length;i++){var s=n[i];Object.defineProperty(t,s,{value:e[s],enumerable:!1,writable:!1,configurable:!0})}return t},kt=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Nt},Wt=qt(0,0,0,0);function jt(t){return parseFloat(t)||0}function Ft(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return e.reduce((function(e,i){return e+jt(t["border-"+i+"-width"])}),0)}function Xt(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return Wt;var n=kt(t).getComputedStyle(t),s=function(t){for(var e={},i=0,n=["top","right","bottom","left"];i<n.length;i++){var s=n[i],o=t["padding-"+s];e[s]=jt(o)}return e}(n),o=s.left+s.right,r=s.top+s.bottom,a=jt(n.width),l=jt(n.height);if("border-box"===n.boxSizing&&(Math.round(a+o)!==e&&(a-=Ft(n,"left","right")+o),Math.round(l+r)!==i&&(l-=Ft(n,"top","bottom")+r)),!function(t){return t===kt(t).document.documentElement}(t)){var c=Math.round(a+o)-e,h=Math.round(l+r)-i;1!==Math.abs(c)&&(a-=c),1!==Math.abs(h)&&(l-=h)}return qt(s.left,s.top,a,l)}var Ut="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof kt(t).SVGGraphicsElement}:function(t){return t instanceof kt(t).SVGElement&&"function"==typeof t.getBBox};function Bt(t){return Lt?Ut(t)?function(t){var e=t.getBBox();return qt(0,0,e.width,e.height)}(t):Xt(t):Wt}function qt(t,e,i,n){return{x:t,y:e,width:i,height:n}}var Qt=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=qt(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=Bt(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Kt=function(t,e){var i,n,s,o,r,a,l,c=(n=(i=e).x,s=i.y,o=i.width,r=i.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),Vt(l,{x:n,y:s,width:o,height:r,top:s,right:n+o,bottom:r+s,left:n}),l);Vt(this,{target:t,contentRect:c})},Jt=function(){function t(t,e,i){if(this.activeObservations_=[],this.observations_=new Rt,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=i}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof kt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Qt(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof kt(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Kt(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Zt="undefined"!=typeof WeakMap?new WeakMap:new Rt,te=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=Ht.getInstance(),n=new Jt(e,i,this);Zt.set(this,n)};["observe","unobserve","disconnect"].forEach((function(t){te.prototype[t]=function(){var e;return(e=Zt.get(this))[t].apply(e,arguments)}}));var ee=void 0!==Nt.ResizeObserver?Nt.ResizeObserver:te;function ie(t,e={}){const{api:i,state:n,onDestroy:s,Actions:o,update:r,createComponent:a,html:l,StyleMap:c}=t,h=i.name;let d;s(n.subscribe("config.debug",t=>d=t));const u=[];function p(){u.forEach(t=>t()),u.length=0}s(n.subscribe("config.plugins",e=>{if(d&&console.log("Plugins changed. Destroying plugins..."),p(),d&&console.log("Plugins destroyed. Initializing plugins..."),void 0!==e&&Array.isArray(e))for(const i of e){const e=i(t);"function"==typeof e?u.push(e):e&&Object.prototype.hasOwnProperty.call(e,"destroy")&&u.push(e.destroy)}d&&console.log("Plugins intialized.")})),s(p);const f=[];let m,g;f.push(n.subscribe("config.components.List",t=>m=t)),f.push(n.subscribe("config.components.Chart",t=>g=t));const v=a(m);s(()=>{v&&v.destroy()});const b=a(g);let y,w;s(()=>{b&&b.destroy()}),s(()=>{f.forEach(t=>t())}),s(n.subscribe("config.wrappers.Main",t=>y=t)),s(n.subscribe("config.actions.main",t=>w=t));const $=new c({});let x=!1,P=-1,D=!0;s(n.subscribe("config.useLast",t=>D=t));let _=i.getClass(h);function T(){const t=n.get("$data.list.rowsWithParentsExpanded"),e=n.get("$data.list.rowsHeight");if(e===P)return;P=e;const s=n.get("$data.innerHeight"),o=function(t,e){if(0===e.length)return 0;let s=0,o=0;const r=i.getAllRows();for(let i=e.length-1;i>=0;i--){const n=r[e[i]];if(s+=n.$data.outerHeight,s>=t){s-=n.$data.outerHeight;break}o++}return d&&console.log("Last page height.",{lastPageCount:o,lastPageSize:s,rows:r}),n.multi().update("config.scroll.vertical.lastPageSize",s,{force:!0}).update("config.scroll.vertical.lastPageCount",o,{force:!0}).done(),s}(s,t);d&&console.log("Calculate height related things.",{rowsWithParentsExpanded:t,lastRowsHeight:P,innerHeight:s}),n.multi().update("config.scroll.vertical.area",e,{force:!0}).update("config.scroll.vertical.areaWithoutLastPage",e-o,{force:!0}).done()}function S(){n.update("config.scroll",t=>(t.horizontal.dataIndex=0,t.horizontal.data=null,t.horizontal.posPx=0,t.vertical.dataIndex=0,t.vertical.data=Object.values(n.get("config.list.rows"))[0],t.vertical.posPx=0,t))}function M(){d&&console.log("Minimal reload fired.",{}),function(){const t=i.getVisibleRows(n.get("$data.list.rowsWithParentsExpanded")),e=n.get("$data.list.visibleRows")||[];let s=!0;t.length!==e.length?s=!0:t.length&&(s=t.join(",")!==e.join(",")),d&&console.log("Generating visible rows and items #1.",{visibleRowsId:t,shouldUpdate:s}),s&&(d&&console.log("Saving visible rows and items #2.",{visibleRowsId:t,shouldUpdate:s}),n.update("$data.list.visibleRows",t));const o=[],a=i.getAllRows();for(const e of t){const t=a[e];for(const e of t.$data.items)o.push(e)}const l=n.get("$data.chart.visibleItems")||[];d&&console.log("Generating visible rows and items #3.",{visibleItemsId:o,visibleRowsId:t,shouldUpdate:s,rows:a}),o.join(",")!==l.join(",")&&(d&&console.log("Generate visible rows and items #4.",{visibleItemsId:o,currentVisibleItems:l}),n.update("$data.chart.visibleItems",o)),r()}(),function(){const t=n.get("$data.list.rowsWithParentsExpanded"),e=i.recalculateRowsHeightsAndFixOverlappingItems(t);n.update("$data.list.rowsHeight",e),d&&console.log("calculateRowsHeight.",{rowsHeight:e})}(),T(),function(){const t=n.get("$data.list.rowsWithParentsExpanded");i.recalculateRowsPercents(t,n.get("config.scroll.vertical.area"))}(),function(){const t=n.get("config.scroll.vertical.offset")||0,e=n.get("$data.list.visibleRows");let s=0;const o=i.getAllRows();for(const t of e)s+=i.recalculateRowHeight(o[t]);d&&console.log("Calculate visible rows height.",{height:s,rows:o,visibleRows:e}),n.update("$data.list.visibleRowsHeight",s+t)}(),H().done()}function C(t=null,e=null){if(!e||!e.options.data||"updateVisibleItems"!==e.options.data)return D?void n.last(M):M()}function O(){d&&console.log("Partial reload fired.",{}),function(){d&&console.log("Generating tree.");const t=n.get("config.list.rows");i.fillEmptyRowValues(t);const e=n.get("config.chart.items");i.prepareItems(e),n.update("$data.treeMap",i.makeTreeMap(t,e)),r()}(),function(){const t=i.getAllRows();if(!t)return;const e=i.getRowsWithParentsExpanded(t);n.update("$data.list.rowsWithParentsExpanded",e)}(),C()}function E(){Promise.resolve().then(()=>{const t=n.get("$data.elements.main"),e=t.parentNode,i=new Event("gstc-loaded");t.dispatchEvent(i),e.dispatchEvent(i)})}function I(){d&&console.log("Full reload fired.",{}),O(),V({name:"reload"})}function A(e,n,s,o){const r=e.period;let a=n.from,l=i.time.date(a).startOf(r);const c=i.time.date(n.to).endOf(r),h=i.time.generatePeriodDates({leftDate:l,rightDate:c,level:s,levelIndex:o,period:r,time:n,callOnDate:!1,callOnLevelDates:!0}),d=i.getClass("chart-calendar-date");for(const i of h)i.formatted=e.format({timeStart:i.leftGlobalDate,timeEnd:i.rightGlobalDate,vido:t,className:d,props:{date:i}});return h}function R(t,e){if(!t.zoom)return t;for(const i of e){const e=i.formats.find(e=>+t.zoom<=+e.zoomTo);e&&i.main&&(t.period=e.period)}return t}function L(t,e){const i=function(t,e){if(0===e.length)return 0;let i=0,s=0;for(let n=e.length-1;n>=0;n--){const o=e[n];if(i+=o.width,i>=t){i-=o.width;break}s++}return n.update("config.scroll.horizontal",t=>(t.lastPageSize=i,t.lastPageCount=s,t)),i}(e,t);let s=0;for(const e of t)s+=e.width;const o=s-i;for(const e of t)e.leftPercent=e.leftPx/o,e.rightPercent=e.rightPx/o;return o}function N(t,e,i){if(!t.zoom)return 0;t.allDates=new Array(e.length);const n=e[t.level],s=n.formats.find(e=>+t.zoom<=+e.zoomTo);t.allDates[t.level]=A(s,t,n,t.level);let o=0;for(const i of e){if(!i.main){const e=i.formats.find(e=>+t.zoom<=+e.zoomTo);t.allDates[o]=A(e,t,i,o)}o++}return L(t.allDates[t.level],i)}function z(t,e){if(!t.length)return[];const n=t.filter(t=>t.leftGlobal>=e.leftGlobal&&t.leftGlobal<=e.rightGlobal||t.rightGlobal>=e.leftGlobal&&t.rightGlobal<=e.rightGlobal||t.leftGlobal<=e.leftGlobal&&t.rightGlobal>=e.rightGlobal||t.leftGlobal>=e.leftGlobal&&t.rightGlobal<=e.rightGlobal);if(!n.length)return[];let s=0;n[0].period!==e.period&&e.leftGlobal>n[0].leftGlobal&&(s=i.time.getDatesDiffPx(e.leftGlobalDate,n[0].leftGlobalDate,e,!1));let o=0;const r=n.length-1;return n.map((t,i)=>(t.currentView={leftPx:o,rightPx:t.rightPx,width:t.width},s<0&&(t.currentView.width=t.width+s,t.currentView.leftPx=0,s=0),t.currentView.rightPx=t.currentView.leftPx+t.currentView.width,o+=t.currentView.width,i===r&&t.currentView.rightPx>e.width&&(t.currentView.rightPx=e.width,t.currentView.width=t.currentView.rightPx-t.currentView.leftPx),t))}function Y(t){let e=0,i=0;for(const n of t.allDates[t.level])e+=n.width,i+=n.rightGlobal-n.leftGlobal;t.totalViewDurationPx=e,t.totalViewDurationMs=i}function G(t,e,n){const s=i.time.findDateAtTime(t,n);if(!s)return t;let o=n.indexOf(s),r=s.leftGlobal,a=0;for(let t=n.length;o<t;o++){const t=n[o];if(r=t.leftGlobal,a+=t.width,a>=e)break}return r}function H(t=n.get("$data.chart.time"),e=n.multi()){d&&console.log("Updating visible items.",{});const s=n.get("$data.chart.visibleItems"),o=i.getItems(s);if(!o)return e;const r=i.getAllRows();if(!r)return e;if(!t.levels||!t.levels[t.level])return e;const a=n.get("config.chart.spacing")||0;for(const n of o){if(!n)return e;const s=r[n.rowId];if(!s||!s.$data)continue;const o=i.time.getViewOffsetPxFromDates(n.$data.time.startDate,!1,t),l=i.time.getViewOffsetPxFromDates(n.$data.time.endDate,!1,t),c=n.$data.position.top+n.gap.top,h=s.$data.position.viewTop+n.$data.position.actualTop;e=e.update(`config.chart.items.${n.id}.$data`,(function(e){if(d&&console.log("Update visble item",{$data:e,item:n}),e)return e.position.left=o,e.position.actualLeft=i.time.limitOffsetPxToView(o,t),e.position.right=l,e.position.actualRight=i.time.limitOffsetPxToView(l,t),e.width=l-o-a,e.actualWidth=e.position.actualRight-e.position.actualLeft-a,e.position.actualTop=c,e.position.viewTop=h,e}),{data:"updateVisibleItems"})}return d&&console.log("Visible items updated.",{visibleItemsId:s,visibleItems:o}),e}function V(t){d&&console.log("Recalculating times.",{});const e=n.get("$data.chart.dimensions.width");if(!e)return;const s=n.get("config.chart.time"),o=n.get("config.chart.calendar"),a=Object.assign({},n.get("$data.chart.time"));let l=i.mergeDeep({},s);if(!(l.from&&l.to||Object.keys(n.get("config.chart.items")).length))return;l.fromDate=i.time.date(l.from),l.toDate=i.time.date(l.to);const c=o.levels.find(t=>t.main);if(!c)throw new Error("Main calendar level not found (config.chart.calendar.levels).");const h=o.levels.indexOf(c);if(l.level=h,!l.calculatedZoomMode){if(l.period!==a.period){let t=c.formats.find(t=>t.period===l.period&&t.default);t&&(l.zoom=t.zoomTo)}R(l,o.levels)}let u=n.get("config.scroll.horizontal"),p=0;if(l.calculatedZoomMode&&e){if(l.totalViewDurationMs=i.time.date(l.to).diff(l.from,"millisecond"),l.timePerPixel=l.totalViewDurationMs/e,l.zoom=Math.log(l.timePerPixel)/Math.log(2),R(l,o.levels),a.zoom!==l.zoom||0===l.allDates.length||"forceUpdate"===t.name||"items"===t.name||"reload"===t.name){p=N(l,o.levels,e),Y(l);const t=l.allDates[l.level];l.to=t[t.length-1].rightGlobal,l.toDate=i.time.date(l.to)}l.leftGlobal=l.from,l.leftGlobalDate=i.time.date(l.leftGlobal),l.rightGlobal=l.to,l.rightGlobalDate=i.time.date(l.rightGlobal)}else if(l.timePerPixel=Math.pow(2,l.zoom),"items"===t.name&&(l.from=t.from,l.to=t.to,l.fromDate=i.time.date(l.from),l.toDate=i.time.date(l.to)),l=i.time.recalculateFromTo(l),a.zoom!==l.zoom||0===l.allDates.length||"forceUpdate"===t.name||"items"===t.name||"reload"===t.name){p=N(l,o.levels,e),Y(l);const t=l.allDates[l.level];l.to=t[t.length-1].rightGlobal,l.toDate=i.time.date(l.to)}else l.totalViewDurationPx=a.totalViewDurationPx,l.totalViewDurationMs=a.totalViewDurationMs;l.scrollWidth=p||a.scrollWidth;const f=l.allDates[h];let m=!1;const g=n.get("$data.chart.time.recalculateTimesLastReason")||"";if(!l.calculatedZoomMode)if(l.zoom===a.zoom&&"period"!==t.name||!a.centerGlobal){let t=u.data;t||(t=f[0]),l.leftGlobalDate=t.leftGlobalDate,l.leftGlobal=l.leftGlobalDate.valueOf(),l.rightGlobal=G(l.leftGlobal,e,f),l.rightGlobalDate=i.time.date(l.rightGlobal).endOf(l.period),l.rightGlobal=l.rightGlobal.valueOf(),m="zoom"!==g&&"period"!==g&&"time"!==g}else{const t=e*l.timePerPixel,n=Math.round(t/2),s=Math.ceil(a.centerGlobalDate.diff(a.centerGlobal+n,l.period,!0));l.leftGlobalDate=a.centerGlobalDate.add(s,l.period);const o=l.leftGlobalDate.valueOf();let r=i.time.findDateAtTime(o,f);r||(r=f[0]),l.leftGlobal=r.leftGlobal,l.leftGlobalDate=r.leftGlobalDate,l.rightGlobal=G(l.leftGlobal,e,f),l.rightGlobalDate=i.time.date(l.rightGlobal).endOf(l.period),l.rightGlobal=l.rightGlobalDate.valueOf()}!function(t,e){t.leftGlobal<t.from&&(t.leftGlobal=t.from),t.rightGlobal>t.to&&(t.rightGlobal=t.to),t.leftGlobalDate=i.time.date(t.leftGlobal).startOf(t.period),t.leftGlobal=t.leftGlobalDate.valueOf(),t.rightGlobalDate=i.time.date(t.rightGlobal).endOf(t.period),t.rightGlobal=t.rightGlobalDate.valueOf(),t.centerGlobal=e.centerGlobal,t.centerGlobalDate=e.centerGlobalDate}(l,a),l.leftInner=l.leftGlobal-l.from,l.rightInner=l.rightGlobal-l.from,l.leftPx=0,l.rightPx=e,l.width=e,function(t,e){t.levels=[];let i=0;for(const n of e){const e=n.formats.find(e=>+t.zoom<=+e.zoomTo);if(n.main&&(t.format=e,t.level=i),e){let s=z(t.allDates[i],t);t.onCurrentViewLevelDates.forEach(o=>{s=o({dates:s,format:e,time:t,level:n,levelIndex:i})}),t.levels.push(s)}i++}}(l,o.levels),m&&function(t){let e=Math.floor(t.rightGlobalDate.diff(t.leftGlobalDate,"millisecond",!0)/2);const n=i.time.getRightViewDate(t);n.width!==n.currentView.width&&(e-=(n.width-n.currentView.width)*t.timePerPixel),t.centerGlobalDate=t.leftGlobalDate.add(e,"millisecond"),t.centerGlobal=t.centerGlobalDate.valueOf()}(l);const v=l.levels[l.level];v&&v.length&&(l.leftPx=v[0].leftPx,l.rightPx=v[v.length-1].leftPx);let b=n.multi().update("$data.chart.time",l).update("config.chart.time",t=>(t.zoom=l.zoom,t.period=l.format.period,t.leftGlobal=l.leftGlobal,t.centerGlobal=l.centerGlobal,t.rightGlobal=l.rightGlobal,t.from=l.from,t.to=l.to,t.allDates=l.allDates,t.additionalSpaceAdded=l.additionalSpaceAdded,t));b=H(l,b),b=b.update("$data.chart.time.recalculateTimesLastReason",t.name),b.done(),d&&console.log("Time recalculated.",{time:l}),r("")}s(n.subscribeAll(["config.innerHeight","config.headerHeight","config.scroll.horizontal.size"],(function(){d&&console.log("Height change.",["config.innerHeight","config.headerHeight","config.scroll.horizontal.size"]);const t=n.get("config"),e=n.get("config.scroll.horizontal.size"),i=t.innerHeight-e;n.multi().update("$data.innerHeight",i).update("$data.height",t.innerHeight+t.headerHeight).done(),$.style["--height"]=i+"px",r()}))),s(n.subscribe("$data.list.columns.resizer.active",(function(t){x=t,_=i.getClass(i.name),x&&(_+=` ${i.name}__list-column-header-resizer--active`),r()}))),s(n.subscribeAll(["config.chart.items.*.time","config.chart.items.*.height","config.chart.items.*.top","config.list.rows.*.$data.outerHeight","config.chart.items.*.$data.position","config.scroll.vertical.offset","$data.innerHeight","$data.list.rowsHeight"],C,{bulk:!0})),s(n.subscribeAll(["config.list.rows.*.parentId","config.chart.items.*.rowId","config.list.rows.*.expanded"],O,{bulk:!0})),s(n.subscribeAll(["config.chart.items;","config.list.rows;"],(t,e)=>{if("config"!==e.path.update&&(I(),"config.list.rows"===e.path.update)){n.get("config.list.rows")[n.get("config.scroll.vertical").dataIndex]||S()}})),s(n.subscribe("config;",()=>{I(),S(),setTimeout(E,0)})),s(n.subscribe("config.chart.items",(t,e)=>{e.options.data&&"updateVisibleItems"===e.options.data||H().done()},{bulk:!0,ignore:["config.chart.items.*.$data.detached","config.chart.items.*.selected"]}));const k={initialized:!1,zoom:0,period:"",scrollDataIndex:0,chartWidth:0,from:0,to:0};s(n.subscribeAll(["config.chart.time","$data.chart.time","config.chart.calendar.levels","config.scroll.horizontal.dataIndex","$data.chart.dimensions.width"],()=>{let t=function(){const t=n.get("config.chart.time"),e=n.get("config.scroll.horizontal.dataIndex"),i=n.get("$data.chart.dimensions.width"),s=Object.assign({},k);return k.zoom=t.zoom,k.period=t.period,k.from=t.from,k.to=t.to,k.scrollDataIndex=e,k.chartWidth=i,k.initialized?!0===t.forceUpdate?(n.update("config.chart.time.forceUpdate",!1),{name:"forceUpdate"}):t.zoom!==s.zoom?{name:"zoom",oldValue:s.zoom,newValue:t.zoom}:t.period!==s.period?{name:"period",oldValue:s.period,newValue:t.period}:t.from!==s.from?{name:"from",oldValue:s.from,newValue:t.from}:t.to!==s.to?{name:"to",oldValue:s.to,newValue:t.to}:e!==s.scrollDataIndex?{name:"scroll",oldValue:s.scrollDataIndex,newValue:e}:i!==s.chartWidth?{name:"chartWidth",oldValue:s.chartWidth,newValue:i}:{name:""}:(k.initialized=!0,{name:"all"})}();t.name&&V(t)},{bulk:!0})),s(n.subscribe("config.chart.items.:itemId.time",(t,e)=>{const i=n.get("$data.chart.time"),s=n.get(`config.chart.items.${e.params.itemId}`);if(s&&(s.time.start<i.from||s.time.end>i.to)){let t=i.from,e=i.to;s.time.start<i.from&&(t=s.time.start),s.time.end>i.to&&(e=s.time.end),V({name:"items",from:t,to:e})}}));try{const t=["stackblitz.io","codepen.io","cdpn.io","codesandbox.io","csb.app","jsrun.pro","jsrun.top","jsfiddle.net","jsbin.com"];let e=location.host;const i=e.split(".");if(i.length>2){for(let t=0,e=i.length-2;t<e;t++)i.shift();e=i.join(".")}const s=["192.","127.","test","demo","local"],o=["test","local","demo"];!0===n.get("config.usageStatistics")&&!localStorage.getItem("gstcus")&&function(){return!t.includes(e)&&"localhost"!==location.hostname&&!function(){for(let t=0,e=s.length;t<e;t++)if(location.hostname.startsWith(s[t]))return!0;for(let t=0,e=o.length;t<e;t++)if(location.hostname.endsWith(o[t]))return!0;return!1}()}()&&(fetch("https://gstc-us.neuronet.io/",{method:"POST",mode:"cors",credentials:"omit",redirect:"follow",body:JSON.stringify({location:{href:location.href,host:location.host}})}).catch(t=>{}),localStorage.setItem("gstcus","true"))}catch(t){}const W={width:0,height:0};let j,F,X;class U{constructor(t){j||(j=new ee(()=>{const e=t.clientWidth,i=t.clientHeight;W.width===e&&W.height===i||(W.width=e,W.height=i,n.update("$data.dimensions",W))}),j.observe(t),n.update("$data.elements.main",t))}update(){}destroy(t){j.unobserve(t)}}function B(t){const e=i.normalizeMouseWheelEvent(t);if(t.shiftKey||e.x){const t=e.x?e.x:e.y,n=i.getScrollLeft();return void(t>0?i.setScrollLeft(n.dataIndex+F):i.setScrollLeft(n.dataIndex-F))}const n=i.getScrollTop();e.y>0?i.setScrollTop(n.dataIndex+X):i.setScrollTop(n.dataIndex-X)}w.includes(U)||w.push(U),s(()=>{j.disconnect()}),s(n.subscribe("config.scroll",t=>{F=t.horizontal.multiplier,X=t.vertical.multiplier}));const q=Object.assign(Object.assign({},e),{api:i,state:n}),Q=o.create(w,q),K=i.generateSlots("main",t,e);return s(K.destroy),i=>y(l`
        <div
          data-info-url="https://github.com/neuronetio/gantt-schedule-timeline-calendar"
          class=${_}
          style=${$}
          data-actions=${Q}
          @wheel=${B}
        >
          ${K.html("before",i)}${v.html()}${K.html("inside",i)}${b.html()}${K.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}function ne(t,e){const{onDestroy:i,state:n,api:s,html:o,StyleMap:r,Actions:a,update:l,schedule:c}=t;let h,d,u,p="",f="";i(n.subscribe("config.classNames",()=>{h=s.getClass("scroll-bar"),d=s.getClass("scroll-bar-inner")}));const m="horizontal"===e.type?"height":"width",g="height"===m?"width":"height",v="horizontal"===e.type?"left":"top",b=new r({}),y=new r({});let w=0,$=!1,x=[],P=[],D=0,_=0,T=0,S=0;function M(){return"vertical"===e.type?P.length?s.getRow(P[P.length-1]).$data.position.top+s.getRow(P[P.length-1]).$data.outerHeight:0:x.length?x[x.length-1].rightPx:0}"horizontal"===e.type&&i(n.subscribe("$data.chart.time",()=>{const t=n.get("$data.chart.time");if(t.leftGlobalDate&&(n.get("config.scroll.horizontal").area!==t.scrollWidth&&n.update("config.scroll.horizontal.area",t.scrollWidth),t.allDates&&t.allDates[t.level])){const e=t.allDates[t.level],i=e.find(e=>e.leftGlobal===t.leftGlobal);let o=e.indexOf(i);const r=n.get("config.scroll.horizontal.lastPageCount");o>e.length-r&&(o=e.length-r),s.setScrollLeft(o,t,void 0,"time")}}));const C={maxPosPx:0,innerSize:0,sub:0,scrollArea:0};i(n.subscribeAll("horizontal"===e.type?[`config.scroll.${e.type}`,"$data.chart.time"]:[`config.scroll.${e.type}`,"$data.innerHeight","$data.list.rowsWithParentsExpanded;","$data.list.rowsHeight"],(function(){const t=n.get("$data.chart.time"),i=n.get(`config.scroll.${e.type}`),s=n.get("$data.chart.dimensions.width"),o=n.get("$data.innerHeight");$=i.smooth,u=i.size,_="horizontal"===e.type?s:o,_=_||0,"horizontal"===e.type?_-=u:_+=u,_<0&&(_=0),b.style[m]=u+"px",b.style[g]=_+"px","vertical"===e.type&&(b.style.top=n.get("config.headerHeight")+"px"),y.style[m]="100%",T=_,"horizontal"===e.type?x=t.allDates&&t.allDates[t.level]?t.allDates[t.level]:[]:P=n.get("$data.list.rowsWithParentsExpanded")||[];const r=M();n.get(`config.scroll.${e.type}.lastPageSize`)&&(S=0,r<=T||i.lastPageSize===r?(T=0,D=0):(_&&r?D=_*(_/r):(D=0,T=0),D<i.minInnerSize&&(S=i.minInnerSize-D,D=i.minInnerSize)),y.style[g]=D+"px",w=Math.round(_-S),function(t,e,i,n){const s=C.maxPosPx!==t||C.innerSize!==e||C.sub!==i||C.scrollArea!==n;return s&&(C.maxPosPx=w,C.innerSize=e,C.sub=i,C.scrollArea=n),s}(w,D,S,_)&&n.update(`config.scroll.${e.type}`,t=>(t.maxPosPx=w,t.innerSize=D,t.sub=S,t.scrollArea=_,t)),l())})));let O=0;i(n.subscribe(`config.scroll.${e.type}.posPx`,t=>{t!==O&&(y.style[v]=t+"px",O=t,l())}));const E=s.getActions("scroll-bar");E.push(class extends $t{constructor(t){super(),n.update(`$data.elements.scroll-bar--${e.type}`,t)}update(){}destroy(){}});const I=a.create(E,{api:s,state:n,props:e}),A=[class extends $t{constructor(t){super(),this.moving=!1,this.initialPos=0,this.currentPos=0,this.cumulation=0,this.lastDataIndex=0,this.dataIndex=0,n.update(`$data.elements.scroll-bar-inner--${e.type}`,t),this.bodyClassName=n.get("config.scroll.bodyClassName"),this.pointerDown=this.pointerDown.bind(this),this.pointerUp=this.pointerUp.bind(this);const i=this.pointerMove.bind(this);this.pointerMove=c(t=>i(t)),this.unsub=n.subscribe(`config.scroll.${e.type}`,this.dataChanged.bind(this)),this.destroy=this.destroy.bind(this),t.addEventListener("pointerdown",this.pointerDown),document.addEventListener("pointermove",this.pointerMove,{passive:!0}),document.addEventListener("pointerup",this.pointerUp)}destroy(t){this.unsub(),t.removeEventListener("pointerdown",this.pointerDown),document.removeEventListener("pointermove",this.pointerMove),document.removeEventListener("pointerup",this.pointerUp)}dataChanged(){const t=n.get(`config.scroll.${e.type}`),i=t.dataIndex;if(this.lastDataIndex=i,"horizontal"===e.type&&x&&x.length){const t=x[i];if(!t)return;if(this.lastDate&&this.lastDate.leftPercent===t.leftPercent)return;const e=this.limitPosition(t.leftPercent*(_-S));this.currentPos=e,l()}else if("vertical"===e.type){const e=P[i],n=s.getRow(e);if(!n)return;if(this.lastRow&&this.lastRow.$data.position.topPercent===n.$data.position.topPercent)return;const o=Math.round(n.$data.position.topPercent*(_-S));this.currentPos=o+t.offset,l()}}limitPosition(t){return Math.max(Math.min(t,w),0)}pointerDown(t){t.preventDefault(),t.stopPropagation(),document.body.classList.add(this.bodyClassName),this.moving=!0,this.initialPos="horizontal"===e.type?t.screenX:t.screenY,f=" "+s.getClass("scroll-bar")+"-inner--active",p=" "+s.getClass("scroll-bar")+"--active",l()}pointerUp(t){this.moving&&(t.preventDefault(),t.stopPropagation(),document.body.classList.remove(this.bodyClassName)),this.moving=!1,this.cumulation=0,f="",p="",l()}pointerMove(t){if(this.moving){t.stopPropagation();const i="horizontal"===e.type?t.screenX:t.screenY,n=i-this.initialPos;this.cumulation+=n,this.currentPos=this.limitPosition(this.currentPos+n),this.initialPos=i;const o=this.currentPos/w;let r=0,a=0;if("horizontal"===e.type)for(let t=x.length;r<t;r++){if(x[r].leftPercent>=o)break}else{let t;for(let e=P.length;r<e&&(t=s.getRow(P[r]),!(t.$data.position.bottomPercent>=o));r++);if(r!==t.length-1&&$){const e=o-t.$data.position.topPercent;a=Math.floor(e*M())}}r||(r=0),this.dataIndex=r,"horizontal"===e.type?(this.lastDate=x[r],s.setScrollLeft(r,void 0,void 0,void 0)):(this.lastRow=s.getRow(P[r]),s.setScrollTop(r,a)),r!==this.lastDataIndex&&(this.cumulation=0),this.lastDataIndex=r}}}],R=a.create(A,{api:s,state:n,props:e}),L=s.generateSlots("scroll-bar",t,e);return()=>o`
      <div
        data-actions=${I}
        class=${h+" "+h+"--"+e.type+p}
        style=${b}
      >
        ${L.html("before")}
        <div
          data-actions=${R}
          class=${d+" "+d+"--"+e.type+f}
          style=${y}
        >
          ${L.html("inside")}
        </div>
        ${L.html("after")}
      </div>
    `}function se(t,e={}){const{api:i,state:n,onDestroy:s,Actions:o,update:r,reuseComponents:a,html:l,StyleMap:c,cache:h}=t,d=i.getActions("list");let u,p;s(n.subscribe("config.wrappers.List",t=>u=t));const f=n.subscribe("config.components.ListColumn",t=>p=t);!function(){const t=n.get("config.list.expander.icons"),e={};for(const n in t){const s=t[n];e[n]=i.getSVGIconSrc(s)}n.update("$data.list.expander.icons",e)}(),function(){const t={open:"",close:""},e=n.get("config.list.toggle.icons");for(const n in e){const s=e[n];t[n]=i.getSVGIconSrc(s)}n.update("$data.list.toggle.icons",t)}();const m=i.getClass("list");let g,v;s(n.subscribe("config.list",(function(){g=n.get("config.list"),v=g.columns.percent,r()})));let b=[];s(n.subscribe("config.list.columns.data",(function(t){a(b,Object.values(t),t=>({column:t}),p),r()})));const y=new c({height:"","--expander-padding-width":"","--expander-size":""});function w(){}let $;function x(t){$||($=t.clientWidth,0===v&&($=0),n.update("$data.list.width",$))}s(n.subscribeAll(["$data.height","config.list.expander"],()=>{const t=n.get("config.list.expander");y.style.height=n.get("$data.height")+"px",y.style["--expander-padding-width"]=t.padding+"px",y.style["--expander-size"]=t.size+"px",r()})),s(()=>{b.forEach(t=>t.destroy()),f()});d.push(class{constructor(t,e){e.state.update("$data.elements.list",t),x(t)}update(t){return x(t)}});const P=o.create(d,Object.assign(Object.assign({},e),{api:i,state:n})),D=i.generateSlots("list",t,e);return e=>u(h(g.columns.percent>0?l`
              <div class=${m} data-actions=${P} style=${y} @wheel=${w}>
                ${D.html("before",e)}${b.map(t=>t.html())}${D.html("after",e)}
              </div>
            `:""),{vido:t,props:{},templateProps:e})}class oe{constructor(t,e){let i=!1,n=e.state.get("$data.elements.list-columns");void 0===n&&(n=[],i=!0),n.includes(t)||(n.push(t),i=!0),i&&e.state.update("$data.elements.list-columns",n)}destroy(t,e){e.state.update("$data.elements.list-columns",e=>e.filter(e=>e!==t))}}function re(t,e){const{api:i,state:n,onDestroy:s,onChange:o,Actions:r,update:a,createComponent:l,reuseComponents:c,html:h,StyleMap:d}=t;let u;s(n.subscribe("config.wrappers.ListColumn",t=>u=t));const p=[];let f,m;p.push(n.subscribe("config.components.ListColumnRow",t=>f=t)),p.push(n.subscribe("config.components.ListColumnHeader",t=>m=t));const g=Object.assign(Object.assign({},e),{api:i,state:n}),v=i.getActions("list-column"),b=i.getActions("list-column-rows");let y,w,$,x;const P=new d({width:"","--width":""}),D=new d({width:"",height:""}),_=new d({"margin-top":"0px"});let T;function S(){const t=n.get("config.list");x=t.columns.data[e.column.id].width*t.columns.percent*.01,T=x;const i=n.get("$data.innerHeight");P.style.width=T+"px",P.style["--width"]=T+"px",D.style.height=i+"px"}s(n.subscribeAll(["config.list.columns.percent","config.list.columns.resizer.width","$data.chart.dimensions.width","$data.innerHeight","$data.list.width","$data.list.visibleRowsHeight"],S,{bulk:!0}));const M=l(m,e);s(M.destroy);const C=i.generateSlots("list-column",t,e),O=[];function E(){const t=n.get("$data.list.visibleRows")||[],s=i.getRows(t);c(O,s,t=>t&&{column:e.column,row:t,width:T},f,!1)}o(t=>{e=t,y=i.getClass("list-column",e.column.id),$=i.getClass("list-column-rows-offset",e.column.id),w=i.getClass("list-column-rows",e.column.id);for(const t in e)g[t]=e[t];S(),M.change(e),E(),C.change(t)}),s(n.subscribeAll(["$data.list.visibleRows;","$data.list.visibleRowsHeight","config.chart.items.*.height","config.chart.items.*.rowId","config.chart.items.*.time"],E)),s(n.subscribe("config.scroll.vertical.offset",t=>{_.style.transform=`translateY(-${t||0}px)`,a()})),s(()=>{O.forEach(t=>t.destroy()),p.forEach(t=>t())}),v.push(oe);const I=r.create(v,{column:e.column,state:n,api:i}),A=r.create(b,{api:i,state:n});return i=>u(h`
        <div class=${y} data-actions=${I} style=${P}>
          ${M.html()}
          <div class=${w} style=${D} data-actions=${A}>
            <div class=${$} style=${_}>
              ${C.html("before",i)}${O.map(t=>t.html())}${C.html("after",i)}
            </div>
          </div>
        </div>
      `,{vido:t,props:e,templateProps:i})}function ae(t,e){const{api:i,state:n,onDestroy:s,onChange:o,Actions:r,update:a,createComponent:l,html:c,cache:h,StyleMap:d}=t,u=Object.assign(Object.assign({},e),{api:i,state:n});let p;s(n.subscribe("config.wrappers.ListColumnHeader",t=>p=t));const f=i.getActions("list-column-header"),m=[];let g;m.push(n.subscribe("config.components.ListColumnHeaderResizer",t=>g=t));const v=l(g,e);let b;m.push(n.subscribe("config.components.ListColumnRowExpander",t=>b=t));const y=l(b,e);s(()=>{v.destroy(),y.destroy(),m.forEach(t=>t())});const w=i.generateSlots("list-column-header",t,e);let $,x;o(t=>{e=t,$=i.getClass("list-column-header",e.column.id),x=i.getClass("list-column-header-content",e.column.id);for(const t in e)u[t]=e[t];v.change(e),y.change(e),w.change(t)});const P=new d({height:"","--height":"","--paddings-count":""});s(n.subscribe("config.headerHeight",()=>{const t=n.get("config");P.style.height=t.headerHeight+"px",P.style["--height"]=t.headerHeight+"px",P.style["--paddings-count"]="1",a()}));const D=r.create(f,u);return i=>p(c`
        <div class=${$} style=${P} data-actions=${D}>
          ${w.html("before",i)}${h(e.column.expander?c`
      <div class=${x}>
        ${y.html()}${v.html(e.column)}
      </div>
    `:c`
      <div class=${x}>
        ${v.html(e.column)}
      </div>
    `)}${w.html("after",i)}
        </div>
      `,{vido:t,props:e,templateProps:i})}function le(t,e){const{api:i,state:n,onDestroy:s,update:o,html:r,Actions:a,onChange:l,PointerAction:c,cache:h,StyleMap:d,unsafeHTML:u}=t,p="list-column-header-resizer",f=i.getActions(p),m=i.getActions(p+"-dots");let g,v,b,y,w,$;s(n.subscribe("config.wrappers.ListColumnHeaderResizer",t=>g=t)),v=i.getClass(p),b=i.getClass(p+"-container"),y=i.getClass(p+"-dots"),w=i.getClass(p+"-dots-dot");const x=new d({width:""});let P=!1;const D=i.generateSlots(p,t,e);function _(){if(!e.column)return;v=i.getClass(p,e.column.id),b=i.getClass(p+"-container",e.column.id),y=i.getClass(p+"-dots",e.column.id),w=i.getClass(p+"-dots-dot",e.column.id);const t=n.get("config.list");$=e.column.width*t.columns.percent*.01,x.style["--width"]=t.columns.resizer.width+"px",P=t.columns.resizer.inRealTime,n.update("$data.list.width",$),D.change(e),o()}l(t=>{e=t,_()}),s(n.subscribeAll(["config.list.columns.percent","config.list.columns.resizer.width","config.list.columns.resizer.inRealTime"],_));let T=[1,2,3,4,5,6,7,8];s(n.subscribe("config.list.columns.resizer.dots",t=>{T=[];for(let e=0;e<t;e++)T.push(e);o()}));let S=$;const M={column:e.column,api:i,state:n,pointerOptions:{axis:"x",onMove:function({movementX:t}){let i=n.get("config.list.columns.minWidth");"number"==typeof e.column.minWidth&&(i=e.column.minWidth),S+=t,S<i&&(S=i),P&&n.update(`config.list.columns.data.${e.column.id}.width`,S)}}};f.push(c);const C=a.create(f,M),O=a.create(m,M);return i=>g(r`
        <div class=${v} data-actions=${C}>
          ${D.html("before",i)}
          <div class=${b}>
            ${h(e.column.header.html?u(e.column.header.html):e.column.header.content)}
          </div>
          ${D.html("inside",i)}
          <div class=${y} style=${x} data-actions=${O}>
            ${T.map(()=>r` <div class=${w} /> `)}
          </div>
          ${D.html("after",i)}
        </div>
      `,{vido:t,props:e,templateProps:i})}class ce{constructor(t,e){let i=e.state.get("$data.elements.list-column-rows"),n=!1;void 0===i&&(n=!0,i=[]),i.includes(t)||(i.push(t),n=!0),n&&e.state.update("$data.elements.list-column-rows",i)}destroy(t,e){e.state.update("$data.elements.list-column-rows",e=>e.filter(e=>e!==t))}}function he(t,e){const{api:i,state:n,onDestroy:s,Detach:o,Actions:r,update:a,html:l,createComponent:c,onChange:h,StyleMap:d,unsafeHTML:u}=t,p="list-column-row",f=Object.assign(Object.assign({},e),{api:i,state:n});let m=!1;const g=new o(()=>m);let v,b;s(n.subscribe("config.wrappers.ListColumnRow",t=>v=t)),s(n.subscribe("config.components.ListColumnRowExpander",t=>b=t));const y=new d(e.column.expander?{height:"",top:"","--height":"","--expander-padding-width":"","--expander-size":""}:{height:"",top:"","--height":""},!0),w=c(b,{row:e.row});let $=i.getClass(p),x=i.getClass(p+"-content"),P=i.getClass(p);const D=i.generateSlots(p,t,e);h((function(t,s){if(s.leave||!t||void 0===t.row||void 0===t.column)return m=!0,D.change(t,s),void a();m=!1,e=t;for(const t in e)f[t]=e[t];if(!e.column||!e.row||!e.row.$data)return m=!0,D.change(t,s),void a();if(void 0===e.column||void 0===e.row)return;const o=`${e.row.id}-${e.column.id}`;$=i.getClass(p,o),x=i.getClass(p+"-content",o),P=i.getClass(p);const r=n.get("config.list.expander");y.setStyle({}),y.style.height=e.row.$data.outerHeight+"px",y.style["--height"]=e.row.$data.outerHeight+"px",e.column.expander&&(y.style["--expander-padding-width"]=r.padding*(e.row.$data.parents.length+1)+"px");const l=n.get("config.list.rows");for(const t of e.row.$data.parents){const e=l[t];if("object"==typeof e.style&&"Object"===e.style.constructor.name&&"object"==typeof e.style.children){const t=e.style.children;for(const e in t)y.style[e]=t[e]}}if("object"==typeof e.row.style&&"Object"===e.row.style.constructor.name&&"object"==typeof e.row.style.current){const t=e.row.style.current;for(const e in t)y.style[e]=t[e]}P=e.row.classNames&&e.row.classNames.length?i.getClass(p,o)+" "+e.row.classNames.join(" "):$,w&&w.change(e),D.change(t,s),a()})),s(()=>{w&&w.destroy()});const _=i.getActions(p);_.includes(ce)||_.push(ce);const T=r.create(_,f);return i=>v(l`
        <div detach=${g} class=${P} style=${y} data-actions=${T}>
          ${e.column.expander?w.html():null}
          <div class=${x}>
            ${D.html("before",i)}${e.column.isHTML?void 0===e.row?null:"function"==typeof e.column.data?u(e.column.data({row:e.row,vido:t})):"function"==typeof e.row[e.column.data]?u(e.row[e.column.data]({row:e.row,vido:t})):u(e.row[e.column.data]):void 0===e.row?null:"function"==typeof e.column.data?e.column.data({row:e.row,vido:t}):"function"==typeof e.row[e.column.data]?e.row[e.column.data]({row:e.row,vido:t}):e.row[e.column.data]}${D.html("after",i)}
          </div>
        </div>
      `,{vido:t,props:e,templateProps:i})}function de(t,e){const{api:i,state:n,onDestroy:s,Actions:o,html:r,createComponent:a,onChange:l}=t,c="list-column-row-expander",h=i.getActions(c),d=Object.assign(Object.assign({},e),{api:i,state:n});let u,p=i.getClass(c);const f=n.subscribe("config.components.ListColumnRowExpanderToggle",t=>u=t),m=a(u,e.row?{row:e.row}:{});let g;s(()=>{m.destroy(),f()}),s(n.subscribe("config.wrappers.ListColumnRowExpander",t=>g=t));const v=i.generateSlots(c,t,e);e.row&&l((function(t){e=t,p=i.getClass(c,e.row.id);for(const t in e)d[t]=e[t];m.change(e),v.change(t)}));const b=o.create(h,d);return i=>g(r`
        <div class=${p} data-action=${b}>
          ${v.html("before",i)}${m.html()}${v.html("after",i)}
        </div>
      `,{vido:t,props:e,templateProps:i})}function ue(t,e){const{api:i,state:n,onDestroy:s,Actions:o,update:r,html:a,onChange:l,cache:c}=t,h="list-column-row-expander-toggle",d=Object.assign(Object.assign({},e),{api:i,state:n});let u;s(n.subscribe("config.wrappers.ListColumnRowExpanderToggle",t=>u=t));const p=i.getActions(h);let f,m,g,v;f=i.getClass(h),m=i.getClass(h+"-child"),g=i.getClass(h+"-open"),v=i.getClass(h+"-closed");let b,y,w,$=!1;s(n.subscribe("$data.list.expander.icons",t=>{t&&(b=t.child,y=t.open,w=t.closed),r()}));const x=i.generateSlots(h,t,e);function P(t){$=t,r()}let D;function _(){$=!$,e.row?n.update(`config.list.rows.${e.row.id}.expanded`,$):n.update("config.list.rows",t=>{for(const e in t)t[e].expanded=$;return t},{only:["*.expanded"]})}e.row?(l((function(t){var s;e=t,f=i.getClass(h,e.row.id),m=i.getClass(h+"-child",e.row.id),g=i.getClass(h+"-open",e.row.id),v=i.getClass(h+"-closed",e.row.id);for(const t in e)d[t]=e[t];D&&D(),(null===(s=null==e?void 0:e.row)||void 0===s?void 0:s.id)&&(D=n.subscribe(`config.list.rows.${e.row.id}.expanded`,P)),x.change(t)})),s((function(){D&&D()}))):s(n.subscribe("config.list.rows.*.expanded",(function(t){for(const e of t)if(e.value){$=!0;break}r()}),{bulk:!0}));const T=o.create(p,d);return i=>{return u(a`
        <div class=${f} data-action=${T} @click=${_}>
          ${x.html("before",i)}${c(b?0===(null===(o=null===(s=null===(n=e.row)||void 0===n?void 0:n.$data)||void 0===s?void 0:s.children)||void 0===o?void 0:o.length)?a` <img width="16" height="16" class=${m} src=${b} /> `:$?a` <img width="16" height="16" class=${g} src=${y} /> `:a` <img width="16" height="16" class=${v} src=${w} /> `:"")}${x.html("after",i)}
        </div>
      `,{vido:t,props:e,templateProps:i});var n,s,o}}function pe(t,e={}){const{html:i,onDestroy:n,api:s,state:o,update:r,StyleMap:a}=t;let l,c=s.getClass("list-toggle");n(o.subscribe("config.wrappers.ListToggle",t=>l=t));let h={open:"",close:""};n(o.subscribe("$data.list.toggle.icons",t=>{t&&(h=t,r())}));const d=new a({top:"0px"});n(o.subscribe("config.scroll.vertical.offset",t=>{d.style.top=(t||0)+"px"}));let u=!0;n(o.subscribe("config.list.columns.percent",t=>u=0!==t));let p=!1;function f(){p=!0}function m(){p&&(p=!1,o.update("config.list.columns.percent",t=>0===t?100:0))}const g=s.generateSlots("list-toggle",t,e);return n=>l(i`
        <div class=${c} style=${d} @pointerdown=${f} @pointerup=${m}>
          ${g.html("before",n)}<img
            src=${u?h.close:h.open}
          />${g.html("after",n)}
        </div>
      `,{props:e,vido:t,templateProps:n})}function fe(t,e={}){const{api:i,state:n,onDestroy:s,Actions:o,html:r,createComponent:a}=t,l=[];let c,h,d;l.push(n.subscribe("config.components.ChartCalendar",t=>c=t)),l.push(n.subscribe("config.components.ChartTimeline",t=>h=t)),l.push(n.subscribe("config.components.ScrollBar",t=>d=t));const u=a(c);s(u.destroy);const p=a(h);s(p.destroy);const f=a(d,{type:"horizontal"});s(f.destroy);const m=a(d,{type:"vertical"});let g;s(m.destroy),s(()=>{l.forEach(t=>t())}),s(n.subscribe("config.wrappers.Chart",t=>g=t));const v=i.getClass("chart"),b=i.getActions("chart");let y=!1;s(n.subscribe("config.chart.time.calculatedZoomMode",t=>y=t));const w={handleEvent:function(t){t.type},passive:!1,capture:!1};let $,x=0;b.push((function(t){$||($=new ee(()=>{const e=t.clientWidth,i=t.clientHeight,s=e-n.get("config.scroll.horizontal.size");x!==e&&(x=e,n.update("$data.chart.dimensions",{width:e,innerWidth:s,height:i}))}),$.observe(t),n.update("$data.elements.chart",t))})),s(()=>{$.disconnect()});const P=o.create(b,{api:i,state:n}),D=i.generateSlots("chart",t,e);return e=>g(r`
        <div class=${v} data-actions=${P} @wheel=${w}>
          ${D.html("before",e)}${u.html()}${D.html("inside",e)}${p.html()}${m.html()}${y?null:f.html()}${D.html("after",e)}
        </div>
      `,{vido:t,props:{},templateProps:e})}function me(t,e){const{api:i,state:n,onDestroy:s,Actions:o,update:r,reuseComponents:a,html:l,StyleMap:c}=t,h=i.getActions("chart-calendar"),d=Object.assign(Object.assign({},e),{api:i,state:n}),u=n.get("config.components.ChartCalendarDate");let p;s(n.subscribe("config.wrappers.ChartCalendar",t=>p=t));const f=i.getClass("chart-calendar");let m;const g=new c({height:"","--headerHeight":"","margin-left":""});s(n.subscribe("config.headerHeight",t=>{m=t,g.style.height=m+"px",g.style["--calendar-height"]=m+"px",r()}));const v=[[],[]];s(n.subscribe("$data.chart.time.levels",t=>{let e=0;for(const n of t){if(!n.length)continue;let t="YYYY-MM-DD HH";switch(n[0].period){case"day":t="YYYY-MM-DD";break;case"week":t="YYYY-MM-ww";break;case"month":t="YYYY-MM";break;case"year":t="YYYY"}const s=i.time.date().format(t);a(v[e],n,i=>i&&{level:e,date:i,currentDate:s,currentDateFormat:t},u),e++}r()})),s(()=>{v.forEach(t=>t.forEach(t=>t.destroy()))}),h.push(t=>{n.update("$data.elements.chart-calendar",t)});const b=o.create(h,d),y=i.generateSlots("chart-calendar",t,e);return i=>p(l`
        <div class=${f} data-actions=${b} style=${g}>
          ${y.html("before",i)}
          ${v.map((t,e)=>l`
              <div class=${f+"-dates "+f+`-dates--level-${e}`}>
                ${y.html("inside",i)}${t.map(t=>t.html())}
              </div>
            `)}
          ${y.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}class ge extends $t{constructor(t,e){super(),e.state.update("$data.elements.chart-calendar-dates",e=>(void 0===e&&(e=[]),e.includes(t)||e.push(t),e))}}function ve(t,e){const{api:i,state:n,onDestroy:s,Actions:o,update:r,onChange:a,html:l,StyleMap:c,Detach:h}=t,d=i.getActions("chart-calendar-date");let u;s(n.subscribe("config.wrappers.ChartCalendarDate",t=>u=t));let p,f,m=i.getClass("chart-calendar-date"),g="";const v=new c({width:"0px"});let b="";function y(){if(!e)return;const t=n.get(`config.chart.calendar.levels.${e.level}`);v.style.width=e.date.currentView.width+"px",p=n.get("$data.chart.time");const i=t.formats.find(t=>+p.zoom<=+t.zoomTo);g=e.date.current?" gstc-current":e.date.next?" gstc-next":e.date.previous?" gstc-previous":"";let s=m+"-content "+m+`-content--${e.date.period}`+g;i.className?(s+=" "+i.className,b=" "+i.className):b="",f=l`
      <div class=${s}>
        ${e.date.formatted}
      </div>
    `,r()}let w=!1;const $=new h(()=>w),x=i.generateSlots("chart-calendar-date",t,e);let P;const D={date:e.date,period:e.period,api:i,state:n};a((t,i)=>{if(i.leave)return w=!0,x.change(t,i),r();w=!1,e=t,D.date=e.date,D.period=e.period,P&&P(),P=n.subscribeAll(["$data.chart.time","config.chart.calendar.levels"],y,{bulk:!0}),x.change(t,i)}),s(()=>{P()}),d.includes(ge)||d.push(ge);const _=o.create(d,D);return i=>u(l`
        <div
          detach=${$}
          class=${m+" "+m+`--${e.date.period}`+" "+m+`--level-${e.level}`+g+b}
          style=${v}
          data-actions=${_}
        >
          ${x.html("before",i)}${f}${x.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}function be(t,e){const{api:i,state:n,onDestroy:s,Action:o,Actions:r,update:a,html:l,createComponent:c,StyleMap:h}=t,d=Object.assign(Object.assign({},e),{api:i,state:n});let u,p,f,m;s(n.subscribe("config.wrappers.ChartTimeline",t=>u=t)),s(n.subscribe("config.components.ChartTimelineGrid",t=>{p&&p.destroy(),p=c(t)})),s(()=>{p&&p.destroy()}),s(n.subscribe("config.components.ChartTimelineItems",t=>{f&&f.destroy(),f=c(t)})),s(()=>{f&&f.destroy()}),s(n.subscribe("config.components.ListToggle",t=>{m&&m.destroy(),m=c(t)})),s(()=>{m&&m.destroy()});const g=i.generateSlots("chart-timeline",t,e),v=i.getClass("chart-timeline"),b=i.getClass("chart-timeline-inner");let y;s(n.subscribe("config.list.toggle.display",t=>y=t));const w=new h({}),$=new h({});s(n.subscribeAll(["$data.innerHeight","config.scroll.vertical.offset","$data.chart.dimensions.width","$data.list.visibleRowsHeight","$data.chart.time.dates.day"],(function(){const t=n.get("$data.chart.dimensions.width"),e=n.get("$data.list.visibleRowsHeight");w.style.height=n.get("$data.innerHeight")+"px",w.style["--height"]=w.style.height,t?(w.style.width=t+"px",w.style["--width"]=t+"px"):(w.style.width="0px",w.style["--width"]="0px"),$.style.height=e+"px",$.style.width=t?t+"px":"0px";const i=n.get("config.scroll.vertical.offset")||0;$.style.transform=`translateY(-${i}px)`,a()})));let x=[];s(n.subscribe("config.actions.chart-timeline",t=>{x=t})),x.push(class extends o{constructor(t){super(),n.get("$data.elements.chart-timeline")!==t&&n.update("$data.elements.chart-timeline",t)}});const P=r.create(x,d);return i=>u(l`
        <div class=${v} style=${w} data-actions=${P}>
          <div class=${b} style=${$}>
            ${g.html("before",i)}${p.html()}${g.html("inside",i)}${f.html()}${y?m.html():""}${g.html("after",i)}
          </div>
        </div>
      `,{props:e,vido:t,templateProps:i})}class ye{constructor(t,e){e.state.get("$data.elements.chart-timeline-grid")!==t&&e.state.update("$data.elements.chart-timeline-grid",t)}destroy(t,e){e.state.update("$data.elements",t=>(delete t["chart-timeline-grid"],t))}}function we(t,e){const{api:i,state:n,onDestroy:s,Actions:o,update:r,html:a,reuseComponents:l,StyleMap:c}=t,h=i.getActions("chart-timeline-grid"),d={api:i,state:n};let u;s(n.subscribe("config.wrappers.ChartTimelineGrid",t=>u=t));const p=n.get("config.components.ChartTimelineGridRow"),f=i.getClass("chart-timeline-grid");let m,g;s(n.subscribe("config.chart.grid.cell.onCreate",t=>m=t)),s(n.subscribe("config.debug",t=>g=t));const v=[],b=[],y=new Map,w=new c({});s(n.subscribeAll(["$data.list.rowsHeight","$data.list.visibleRows;","$data.list.visibleRowsHeight","config.chart.items.*.rowId","config.chart.items.*.time","$data.chart.time.levels","$data.innerHeight","$data.chart.dimensions.width"],(function(){g&&console.log("[grid.ts] generateCells");const t=n.get("$data.chart.dimensions.width"),e=n.get("$data.innerHeight"),s=n.get("config.scroll.vertical.offset")||0,o=n.get("$data.chart.time"),r=n.get(`$data.chart.time.levels.${o.level}`);if(!r||0===r.length)return void n.update("$data.chart.grid.rowsWithCells",[]);const a=n.get("$data.list.visibleRows");w.style.height=e+s+"px",w.style.width=t+"px";let l=0;b.length=0;const c=i.getAllRows();for(const e of a){const n=c[e];if(!n||!n.$data){g&&console.warn("generateCells EMPTY ROW",{row:n,rowId:e,visibleRowsId:a,rows:c});continue}const s=[];for(const t of r){let e;y.has(t.leftGlobal)?e=y.get(t.leftGlobal):(e=i.time.date(t.leftGlobal).format("YYYY-MM-DDTHH:mm"),y.set(t.leftGlobal,e));let o={id:n.id+":"+e,time:t,row:n,top:l};for(const t of m)o=t(o);s.push(o)}b.push({row:n,cells:s,top:l,width:t}),l+=n.$data.outerHeight}n.update("$data.chart.grid.rowsWithCells",b)}),{bulk:!0})),s(n.subscribeAll(["$data.chart.grid.rowsWithCells;","config.list.rows"],(function(){g&&console.log("[grid.ts] generate rows components");const t=n.get("$data.chart.grid.rowsWithCells");l(v,t||[],t=>t,p,!1),r()}))),s(()=>{v.forEach(t=>t.destroy())}),h.push(ye);const $=o.create(h,d),x=i.generateSlots("chart-timeline-grid",t,e);return i=>u(a`
        <div class=${f} data-actions=${$} style=${w}>
          ${x.html("before",i)}${v.map(t=>t.html())}${x.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}class $e{constructor(t,e){let i=!1,n=e.state.get("$data.elements.chart-timeline-grid-rows");void 0===n&&(n=[],i=!0),n.includes(t)||(n.push(t),i=!0),i&&e.state.update("$data.elements.chart-timeline-grid-rows",n,{only:null})}destroy(t,e){e.state.update("$data.elements.chart-timeline-grid-rows",e=>e.filter(e=>e!==t))}}function xe(t,e){const{api:i,state:n,onDestroy:s,Detach:o,Actions:r,update:a,html:l,reuseComponents:c,onChange:h,StyleMap:d}=t,u="chart-timeline-grid-row",p=Object.assign(Object.assign({},e),{api:i,state:n});let f,m;s(n.subscribe("config.wrappers.ChartTimelineGridRow",t=>{f=t,a()})),s(n.subscribe("config.components.ChartTimelineGridRowCell",t=>m=t));const g=i.getActions(u);let v=i.getClass(u);const b=new d({width:e.width+"px",height:e.row.height+"px"},!0);let y=!1;const w=new o(()=>y),$=i.generateSlots(u,t,e),x=[];h((function(t,s){var o,r,l,h,d,f,g;if(s.leave||void 0===t.row)return y=!0,c(x,[],t=>t,m,!1),$.change(t,s),void a();y=!1,e=t,v=i.getClass(u,e.row.id),c(x,e.cells,t=>t,m,!1),b.setStyle({}),b.style.height=e.row.$data.outerHeight+"px",b.style.width=e.width+"px";const w=n.get("config.list.rows");for(const t of e.row.$data.parents){const e=w[t],i=null===(l=null===(r=null===(o=null==e?void 0:e.style)||void 0===o?void 0:o.grid)||void 0===r?void 0:r.row)||void 0===l?void 0:l.children;if(i)for(const t in i)b.style[t]=i[t]}const P=null===(g=null===(f=null===(d=null===(h=null==e?void 0:e.row)||void 0===h?void 0:h.style)||void 0===d?void 0:d.grid)||void 0===f?void 0:f.row)||void 0===g?void 0:g.current;if(P)for(const t in P)b.style[t]=P[t];for(const t in e)p[t]=e[t];$.change(t,s),a()})),s((function(){x.forEach(t=>t.destroy())})),-1===g.indexOf($e)&&g.push($e);const P=r.create(g,p);return i=>f(l`
        <div detach=${w} class=${v} data-actions=${P} style=${b}>
          ${$.html("before",i)}${x.map(t=>t.html())}
          ${$.html("after",i)}
        </div>
      `,{vido:t,props:e,templateProps:i})}class Pe{constructor(t,e){let i=!1,n=e.state.get("$data.elements.chart-timeline-grid-row-cells");void 0===n&&(n=[],i=!0),n.includes(t)||(n.push(t),i=!0),i&&e.state.update("$data.elements.chart-timeline-grid-row-cells",n,{only:null})}destroy(t,e){e.state.update("$data.elements.chart-timeline-grid-row-cells",e=>e.filter(e=>e!==t),{only:[""]})}}function De(t,e){const{api:i,state:n,onDestroy:s,Detach:o,Actions:r,update:a,html:l,onChange:c,StyleMap:h}=t,d="chart-timeline-grid-row-cell",u=Object.assign(Object.assign({},e),{api:i,state:n});let p=!1;const f=new o(()=>p),m=i.getActions(d);let g;s(n.subscribe("config.wrappers.ChartTimelineGridRowCell",t=>{g=t,a()}));const v=i.generateSlots(d,t,e);let b;function y(t){b=i.getClass(d,`${e.row.id}-${e.time.formatted}`),t.current&&(b+=" current")}y(e.time);const w=new h({width:"",height:""});c((function(t,n){var s,o,r,l,c,h,d,f,m,g;if(n.leave||void 0===t.row)return p=!0,v.change(t,n),a();p=!1,e=t;for(const t in e)u[t]=e[t];y(e.time),w.setStyle({}),w.style.width=((null===(s=null==e?void 0:e.time)||void 0===s?void 0:s.width)||0)+"px",w.style.height=((null===(r=null===(o=null==e?void 0:e.row)||void 0===o?void 0:o.$data)||void 0===r?void 0:r.outerHeight)||0)+"px";const b=i.getAllRows();for(const t of e.row.$data.parents){const e=b[t],i=null===(h=null===(c=null===(l=null==e?void 0:e.style)||void 0===l?void 0:l.grid)||void 0===c?void 0:c.cell)||void 0===h?void 0:h.children;i&&w.setStyle(Object.assign(Object.assign({},w.style),i))}const $=null===(g=null===(m=null===(f=null===(d=null==e?void 0:e.row)||void 0===d?void 0:d.style)||void 0===f?void 0:f.grid)||void 0===m?void 0:m.cell)||void 0===g?void 0:g.current;$&&w.setStyle(Object.assign(Object.assign({},w.style),$)),v.change(e,n),a()})),m.push(Pe);const $=r.create(m,u);return i=>g(l`
        ${v.html("before",i)}
        <div detach=${f} class=${b} data-actions=${$} style=${w}>
          ${v.html("inside",i)}
        </div>
        ${v.html("after",i)}
      `,{props:e,vido:t,templateProps:i})}function _e(t,e={}){const{api:i,state:n,onDestroy:s,Actions:o,update:r,html:a,reuseComponents:l,StyleMap:c}=t;let h,d,u;s(n.subscribe("config.wrappers.ChartTimelineItems",t=>h=t)),s(n.subscribe("config.actions.chart-timeline-items",t=>d=t)),s(n.subscribe("config.components.ChartTimelineItemsRow",t=>u=t));const p=i.getClass("chart-timeline-items"),f=new c({},!0);s(n.subscribeAll(["$data.innerHeight","$data.chart.dimensions.width","config.scroll.vertical.offset"],(function(){const t=n.get("$data.chart.dimensions.width"),e=n.get("$data.innerHeight"),i=n.get("config.scroll.vertical.offset")||0;f.style.width=t+"px",f.style.height=e+i+"px"})));const m=[];s(n.subscribeAll(["$data.list.visibleRows;","config.list.rows","config.components.ChartTimelineItemsRow","config.chart.items.*.rowId"],(function(){const t=n.get("$data.list.visibleRows")||[],e=i.getRows(t);l(m,e,t=>({row:t}),u,!1),r()}))),s(()=>{m.forEach(t=>t.destroy())});const g=o.create(d,{api:i,state:n}),v=i.generateSlots("chart-timeline-items",t,e);return i=>h(a`
        <div class=${p} style=${f} data-actions=${g}>
          ${v.html("before",i)}${m.map(t=>t.html())}${v.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}class Te{constructor(t,e){let i=!1,n=e.state.get("$data.elements.chart-timeline-items-rows");void 0===n&&(n=[],i=!0),n.includes(t)||(n.push(t),i=!0),i&&e.state.update("$data.elements.chart-timeline-items-rows",n,{only:null})}destroy(t,e){e.state.update("$data.elements.chart-timeline-items-rows",e=>e.filter(e=>e!==t))}}function Se(t,e){const{api:i,state:n,onDestroy:s,Detach:o,Actions:r,update:a,html:l,onChange:c,reuseComponents:h,StyleMap:d}=t,u=Object.assign(Object.assign({},e),{api:i,state:n});let p,f;s(n.subscribe("config.wrappers.ChartTimelineItemsRow",t=>p=t)),s(n.subscribe("config.components.ChartTimelineItemsRowItem",t=>f=t));let m="";const g=[],v=new d({width:"",height:""},!0);let b=!1;const y=new o(()=>b);function w(t){if(!t||!t.$data)return b=!0,h(g,[],()=>null,f,!1),a();const s=t.$data.items;if(void 0===s)return b=!0,h(g,[],()=>null,f,!1),a();const o=i.getItems(s);h(g,o,e=>({row:t,item:e}),f,!1),function(){const t=n.get("$data.chart");b=!1,v.style.width=t.dimensions.width+"px",e?(v.style.height=e.row.$data.outerHeight+"px",v.style["--row-height"]=e.row.$data.outerHeight+"px"):b=!0}(),a()}const $="chart-timeline-items-row";let x=i.getClass($);const P=i.generateSlots($,t,e);c((function(t,n){if(n.leave||!t||void 0===t.row)return b=!0,h(g,[],()=>null,f,!1),P.change(t,n),a();e=t,x=i.getClass($,e.row.id);for(const t in e)u[t]=e[t];m=e.row.classNames&&e.row.classNames.length?x+" "+e.row.classNames.join(" "):x,w(e.row),P.change(t,n)})),s(n.subscribe("$data.chart.dimensions.width",()=>w(e.row))),s(()=>{g.forEach(t=>t.destroy())});const D=i.getActions($);D.push(Te);const _=r.create(D,u);return i=>p(l`
        <div detach=${y} class=${m} data-actions=${_} style=${v}>
          ${P.html("before",i)}${g.map(t=>t.html())}${P.html("after",i)}
        </div>
      `,{props:e,vido:t,templateProps:i})}class Me{constructor(t,e){let i=!1,n=e.state.get("$data.elements.chart-timeline-items-row-items");void 0===n&&(n=[],i=!0),n.includes(t)||(n.push(t),i=!0),i&&e.state.update("$data.elements.chart-timeline-items-row-items",n,{only:null})}destroy(t,e){e.state.update("$data.elements.chart-timeline-items-row-items",e=>e.filter(e=>e!==t))}}function Ce(t,e){const{api:i,state:n,onDestroy:s,Detach:o,Actions:r,update:a,html:l,svg:c,onChange:h,unsafeHTML:d,StyleMap:u}=t;let p,f,m;s(n.subscribe("config.wrappers.ChartTimelineItemsRowItem",t=>p=t)),s(n.subscribe("config.debug",t=>m=t));let g=0,v=0,b=!1,y="";const w=new u({width:"",height:"",left:"",top:""}),$=new u({}),x=new u({}),P={item:e.item,row:e.row,left:g,width:v,api:i,state:n},D="chart-timeline-items-row-item";let _,T;_=i.getClass(D),T=i.getClass(D+"-label");let S=!1;function M(t=n.get("$data.chart.time")){var s,o,r,l,c,h,d,u;if(b||0===t.levels.length||!t.levels[t.level]||0===t.levels[t.level].length)return S=!0,e.item&&(e.item.$data.detached=S),a();if(!e.item)return S=!0,a();if(m&&console.log("Item change before",{id:e.item.id,item:e.item}),g=e.item.$data.position.actualLeft,v=e.item.$data.actualWidth,e.item.time.end<=t.leftGlobal||e.item.time.start>=t.rightGlobal||v<=0)return S=!0,e.item.$data.detached=S,a();y=_,e.item.time.start<t.leftGlobal?($.style.display="block",y+=" "+i.getClass(D+"--left-cut",e.row.id+"-"+e.item.id)):$.style.display="none",e.item.$data.position.right>t.width?(x.style.display="block",y+=" "+i.getClass(D+"--right-cut",e.row.id+"-"+e.item.id)):x.style.display="none",e.item.classNames&&e.item.classNames.length&&(y+=" "+e.item.classNames.join(" ")),e.item.selected&&(y+=" "+i.getClass(D)+"--selected");const p=w.style.width,f=w.style.left,T=w.style.top,M=w.style.height;w.setStyle({});const C=i.isItemInViewport(e.item,t.leftGlobal,t.rightGlobal);S=!C,e.item.$data.detached=S,C?(w.style.width=v+"px",w.style.left=g+"px",w.style.top=e.item.$data.position.actualTop+"px",w.style.height=e.item.$data.actualHeight+"px"):(w.style.width=p,w.style.left=f,w.style.top=T,w.style.height=M);const O=i.getAllRows();for(const t of e.row.$data.parents){const e=O[t],i=null===(r=null===(o=null===(s=null==e?void 0:e.style)||void 0===s?void 0:s.items)||void 0===o?void 0:o.item)||void 0===r?void 0:r.children;i&&w.setStyle(Object.assign(Object.assign({},w.style),i))}const E=null===(d=null===(h=null===(c=null===(l=null==e?void 0:e.row)||void 0===l?void 0:l.style)||void 0===c?void 0:c.items)||void 0===h?void 0:h.item)||void 0===d?void 0:d.current;E&&w.setStyle(Object.assign(Object.assign({},w.style),E));const I=null===(u=null==e?void 0:e.item)||void 0===u?void 0:u.style;I&&w.setStyle(Object.assign(Object.assign({},w.style),I)),P.left=g,P.width=v,m&&console.log("Item change after",{id:e.item.id,itemLeftPx:g,itemWidthPx:v,item:e.item}),a()}const C=i.getClass(D+"-cut"),O=i.generateSlots(D,t,e);let E=[];function I(){E.forEach(t=>t()),E.length=0}function A(t={}){if(I(),E.push(n.subscribe(`config.chart.items.${f}`,()=>R(e,t))),e.item.linkedWith&&Array.isArray(e.item.linkedWith))for(const i of e.item.linkedWith)E.push(n.subscribe(`config.chart.items.${i}`,()=>R(e,t)))}function R(t,n){if(n.leave||void 0===t.row||void 0===t.item)return b=!0,S=!0,e.item&&(e.item.$data.detached=S),O.change(t,n),a();S=!1,e.item.$data.detached=S,b=!1,(e=t).item.id!==f&&(f=e.item.id,A(n),_=i.getClass(D,e.row.id+"-"+e.item.id),T=i.getClass(D+"-label",e.row.id+"-"+e.item.id),P.item=e.item,P.row=e.row),M(),O.change(t,n),a()}A(),h(R),s(I),R(e,{});const L=i.getActions(D);s(n.subscribe("$data.chart.time",M)),L.push(Me);const N=r.create(L,P),z=new o(()=>S);function Y(){return e.item?e.item.isHTML?e.item&&e.item.label?"function"==typeof e.item.label?d(e.item.label({item:e.item,vido:t})):d(e.item.label):null:e.item&&e.item.label?"function"==typeof e.item.label?e.item.label({item:e.item,vido:t}):e.item.label:null:null}return i=>p(l`
        <div detach=${z} class=${y} data-actions=${N} style=${w}>
          ${l`
    <div class=${C} style=${$}>
      ${c`<svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 18 16" width="16">
        <path fill-opacity="0.5" fill="#ffffff" d="m5,3l-5,5l5,5l0,-10z" />
      </svg>`}
    </div>
  `}${O.html("before",i)}
          <div class=${T} title=${e.item?e.item.isHTML||"function"==typeof e.item.label?"":e.item.label:null}>
            ${O.html("inside",i)}${Y()}
          </div>
          ${O.html("after",i)}${l`
    <div class=${C} style=${x}>
      ${c`<svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 4 16" width="16">
        <path transform="rotate(-180 2.5,8) " fill-opacity="0.5" fill="#ffffff" d="m5,3l-5,5l5,5l0,-10z" />
      </svg>`}
    </div>
  `}
        </div>
      `,{vido:t,props:e,templateProps:i})}const Oe=["main","scroll-bar","list","list-column","list-column-header","list-column-header-resizer","list-column-header-resizer-dots","list-column-row","list-column-row-expander","list-column-row-expander-toggle","list-toggle","chart","chart-calendar","chart-calendar-date","chart-timeline","chart-timeline-grid","chart-timeline-grid-row","chart-timeline-grid-row-cell","chart-timeline-items","chart-timeline-items-row","chart-timeline-items-row-item"];function Ee(){const t={};return Oe.forEach(e=>t[e]=[]),t}function Ie(){const t={};return Oe.forEach(e=>{t[e]={before:[],inside:[],after:[]}}),t}var Ae=t((function(t,e){t.exports=function(){var t="millisecond",e="second",i="minute",n="hour",s="day",o="week",r="month",a="quarter",l="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,h=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(t,e,i){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(i)+t},u={s:d,z:function(t){var e=-t.utcOffset(),i=Math.abs(e),n=Math.floor(i/60),s=i%60;return(e<=0?"+":"-")+d(n,2,"0")+":"+d(s,2,"0")},m:function(t,e){var i=12*(e.year()-t.year())+(e.month()-t.month()),n=t.clone().add(i,r),s=e-n<0,o=t.clone().add(i+(s?-1:1),r);return Number(-(i+(e-n)/(s?n-o:o-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(c){return{M:r,y:l,w:o,d:s,D:"date",h:n,m:i,s:e,ms:t,Q:a}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},f="en",m={};m[f]=p;var g=function(t){return t instanceof w},v=function(t,e,i){var n;if(!t)return f;if("string"==typeof t)m[t]&&(n=t),e&&(m[t]=e,n=t);else{var s=t.name;m[s]=t,n=s}return!i&&n&&(f=n),n||!i&&f},b=function(t,e,i){if(g(t))return t.clone();var n=e?"string"==typeof e?{format:e,pl:i}:e:{};return n.date=t,new w(n)},y=u;y.l=v,y.i=g,y.w=function(t,e){return b(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var w=function(){function d(t){this.$L=this.$L||v(t.locale,null,!0),this.parse(t)}var u=d.prototype;return u.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(y.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(c);if(n)return i?new Date(Date.UTC(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)):new Date(n[1],n[2]-1,n[3]||1,n[4]||0,n[5]||0,n[6]||0,n[7]||0)}return new Date(e)}(t),this.init()},u.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},u.$utils=function(){return y},u.isValid=function(){return!("Invalid Date"===this.$d.toString())},u.isSame=function(t,e){var i=b(t);return this.startOf(e)<=i&&i<=this.endOf(e)},u.isAfter=function(t,e){return b(t)<this.startOf(e)},u.isBefore=function(t,e){return this.endOf(e)<b(t)},u.$g=function(t,e,i){return y.u(t)?this[e]:this.set(i,t)},u.year=function(t){return this.$g(t,"$y",l)},u.month=function(t){return this.$g(t,"$M",r)},u.day=function(t){return this.$g(t,"$W",s)},u.date=function(t){return this.$g(t,"$D","date")},u.hour=function(t){return this.$g(t,"$H",n)},u.minute=function(t){return this.$g(t,"$m",i)},u.second=function(t){return this.$g(t,"$s",e)},u.millisecond=function(e){return this.$g(e,"$ms",t)},u.unix=function(){return Math.floor(this.valueOf()/1e3)},u.valueOf=function(){return this.$d.getTime()},u.startOf=function(t,a){var c=this,h=!!y.u(a)||a,d=y.p(t),u=function(t,e){var i=y.w(c.$u?Date.UTC(c.$y,e,t):new Date(c.$y,e,t),c);return h?i:i.endOf(s)},p=function(t,e){return y.w(c.toDate()[t].apply(c.toDate(),(h?[0,0,0,0]:[23,59,59,999]).slice(e)),c)},f=this.$W,m=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case l:return h?u(1,0):u(31,11);case r:return h?u(1,m):u(0,m+1);case o:var b=this.$locale().weekStart||0,w=(f<b?f+7:f)-b;return u(h?g-w:g+(6-w),m);case s:case"date":return p(v+"Hours",0);case n:return p(v+"Minutes",1);case i:return p(v+"Seconds",2);case e:return p(v+"Milliseconds",3);default:return this.clone()}},u.endOf=function(t){return this.startOf(t,!1)},u.$set=function(o,a){var c,h=y.p(o),d="set"+(this.$u?"UTC":""),u=(c={},c.day=d+"Date",c.date=d+"Date",c[r]=d+"Month",c[l]=d+"FullYear",c[n]=d+"Hours",c[i]=d+"Minutes",c[e]=d+"Seconds",c[t]=d+"Milliseconds",c)[h],p=h===s?this.$D+(a-this.$W):a;if(h===r||h===l){var f=this.clone().set("date",1);f.$d[u](p),f.init(),this.$d=f.set("date",Math.min(this.$D,f.daysInMonth())).toDate()}else u&&this.$d[u](p);return this.init(),this},u.set=function(t,e){return this.clone().$set(t,e)},u.get=function(t){return this[y.p(t)]()},u.add=function(t,a){var c,h=this;t=Number(t);var d=y.p(a),u=function(e){var i=b(h);return y.w(i.date(i.date()+Math.round(e*t)),h)};if(d===r)return this.set(r,this.$M+t);if(d===l)return this.set(l,this.$y+t);if(d===s)return u(1);if(d===o)return u(7);var p=(c={},c[i]=6e4,c[n]=36e5,c[e]=1e3,c)[d]||1,f=this.$d.getTime()+t*p;return y.w(f,this)},u.subtract=function(t,e){return this.add(-1*t,e)},u.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var i=t||"YYYY-MM-DDTHH:mm:ssZ",n=y.z(this),s=this.$locale(),o=this.$H,r=this.$m,a=this.$M,l=s.weekdays,c=s.months,d=function(t,n,s,o){return t&&(t[n]||t(e,i))||s[n].substr(0,o)},u=function(t){return y.s(o%12||12,t,"0")},p=s.meridiem||function(t,e,i){var n=t<12?"AM":"PM";return i?n.toLowerCase():n},f={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:y.s(a+1,2,"0"),MMM:d(s.monthsShort,a,c,3),MMMM:c[a]||c(this,i),D:this.$D,DD:y.s(this.$D,2,"0"),d:String(this.$W),dd:d(s.weekdaysMin,this.$W,l,2),ddd:d(s.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:y.s(o,2,"0"),h:u(1),hh:u(2),a:p(o,r,!0),A:p(o,r,!1),m:String(r),mm:y.s(r,2,"0"),s:String(this.$s),ss:y.s(this.$s,2,"0"),SSS:y.s(this.$ms,3,"0"),Z:n};return i.replace(h,(function(t,e){return e||f[t]||n.replace(":","")}))},u.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},u.diff=function(t,s,c){var h,d=y.p(s),u=b(t),p=6e4*(u.utcOffset()-this.utcOffset()),f=this-u,m=y.m(this,u);return m=(h={},h[l]=m/12,h[r]=m,h[a]=m/3,h[o]=(f-p)/6048e5,h.day=(f-p)/864e5,h[n]=f/36e5,h[i]=f/6e4,h[e]=f/1e3,h)[d]||f,c?m:y.a(m)},u.daysInMonth=function(){return this.endOf(r).$D},u.$locale=function(){return m[this.$L]},u.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),n=v(t,e,!0);return n&&(i.$L=n),i},u.clone=function(){return y.w(this.$d,this)},u.toDate=function(){return new Date(this.valueOf())},u.toJSON=function(){return this.isValid()?this.toISOString():null},u.toISOString=function(){return this.$d.toISOString()},u.toString=function(){return this.$d.toUTCString()},d}();return b.prototype=w.prototype,b.extend=function(t,e){return t(e,w,b),b},b.locale=v,b.isDayjs=g,b.unix=function(t){return b(1e3*t)},b.en=m[f],b.Ls=m,b}()})),Re=t((function(t,e){t.exports=function(t,e,i){var n=(new Date).getTimezoneOffset(),s=e.prototype;i.utc=function(t,i){return new e({date:t,utc:!0,format:i})},s.utc=function(){return i(this.toDate(),{locale:this.$L,utc:!0})},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var o=s.parse;s.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),o.call(this,t)};var r=s.init;s.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else r.call(this)};var a=s.utcOffset;s.utcOffset=function(t){var e=this.$utils().u;if(e(t))return this.$u?0:e(this.$offset)?a.call(this):this.$offset;var i,s=Math.abs(t)<=16?60*t:t;return 0!==t?(i=this.local().add(s+n,"minute")).$offset=s:i=this.utc(),i};var l=s.format;s.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,e)},s.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+n;return this.$d.valueOf()-6e4*t},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()}}}));class Le{constructor(t,e){this.utcMode=!1,this.state=t,this.api=e,this.dayjs=Ae,this.locale=t.get("config.locale"),this.utcMode=t.get("config.utcMode"),this.resetCurrentDate(),this.utcMode&&Ae.extend(Re),Ae.locale(this.locale,null,!0)}resetCurrentDate(){const t=Ae();this.currentDate={timestamp:t.valueOf(),hour:t.startOf("hour"),day:t.startOf("day"),week:t.startOf("week"),month:t.startOf("month"),year:t.startOf("year")}}date(t){const e=this.utcMode?Ae.utc:Ae;return t?e(t).locale(this.locale.name):e().locale(this.locale.name)}addAdditionalSpace(t){if(!t.additionalSpaceAdded&&t.additionalSpaces&&t.additionalSpaces[t.period]){t.additionalSpaceAdded=!0;const e=t.additionalSpaces[t.period];e.before&&(t.from=this.date(t.from).subtract(e.before,e.period).valueOf()),e.after&&(t.to=this.date(t.to).add(e.after,e.period).valueOf()),t.additionalSpaceAdded=!0}return t}recalculateFromTo(t){const e=t.period;(t=Object.assign({},t)).from=+t.from,t.to=+t.to,t.fromDate=this.date(t.from),t.toDate=this.date(t.to).endOf(e);let i=Number.MAX_SAFE_INTEGER,n=0;const s=this.state.get("config.chart.items");if(Object.keys(s).length>0&&(0===t.from||0===t.to)){for(const t in s){const e=s[t];e.time.start<i&&e.time.start&&(i=e.time.start),e.time.end>n&&(n=e.time.end)}0===t.from&&(t.from=this.date(i).startOf(e).valueOf()),0===t.to&&(t.to=this.date(n).endOf(e).valueOf()),t.fromDate=this.date(t.from),t.toDate=this.date(t.to).endOf(e)}return t.from=t.fromDate.startOf(e).valueOf(),t.to=t.toDate.endOf(e).valueOf(),t.additionalSpaceAdded||((t=this.addAdditionalSpace(t)).additionalSpaceAdded=!0),t}getCenter(t){return t.leftGlobal+Math.round((t.rightGlobal-t.leftGlobal)/2)}getGlobalOffsetPxFromDates(t,e=this.state.get("$data.chart.time")){const i=t.valueOf(),n=e.allDates[e.level];if(!n)return-1;let s;for(let t=0,e=n.length;t<e;t++){const e=n[t];if(i<=e.rightGlobal){s=e;break}}if(s)return i<s.leftGlobal?s.leftPx:s.rightPx-(s.rightGlobal-i)/e.timePerPixel;{const i=t.valueOf();if(i<=e.leftGlobal)return 0;if(i>=e.rightGlobal)return e.totalViewDurationPx}}getViewOffsetPxFromDates(t,e=!0,i=this.state.get("$data.chart.time")){const n=this.getGlobalOffsetPxFromDates(t,i)-i.leftPx;return e&&this.limitOffsetPxToView(n),n}limitOffsetPxToView(t,e=this.state.get("$data.chart.time")){return t<0?0:t>e.width?e.width:t}findDateAtOffsetPx(t,e){return e.find(e=>e.leftPx>=t)}findDateAtTime(t,e){return e.find(e=>e.rightGlobal>=t)}getTimeFromViewOffsetPx(t,e,i=!0){const n=t+e.leftPx;let s=e.allDates[e.level];if(n<0){let t,i=e.fromDate.subtract(1,e.period),s=0;for(let o=0;o<1e3;o++){const o=this.generatePeriodDates({leftDate:i,rightDate:i.add(1,e.period),period:e.period,time:e,level:this.state.get(`config.chart.calendar.levels.${e.level}`),levelIndex:e.level,callOnDate:!0,callOnLevelDates:!1});if(o.length&&(t=o[0],s-=t.width,s<=n))return t.leftGlobal+(n-s)*e.timePerPixel;i=i.subtract(1,e.period).startOf(e.period)}}else if(n>e.totalViewDurationPx){let t,i,s=e.toDate.startOf("day").add(1,"day"),o=e.rightPx;for(let r=0;r<1e3;r++){const r=this.generatePeriodDates({leftDate:s,rightDate:s.add(1,e.period),period:e.period,time:e,level:this.state.get(`config.chart.calendar.levels.${e.level}`),levelIndex:e.level,callOnDate:!0,callOnLevelDates:!1});if(r.length&&(t=r[0],o+=t.width,o>=n))return i&&(t=i),t.rightGlobal-(o-n)*e.timePerPixel;s=s.add(1,e.period).startOf(e.period),i=t}}for(let t=0,o=s.length;t<o;t++){let o=s[t];if(o.rightPx>=n){const t=o.rightGlobal-Math.round((o.rightPx-n)*e.timePerPixel);return i?t+1:t}}return 0}calculateScrollPosPxFromTime(t,e,i){if(i||(i=this.state.get("config.scroll.horizontal")),!i.maxPosPx)return 0;e||(e=this.state.get("$data.chart.time"));const n=this.findDateAtTime(t,e.allDates[e.level]);return Math.round((i.maxPosPx-i.innerSize)*n.leftPercent)}getCurrentFormatForLevel(t,e){return t.formats.find(t=>+e.zoom<=+t.zoomTo)}generatePeriodDates({leftDate:t,rightDate:e,period:i,level:n,levelIndex:s,time:o,callOnDate:r,callOnLevelDates:a}){if(!o.timePerPixel)return[];let l=0;const c=Math.ceil(e.diff(t,i,!0));let h=[];for(let e=0;e<c;e++){const e=t.endOf(i);let n={leftGlobal:t.valueOf(),leftGlobalDate:t,rightGlobalDate:e,rightGlobal:e.valueOf(),width:0,leftPx:0,rightPx:0,period:i,formatted:null,current:t.valueOf()===this.currentDate[i].valueOf(),previous:t.add(1,i).valueOf()===this.currentDate[i].valueOf(),next:t.subtract(1,i).valueOf()===this.currentDate[i].valueOf()};const s=n.rightGlobal-n.leftGlobal;n.width=s/o.timePerPixel,n.leftPx=l,l+=n.width,n.rightPx=l,h.push(n),t=t.add(1,i)}const d=this.getCurrentFormatForLevel(n,o);if(r)for(let t=0,e=o.onDate.length;t<e;t++)h=h.map(e=>o.onDate[t]({date:e,format:d,time:o,level:n,levelIndex:s})).filter(t=>null!==t);if(a)for(let t=0,e=o.onLevelDates.length;t<e;t++)h=o.onLevelDates[t]({dates:h,format:d,time:o,level:n,levelIndex:s});return h}getDatesDiffPx(t,e,i,n=!0){if(t.valueOf()===e.valueOf())return 0;const s=i.allDates[i.level];if(0===s.length)return 0;let o=0,r=!1;if(e.valueOf()<t.valueOf()){const i=t;t=e,e=i,r=!0}let a=[];if(t.valueOf()<s[0].leftGlobal){const e=s[0].period,n=i.level,o=this.state.get(`config.chart.calendar.levels.${n}`);a=this.generatePeriodDates({leftDate:t,rightDate:s[0].leftGlobalDate,period:e,level:o,levelIndex:n,time:i,callOnDate:!0,callOnLevelDates:!1})}a=[...a,...s];const l=s[s.length-1].leftGlobalDate;if(e.valueOf()>l.valueOf()){const t=s[0].period,n=i.level,o=this.state.get(`config.chart.calendar.levels.${n}`),r=this.generatePeriodDates({leftDate:e,rightDate:l,period:t,level:o,levelIndex:n,time:i,callOnDate:!0,callOnLevelDates:!1});a=[...a,...r]}const c=this.state.get(`config.chart.calendar.levels.${i.level}`),h=this.getCurrentFormatForLevel(c,i);for(const t of i.onLevelDates)a=t({dates:a,time:i,format:h,level:c,levelIndex:i.level});let d,u,p=!1;for(d of a){if(d.leftGlobal>=t.valueOf()&&(p=!0,u=d),d.rightGlobal>=e.valueOf())break;p&&(o+=d.width)}if(n){let n=(t.valueOf()-d.leftGlobal)/i.timePerPixel;u&&(n=(t.valueOf()-u.leftGlobal)/i.timePerPixel);const s=(e.valueOf()-d.leftGlobal)/i.timePerPixel-n;return r?-o-s:o+s}return r?-o:o}getLeftViewDate(t=this.state.get("$data.chart.time")){if(!t.levels||!t.levels.length)return null;const e=t.levels[t.level];return e.length?e[0]:null}getRightViewDate(t=this.state.get("$data.chart.time")){if(!t.levels||!t.levels.length||!t.levels[t.level])return null;const e=t.levels[t.level];return e.length?e[e.length-1]:null}getLowerPeriod(t){switch(t){case"year":return"month";case"month":return"week";case"week":return"day";case"day":return"hour";case"hour":return"minute";case"minute":return"second";case"second":return"millisecond";default:return t}}getHigherPeriod(t){switch(t){case"month":return"year";case"week":return"month";case"day":return"week";case"hour":return"day";case"minute":return"hour";case"second":return"minute";case"millisecond":return"second";default:return t}}}function Ne(t,e="*"){this.wchar=e,this.pattern=t,this.segments=[],this.starCount=0,this.minLength=0,this.maxLength=0,this.segStartIndex=0;for(let i=0,n=t.length;i<n;i+=1){const n=t[i];n===e&&(this.starCount+=1,i>this.segStartIndex&&this.segments.push(t.substring(this.segStartIndex,i)),this.segments.push(n),this.segStartIndex=i+1)}this.segStartIndex<t.length&&this.segments.push(t.substring(this.segStartIndex)),this.starCount?(this.minLength=t.length-this.starCount,this.maxLength=1/0):this.maxLength=this.minLength=t.length}function ze(t,e,i,n){this.obj=t,this.delimeter=e,this.wildcard=i,this.is_match=n}Ne.prototype.match=function(t){if(this.pattern===this.wchar)return!0;if(0===this.segments.length)return this.pattern===t;const{length:e}=t;if(e<this.minLength||e>this.maxLength)return!1;let i=this.segments.length-1,n=t.length-1,s=!1;for(;;){const e=this.segments[i];if(i-=1,e===this.wchar)s=!0;else{const i=n+1-e.length,o=t.lastIndexOf(e,i);if(-1===o||o>i)return!1;if(s)n=o-1,s=!1;else{if(o!==i)return!1;n-=e.length}}if(0>i)break}return!0},ze.prototype.simpleMatch=function(t,e){if(t===e)return!0;if(t===this.wildcard)return!0;if(this.is_match)return this.is_match(t,e);const i=t.indexOf(this.wildcard);if(i>-1){const n=t.substr(i+1);if(0===i||e.substring(0,i)===t.substring(0,i)){const t=n.length;return!(t>0)||e.substr(-t)===n}}return!1},ze.prototype.match=function(t,e){return this.is_match?this.is_match(t,e):t===e||t===this.wildcard||e===this.wildcard||this.simpleMatch(t,e)||new Ne(t).match(e)},ze.prototype.handleArray=function(t,e,i,n,s={}){let o=t.indexOf(this.delimeter,i),r=!1;-1===o&&(r=!0,o=t.length);const a=t.substring(i,o);let l=0;for(const i of e){const e=l.toString(),c=""===n?e:n+this.delimeter+l;(a===this.wildcard||a===e||this.simpleMatch(a,e))&&(r?s[c]=i:this.goFurther(t,i,o+1,c,s)),l++}return s},ze.prototype.handleObject=function(t,e,i,n,s={}){let o=t.indexOf(this.delimeter,i),r=!1;-1===o&&(r=!0,o=t.length);const a=t.substring(i,o);for(let i in e){i=i.toString();const l=""===n?i:n+this.delimeter+i;(a===this.wildcard||a===i||this.simpleMatch(a,i))&&(r?s[l]=e[i]:this.goFurther(t,e[i],o+1,l,s))}return s},ze.prototype.goFurther=function(t,e,i,n,s={}){return Array.isArray(e)?this.handleArray(t,e,i,n,s):this.handleObject(t,e,i,n,s)},ze.prototype.get=function(t){return this.goFurther(t,this.obj,0,"")};class Ye{static get(t,e,i=!1){if(!e)return;let n=e;for(const e of t)if(n.hasOwnProperty(e))n=n[e];else{if(!i)return;n[e]={},n=n[e]}return n}static set(t,e,i){if(!i)return;if(0===t.length){for(const t in e)i[t]=e[t];return}const n=t.slice(),s=n.pop(),o=Ye.get(n,i,!0);return"object"==typeof o&&(o[s]=e),e}}let Ge,He=0,Ve=null;function ke(){return null!==Ve&&Ve.buffer===Ge.memory.buffer||(Ve=new Uint8Array(Ge.memory.buffer)),Ve}let We=new TextEncoder("utf-8");const je="function"==typeof We.encodeInto?function(t,e){return We.encodeInto(t,e)}:function(t,e){const i=We.encode(t);return e.set(i),{read:t.length,written:i.length}};function Fe(t,e,i){if(void 0===i){const i=We.encode(t),n=e(i.length);return ke().subarray(n,n+i.length).set(i),He=i.length,n}let n=t.length,s=e(n);const o=ke();let r=0;for(;r<n;r++){const e=t.charCodeAt(r);if(e>127)break;o[s+r]=e}if(r!==n){0!==r&&(t=t.slice(r)),s=i(s,n,n=r+3*t.length);const e=ke().subarray(s+r,s+n);r+=je(t,e).written}return He=r,s}function Xe(t,e){var i=Fe(t,Ge.__wbindgen_malloc,Ge.__wbindgen_realloc),n=He,s=Fe(e,Ge.__wbindgen_malloc,Ge.__wbindgen_realloc),o=He;return 0!==Ge.is_match(i,n,s,o)}async function Ue(t){("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:e,module:i}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"==t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const i=await t.arrayBuffer();return await WebAssembly.instantiate(i,e)}{const i=await WebAssembly.instantiate(t,e);return i instanceof WebAssembly.Instance?{instance:i,module:t}:i}}(await t,{});return Ge=e.exports,Ue.__wbindgen_wasm_module=i,Ge}function Be(t,e){console.debug(t,e)}const qe={bulk:!1,debug:!1,source:"",data:void 0,queue:!1},Qe={only:[],source:"",debug:!1,data:void 0,queue:!1,force:!1};class Ke{constructor(t={},e={}){this.jobsRunning=0,this.updateQueue=[],this.subscribeQueue=[],this.listenersIgnoreCache=new WeakMap,this.destroyed=!1,this.queueRuns=0,this.lastExecs=new WeakMap,this.listeners=new Map,this.waitingListeners=new Map,this.data=t,this.options=Object.assign(Object.assign({},{delimeter:".",notRecursive:";",param:":",wildcard:"*",experimentalMatch:!1,queue:!1,maxSimultaneousJobs:1e3,maxQueueRuns:1e3,log:Be,Promise:Promise}),e),this.id=0,this.pathGet=Ye.get,this.pathSet=Ye.set,e.Promise?this.resolved=e.Promise.resolve():this.resolved=Promise.resolve(),this.scan=new ze(this.data,this.options.delimeter,this.options.wildcard),this.destroyed=!1}loadWasmMatcher(t){return At(this,void 0,void 0,(function*(){yield Ue(t),this.is_match=Xe,this.scan=new ze(this.data,this.options.delimeter,this.options.wildcard,this.is_match)}))}same(t,e){return(["number","string","undefined","boolean"].includes(typeof t)||null===t)&&e===t}getListeners(){return this.listeners}destroy(){this.destroyed=!0,this.data=void 0,this.listeners=new Map,this.updateQueue=[],this.jobsRunning=0}match(t,e){return this.is_match?this.is_match(t,e):t===e||(t===this.options.wildcard||e===this.options.wildcard||this.scan.match(t,e))}getIndicesOf(t,e){const i=t.length;if(0==i)return[];let n,s=0,o=[];for(;(n=e.indexOf(t,s))>-1;)o.push(n),s=n+i;return o}getIndicesCount(t,e){const i=t.length;if(0==i)return 0;let n,s=0,o=0;for(;(n=e.indexOf(t,s))>-1;)o++,s=n+i;return o}cutPath(t,e){t=this.cleanNotRecursivePath(t),e=this.cleanNotRecursivePath(e);const i=this.getIndicesCount(this.options.delimeter,e),n=this.getIndicesOf(this.options.delimeter,t);return t.substr(0,n[i])}trimPath(t){return(t=this.cleanNotRecursivePath(t)).charAt(0)===this.options.delimeter?t.substr(1):t}split(t){return""===t?[]:t.split(this.options.delimeter)}isWildcard(t){return t.includes(this.options.wildcard)}isNotRecursive(t){return t.endsWith(this.options.notRecursive)}cleanNotRecursivePath(t){return this.isNotRecursive(t)?t.substring(0,t.length-1):t}hasParams(t){return t.includes(this.options.param)}getParamsInfo(t){let e={replaced:"",original:t,params:{}},i=0,n=[];for(const s of this.split(t)){e.params[i]={original:s,replaced:"",name:""};const t=new RegExp(`\\${this.options.param}([^\\${this.options.delimeter}\\${this.options.param}]+)`,"g");let o=t.exec(s);o?(e.params[i].name=o[1],t.lastIndex=0,e.params[i].replaced=s.replace(t,this.options.wildcard),n.push(e.params[i].replaced),i++):(delete e.params[i],n.push(s),i++)}return e.replaced=n.join(this.options.delimeter),e}getParams(t,e){if(!t)return;const i=this.split(e),n={};for(const e in t.params){n[t.params[e].name]=i[e]}return n}waitForAll(t,e){const i={};for(let e of t)i[e]={dirty:!1},this.hasParams(e)&&(i[e].paramsInfo=this.getParamsInfo(e)),i[e].isWildcard=this.isWildcard(e),i[e].isRecursive=!this.isNotRecursive(e);return this.waitingListeners.set(t,{fn:e,paths:i}),e(i),function(){this.waitingListeners.delete(t)}}executeWaitingListeners(t){if(!this.destroyed)for(const e of this.waitingListeners.values()){const{fn:i,paths:n}=e;let s=0,o=0;for(let e in n){const i=n[e];let r=!1;i.isRecursive&&(t=this.cutPath(t,e)),i.isWildcard&&this.match(e,t)&&(r=!0),t===e&&(r=!0),r&&(i.dirty=!0),i.dirty&&s++,o++}s===o&&i(n)}}subscribeAll(t,e,i=qe){if(this.destroyed)return()=>{};let n=[];for(const s of t)n.push(this.subscribe(s,e,i));return function(){for(const t of n)t()}}getCleanListenersCollection(t={}){return Object.assign({listeners:new Map,isRecursive:!1,isWildcard:!1,hasParams:!1,match:void 0,paramsInfo:void 0,path:void 0,count:0},t)}getCleanListener(t,e=qe){return{fn:t,options:Object.assign(Object.assign({},qe),e)}}getListenerCollectionMatch(t,e,i){t=this.cleanNotRecursivePath(t);const n=this;return function(s){return e&&(s=n.cutPath(s,t)),!(!i||!n.match(t,s))||t===s}}getListenersCollection(t,e){if(this.listeners.has(t)){let i=this.listeners.get(t);return i.listeners.set(++this.id,e),i}let i={isRecursive:!0,isWildcard:!1,hasParams:!1,paramsInfo:void 0,originalPath:t,path:t};this.hasParams(i.path)&&(i.paramsInfo=this.getParamsInfo(i.path),i.path=i.paramsInfo.replaced,i.hasParams=!0),i.isWildcard=this.isWildcard(i.path),this.isNotRecursive(i.path)&&(i.isRecursive=!1);let n=this.getCleanListenersCollection(Object.assign(Object.assign({},i),{match:this.getListenerCollectionMatch(i.path,i.isRecursive,i.isWildcard)}));return this.id++,n.listeners.set(this.id,e),this.listeners.set(i.path,n),n}subscribe(t,e,i=qe,n="subscribe"){if(this.destroyed)return()=>{};this.jobsRunning++;let s=this.getCleanListener(e,i);this.listenersIgnoreCache.set(s,{truthy:[],falsy:[]});const o=this.getListenersCollection(t,s);if(o.count++,t=o.path,o.isWildcard){const r=this.scan.get(this.cleanNotRecursivePath(t));if(i.bulk){const a=[];for(const t in r)a.push({path:t,params:this.getParams(o.paramsInfo,t),value:r[t]});e(a,{type:n,listener:s,listenersCollection:o,path:{listener:t,update:void 0,resolved:void 0},options:i,params:void 0})}else for(const a in r)e(r[a],{type:n,listener:s,listenersCollection:o,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(a)},params:this.getParams(o.paramsInfo,a),options:i})}else e(this.pathGet(this.split(this.cleanNotRecursivePath(t)),this.data),{type:n,listener:s,listenersCollection:o,path:{listener:t,update:void 0,resolved:this.cleanNotRecursivePath(t)},params:this.getParams(o.paramsInfo,t),options:i});return this.debugSubscribe(s,o,t),this.jobsRunning--,this.unsubscribe(t,this.id)}unsubscribe(t,e){const i=this.listeners,n=i.get(t);return function(){n.listeners.delete(e),n.count--,0===n.count&&i.delete(t)}}runQueuedListeners(){if(!this.destroyed&&0!==this.subscribeQueue.length)if(0===this.jobsRunning){this.queueRuns=0;const t=[...this.subscribeQueue];for(let e=0,i=t.length;e<i;e++)t[e]();this.subscribeQueue.length=0}else{if(this.queueRuns++,this.queueRuns>=this.options.maxQueueRuns)throw this.queueRuns=0,new Error("Maximal number of queue runs exhausted.");Promise.resolve().then(()=>this.runQueuedListeners()).catch(t=>{throw t})}}notifyListeners(t,e=[],i=!0){const n=[];for(const s in t){let{single:o,bulk:r}=t[s];for(const t of o){if(e.includes(t))continue;const s=this.debugTime(t);t.listener.options.queue&&this.jobsRunning?this.subscribeQueue.push(()=>{t.listener.fn(t.value(),t.eventInfo)}):t.listener.fn(t.value(),t.eventInfo),i&&n.push(t),this.debugListener(s,t)}for(const t of r){if(e.includes(t))continue;const s=this.debugTime(t),o=[];for(const e of t.value)o.push(Object.assign(Object.assign({},e),{value:e.value()}));t.listener.options.queue&&this.jobsRunning?this.subscribeQueue.push(()=>!this.jobsRunning&&(t.listener.fn(o,t.eventInfo),!0)):t.listener.fn(o,t.eventInfo),i&&n.push(t),this.debugListener(s,t)}}return Promise.resolve().then(()=>this.runQueuedListeners()),n}shouldIgnore(t,e){if(!t.options.ignore)return!1;for(const i of t.options.ignore){if(e.startsWith(i))return!0;if(this.is_match&&this.is_match(i,e))return!0;{const t=this.cutPath(e,i);if(this.match(i,t))return!0}}return!1}getSubscribedListeners(t,e,i,n="update",s=null){i=Object.assign(Object.assign({},Qe),i);const o={};for(let[r,a]of this.listeners)if(o[r]={single:[],bulk:[],bulkData:[]},a.match(t)){const l=a.paramsInfo?this.getParams(a.paramsInfo,t):void 0,c=this.cutPath(t,r),h=a.isRecursive||a.isWildcard?()=>this.get(c):()=>e,d=[{value:h,path:t,params:l}];for(const e of a.listeners.values())this.shouldIgnore(e,t)||(e.options.bulk?o[r].bulk.push({listener:e,listenersCollection:a,eventInfo:{type:n,listener:e,path:{listener:r,update:s||t,resolved:void 0},params:l,options:i},value:d}):o[r].single.push({listener:e,listenersCollection:a,eventInfo:{type:n,listener:e,path:{listener:r,update:s||t,resolved:this.cleanNotRecursivePath(t)},params:l,options:i},value:h}))}return o}notifySubscribedListeners(t,e,i,n="update",s=null){return this.notifyListeners(this.getSubscribedListeners(t,e,i,n,s))}getNestedListeners(t,e,i,n="update",s=null){const o={};for(let[r,a]of this.listeners){o[r]={single:[],bulk:[]};const l=this.cutPath(r,t);if(this.match(l,t)){const c=this.trimPath(r.substr(l.length)),h=new ze(e,this.options.delimeter,this.options.wildcard).get(c),d=a.paramsInfo?this.getParams(a.paramsInfo,t):void 0,u=[],p={};for(const e in h){const l=()=>h[e],c=[t,e].join(this.options.delimeter);for(const[e,h]of a.listeners){const f={type:n,listener:h,listenersCollection:a,path:{listener:r,update:s||t,resolved:this.cleanNotRecursivePath(c)},params:d,options:i};this.shouldIgnore(h,t)||(h.options.bulk?(u.push({value:l,path:c,params:d}),p[e]=h):o[r].single.push({listener:h,listenersCollection:a,eventInfo:f,value:l}))}}for(const e in p){const s=p[e],l={type:n,listener:s,listenersCollection:a,path:{listener:r,update:t,resolved:void 0},options:i,params:d};o[r].bulk.push({listener:s,listenersCollection:a,eventInfo:l,value:u})}}}return o}notifyNestedListeners(t,e,i,n="update",s,o=null){return this.notifyListeners(this.getNestedListeners(t,e,i,n,o),s,!1)}getNotifyOnlyListeners(t,e,i,n="update",s=null){const o={};if("object"!=typeof i.only||!Array.isArray(i.only)||void 0===i.only[0]||!this.canBeNested(e))return o;for(const r of i.only){const a=new ze(e,this.options.delimeter,this.options.wildcard).get(r);o[r]={bulk:[],single:[]};for(const e in a){const l=t+this.options.delimeter+e;for(const[c,h]of this.listeners){const d=h.paramsInfo?this.getParams(h.paramsInfo,l):void 0;if(this.match(c,l)){const u=()=>a[e],p=[{value:u,path:l,params:d}];for(const e of h.listeners.values()){const a={type:n,listener:e,listenersCollection:h,path:{listener:c,update:s||t,resolved:this.cleanNotRecursivePath(l)},params:d,options:i};this.shouldIgnore(e,t)||(e.options.bulk?o[r].bulk.some(t=>t.listener===e)||o[r].bulk.push({listener:e,listenersCollection:h,eventInfo:a,value:p}):o[r].single.push({listener:e,listenersCollection:h,eventInfo:a,value:u}))}}}}}return o}notifyOnly(t,e,i,n="update",s=""){return void 0!==this.notifyListeners(this.getNotifyOnlyListeners(t,e,i,n,s))[0]}canBeNested(t){return"object"==typeof t&&null!==t}getUpdateValues(t,e,i){let n=i;return"function"==typeof i&&(n=i(this.pathGet(e,this.data))),{newValue:n,oldValue:t}}wildcardNotify(t,e){let i=[];for(const e of t){const t=this.notifyListeners(e,i);for(const e of t)i.push(e)}for(const t of e)this.executeWaitingListeners(t);this.jobsRunning--}wildcardUpdate(t,e,i=Qe,n=!1){++this.jobsRunning,i=Object.assign(Object.assign({},Qe),i);const s=this.scan.get(t),o={};for(const t in s){const n=this.split(t),{oldValue:r,newValue:a}=this.getUpdateValues(s[t],n,e);this.same(a,r)&&!i.force||(this.pathSet(n,a,this.data),o[t]=a)}const r=[],a=[];for(const e in o){const n=o[e];i.only.length?r.push(this.getNotifyOnlyListeners(e,n,i,"update",t)):(r.push(this.getSubscribedListeners(e,n,i,"update",t)),this.canBeNested(n)&&r.push(this.getNestedListeners(e,n,i,"update",t))),i.debug&&this.options.log("Wildcard update",{path:e,newValue:n}),a.push(e)}if(n){const t=this;return function(){return t.wildcardNotify(r,a)}}this.wildcardNotify(r,a)}runUpdateQueue(){if(!this.destroyed)for(;this.updateQueue.length&&this.updateQueue.length<this.options.maxSimultaneousJobs;){const t=this.updateQueue.shift();t.options.queue=!1,this.update(t.updatePath,t.fnOrValue,t.options,t.multi)}}updateNotify(t,e,i){const n=this.notifySubscribedListeners(t,e,i);this.canBeNested(e)&&this.notifyNestedListeners(t,e,i,"update",n),this.executeWaitingListeners(t)}updateNotifyOnly(t,e,i){this.notifyOnly(t,e,i),this.executeWaitingListeners(t)}update(t,e,i=Object.assign({},Qe),n=!1){if(this.destroyed)return;const s=this.jobsRunning;if((this.options.queue||i.queue)&&s){if(s>this.options.maxSimultaneousJobs)throw new Error("Maximal simultaneous jobs limit reached.");this.updateQueue.push({updatePath:t,fnOrValue:e,options:i,multi:n});const o=Promise.resolve().then(()=>{this.runUpdateQueue()});return n?function(){return o}:o}if(this.isWildcard(t))return this.wildcardUpdate(t,e,i,n);++this.jobsRunning;const o=this.split(t),{oldValue:r,newValue:a}=this.getUpdateValues(this.pathGet(o,this.data),o,e);if(i.debug&&this.options.log(`Updating ${t} ${i.source?`from ${i.source}`:""}`,{oldValue:r,newValue:a}),this.same(a,r)&&!i.force)return--this.jobsRunning,n?function(){return a}:a;if(this.pathSet(o,a,this.data),null===(i=Object.assign(Object.assign({},Qe),i)).only)return--this.jobsRunning,n?function(){}:a;if(i.only.length){if(--this.jobsRunning,n){const e=this;return function(){return e.updateNotifyOnly(t,a,i)}}return this.updateNotifyOnly(t,a,i),a}if(n){--this.jobsRunning;const e=this;return function(){return e.updateNotify(t,a,i)}}return this.updateNotify(t,a,i),--this.jobsRunning,a}multi(){if(this.destroyed)return{update(){},done(){}};const t=this,e=[];return{update(i,n,s=Qe){return e.push(t.update(i,n,s,!0)),this},done(){for(let t=0,i=e.length;t<i;t++)e[t]();e.length=0}}}get(t){if(!this.destroyed)return void 0===t||""===t?this.data:this.pathGet(this.split(t),this.data)}last(t){let e=this.lastExecs.get(t);e||(e={calls:0},this.lastExecs.set(t,e));const i=++e.calls;this.resolved.then(()=>{i===e.calls&&(this.lastExecs.set(t,{calls:0}),t())})}debugSubscribe(t,e,i){t.options.debug&&this.options.log("listener subscribed",{listenerPath:i,listener:t,listenersCollection:e})}debugListener(t,e){(e.eventInfo.options.debug||e.listener.options.debug)&&this.options.log("Listener fired",{time:Date.now()-t,info:e})}debugTime(t){return t.listener.options.debug||t.eventInfo.options.debug?Date.now():0}}class Je extends Et{constructor(t,e,i){super(e,i),this.subs=[],this.name=t,this.subs.push(e.state.subscribe(`config.slots.${t}`,this.setComponents,{queue:!0}))}destroy(){this.subs.forEach(t=>t()),super.destroy()}getName(){return this.name}}function Ze(t,e,i){return new Je(t,e,i)}const ti=Ot.mergeDeep,ei="gstc";function ii(t,e=""){let i=`gstc__${t}`;return t===ei&&(i=ei),e?`${i} ${i}--${e.replace(/[^\w]+/gi,"-")}`:i}function ni(t,e){let i=`gstc__${t}`;return t===ei&&(i=ei),`${i}--${e}`}function si(t){let e=function(t,e){return Ot.mergeDeep(t,e)};"function"==typeof t.merge&&(e=t.merge);const i={debug:!1,plugins:[],plugin:{},innerHeight:428,headerHeight:72,components:{Main:ie,ScrollBar:ne,List:se,ListColumn:re,ListColumnHeader:ae,ListColumnHeaderResizer:le,ListColumnRow:he,ListColumnRowExpander:de,ListColumnRowExpanderToggle:ue,ListToggle:pe,Chart:fe,ChartCalendar:me,ChartCalendarDate:ve,ChartTimeline:be,ChartTimelineGrid:we,ChartTimelineGridRow:xe,ChartTimelineGridRowCell:De,ChartTimelineItems:_e,ChartTimelineItemsRow:Se,ChartTimelineItemsRowItem:Ce},wrappers:{Main:t=>t,ScrollBar:t=>t,List:t=>t,ListColumn:t=>t,ListColumnHeader:t=>t,ListColumnHeaderResizer:t=>t,ListColumnRow:t=>t,ListColumnRowExpander:t=>t,ListColumnRowExpanderToggle:t=>t,ListToggle:t=>t,Chart:t=>t,ChartCalendar:t=>t,ChartCalendarDate:t=>t,ChartTimeline:t=>t,ChartTimelineGrid:t=>t,ChartTimelineGridRow:t=>t,ChartTimelineGridRowCell:t=>t,ChartTimelineItems:t=>t,ChartTimelineItemsRow:t=>t,ChartTimelineItemsRowItem:t=>t},slots:Ie(),list:{rows:{},row:{height:40,gap:{top:0,bottom:0}},columns:{percent:100,resizer:{width:10,inRealTime:!0,dots:6},minWidth:50,data:{}},expander:{padding:18,size:20,icon:{width:16,height:16},icons:{child:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><ellipse ry="4" rx="4" id="svg_1" cy="12" cx="12" fill="#000000B0"/></svg>',open:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>',closed:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>'}},toggle:{display:!0,icons:{open:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path stroke="null" d="m16.406954,16.012672l4.00393,-4.012673l-4.00393,-4.012673l1.232651,-1.232651l5.245324,5.245324l-5.245324,5.245324l-1.232651,-1.232651z"/><path stroke="null" d="m-0.343497,12.97734zm1.620144,0l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,3.909362l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,-9.773404l0,1.95468l11.341011,0l0,-1.95468l-11.341011,0z"/></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path transform="rotate(-180 4.392796516418457,12) " stroke="null" d="m1.153809,16.012672l4.00393,-4.012673l-4.00393,-4.012673l1.232651,-1.232651l5.245324,5.245324l-5.245324,5.245324l-1.232651,-1.232651z"/><path stroke="null" d="m9.773297,12.97734zm1.620144,0l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,3.909362l11.341011,0l0,-1.954681l-11.341011,0l0,1.954681zm0,-9.773404l0,1.95468l11.341011,0l0,-1.95468l-11.341011,0z"/></svg>'}}},scroll:{bodyClassName:"gstc-scrolling",horizontal:{size:20,minInnerSize:40,data:null,posPx:0,maxPosPx:0,area:0,multiplier:3,offset:0,smooth:!1},vertical:{size:20,minInnerSize:40,data:null,posPx:0,maxPosPx:0,area:0,multiplier:3,offset:0,smooth:!1}},chart:{time:{period:"day",from:0,to:0,zoom:20,leftGlobal:0,centerGlobal:0,rightGlobal:0,levels:[],calculatedZoomMode:!1,onLevelDates:[],onCurrentViewLevelDates:[],onDate:[],allDates:[],additionalSpaceAdded:!1},calendar:{expand:!0,levels:[{formats:[{zoomTo:17,period:"day",className:"gstc-date-medium gstc-date-left",format:({timeStart:t})=>t.format("DD MMMM YYYY (dddd)")},{zoomTo:23,period:"month",format:({timeStart:t})=>t.format("MMMM YYYY")},{zoomTo:24,period:"month",format:({timeStart:t})=>t.format("MMMM 'YY")},{zoomTo:25,period:"month",format:({timeStart:t})=>t.format("MMM YYYY")},{zoomTo:27,period:"year",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:100,period:"year",default:!0,format:()=>null}]},{main:!0,formats:[{zoomTo:16,period:"hour",format:({timeStart:t})=>t.format("HH:mm")},{zoomTo:17,period:"hour",default:!0,format:({timeStart:t})=>t.format("HH")},{zoomTo:19,period:"day",className:"gstc-date-medium",format:({timeStart:t,className:e,vido:i})=>i.html`<span class="${e}-content gstc-date-bold">${t.format("DD")}</span> <span class="${e}-content gstc-date-thin">${t.format("dddd")}</span>`},{zoomTo:20,period:"day",default:!0,format:({timeStart:t,vido:e,className:i})=>e.html`<div class="${i}-content gstc-date-top">${t.format("DD")}</div><div class="${i}-content gstc-date-small">${t.format("dddd")}</div>`},{zoomTo:21,period:"day",format:({timeStart:t,vido:e,className:i})=>e.html`<div class="${i}-content gstc-date-top">${t.format("DD")}</div><div class="${i}-content gstc-date-small">${t.format("ddd")}</div>`},{zoomTo:22,period:"day",className:"gstc-date-vertical",format:({timeStart:t,className:e,vido:i})=>i.html`<div class="${e}-content gstc-date-top">${t.format("DD")}</div><div class="${e}-content gstc-date-extra-small">${t.format("ddd")}</div>`},{zoomTo:23,period:"week",default:!0,format:({timeStart:t,timeEnd:e,className:i,vido:n})=>n.html`<div class="${i}-content gstc-date-top">${t.format("DD")} - ${e.format("DD")}</div><div class="${i}-content gstc-date-small gstc-date-thin">${t.format("ddd")} - ${e.format("dd")}</div>`},{zoomTo:25,period:"week",className:"gstc-date-vertical",format:({timeStart:t,timeEnd:e,className:i,vido:n})=>n.html`<div class="${i}-content gstc-date-top gstc-date-small gstc-date-normal">${t.format("DD")}</div><div class="gstc-dash gstc-date-small">-</div><div class="${i}-content gstc-date-small gstc-date-normal">${e.format("DD")}</div>`},{zoomTo:26,period:"month",default:!0,className:"gstc-date-month-level-1",format:({timeStart:t,vido:e,className:i})=>e.html`<div class="${i}-content gstc-date-top">${t.format("MMM")}</div><div class="${i}-content gstc-date-small gstc-date-bottom">${t.format("MM")}</div>`},{zoomTo:27,period:"month",className:"gstc-date-vertical",format:({timeStart:t,className:e,vido:i})=>i.html`<div class="${e}-content gstc-date-top">${t.format("MM")}</div><div class="${e}-content gstc-date-extra-small">${t.format("MMM")}</div>`},{zoomTo:28,period:"year",default:!0,className:"gstc-date-big",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:29,period:"year",className:"gstc-date-medium",format:({timeStart:t})=>t.format("YYYY")},{zoomTo:30,period:"year",className:"gstc-date-medium",format:({timeStart:t})=>t.format("YY")},{zoomTo:100,period:"year",default:!0,format:()=>null}]}]},grid:{cell:{onCreate:[]}},item:{gap:{top:4,bottom:4},top:0,height:32,minWidth:10},items:{},spacing:1},classNames:{},actions:Ee(),locale:{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekStart:1,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd, D MMMM YYYY HH:mm"},ordinal:t=>{const e=["th","st","nd","rd"],i=t%100;return`[${t}${e[(i-20)%10]||e[i]||e[0]}]`}},utcMode:!1,usageStatistics:!0,merge:(t,e)=>Ot.mergeDeep({},t,e),useLast:!1,Promise:Promise},n=function(t,e,i){const n=i({},e.actions),s=i({},t.actions);let o=[...Object.keys(n),...Object.keys(s)];o=o.filter(t=>o.includes(t));const r={};for(const t of o)r[t]=[],void 0!==n[t]&&Array.isArray(n[t])&&(r[t]=[...n[t]]),void 0!==s[t]&&Array.isArray(s[t])&&(r[t]=[...r[t],...s[t]]);return delete t.actions,delete e.actions,r}(t,i,e),s={config:e(i,t)};return s.config.actions=n,s}const oi={name:ei,stateFromConfig:function(t){return this.state=new Ke(si(t),{delimeter:".",maxSimultaneousJobs:1e3,Promise:t.Promise})},wasmStateFromConfig:function(t,e="./wildcard_matcher_bg.wasm"){return At(this,void 0,void 0,(function*(){return this.state=new Ke(si(t),{delimeter:".",maxSimultaneousJobs:1e3}),yield this.state.loadWasmMatcher(e),this.state}))},merge:ti,lithtml:U,date:t=>t?Ae(t):Ae(),setPeriod(t){return this.state.update("config.chart.time.period",t),this.state.get("config.chart.time.zoom")},dayjs:Ae};class ri{constructor(t){this.name=ei,this.debug=!1,this.iconsCache={},this.unsubscribes=[],this.generateSlots=Ze,this.mergeDeep=ti,this.getClass=ii,this.getId=ni,this.allActions=[],this.state=t,this.time=new Le(this.state,this),this.unsubscribes.push(this.state.subscribe("config.debug",t=>this.debug=t)),this.debug&&(window.state=t)}setVido(t){this.vido=t}log(...t){this.debug&&console.log.call(console,...t)}getActions(t){this.allActions.includes(t)||this.allActions.push(t);let e=this.state.get("config.actions."+t);return void 0===e&&(e=[]),e.slice()}isItemInViewport(t,e,i){return t.time.start<=i&&t.time.end>=e}getAllLinkedItemsIds(t,e,i=[]){if(t.linkedWith&&t.linkedWith.length){i.includes(t.id)||i.push(t.id);for(const n of t.linkedWith){if(i.includes(n))continue;i.push(n);const s=e[n];if(!s)throw new Error(`Linked item not found [id:'${n}'] found in item [id:'${t.id}']`);s.linkedWith&&s.linkedWith.length&&this.getAllLinkedItemsIds(s,e,i)}}return i}getRow(t){return this.state.get(`config.list.rows.${t}`)}getRows(t){if(!t.length)return[];const e=this.getAllRows(),i=[];for(const n of t)e[n]&&i.push(e[n]);return i}getAllRows(){return this.state.get("config.list.rows")}getItem(t){return this.state.get(`config.chart.items.${t}`)}getItems(t){if(!t.length)return[];const e=[],i=this.getAllItems();for(const n of t)i[n]&&e.push(i[n]);return e}getAllItems(){return this.state.get("config.chart.items")}prepareLinkedItems(t,e){const i=this.getAllLinkedItemsIds(t,e);for(const n of i){const s=e[n];if(!s)throw new Error(`Linked item not found [id:'${n}'] found in item [id:'${t.id}']`);s.linkedWith=i.filter(t=>t!==s.id)}}prepareItems(t){const e=this.state.get("config.chart.item.height");for(let i in t){const n=t[i];if(i=String(i),n.id=i,n.$data)return t;this.prepareLinkedItems(n,t),n.time.start=+n.time.start,n.time.end=+n.time.end,n.id=String(n.id);const s=this.state.get("config.chart.item");"number"!=typeof n.height&&(n.height=e),n.$data||(n.$data={actualHeight:0,outerHeight:0,time:null,position:{left:0,actualLeft:0,right:0,actualRight:0,top:n.top||0,actualTop:n.top||0,viewTop:0},width:-1,actualWidth:-1,detached:!1}),n.$data.time={startDate:this.time.date(n.time.start),endDate:this.time.date(n.time.end)},n.$data.actualHeight=n.height,"number"!=typeof n.top&&(n.top=0),n.gap||(n.gap={}),"number"!=typeof n.gap.top&&(n.gap.top=s.gap.top),"number"!=typeof n.gap.bottom&&(n.gap.bottom=s.gap.bottom),"number"!=typeof n.minWidth&&(n.minWidth=s.minWidth),n.$data.outerHeight=n.$data.actualHeight+n.gap.top+n.gap.bottom,n.$data.position.actualTop=n.$data.position.top+n.gap.top}return t}fillEmptyRowValues(t){const e=this.state.get("config.list.row.height");let i=0;for(let n in t){const s=t[n];if(n=String(n),s.id=n,s.$data)return t;s.$data||(s.$data={parents:[],children:[],position:{top:0,topPercent:0,bottomPercent:0,viewTop:0},items:[],actualHeight:0,outerHeight:0}),"number"!=typeof s.height&&(s.height=e),s.$data.actualHeight=s.height,"boolean"!=typeof s.expanded&&(s.expanded=!1),s.$data.position.top=i,"object"!=typeof s.gap&&(s.gap={}),"number"!=typeof s.gap.top&&(s.gap.top=0),"number"!=typeof s.gap.bottom&&(s.gap.bottom=0),s.$data.outerHeight=s.$data.actualHeight+s.gap.top+s.gap.bottom,i+=s.$data.outerHeight}return t}itemsOnTheSameLevel(t,e){const i=t.$data.position.top+t.$data.outerHeight,n=e.$data.position.top+e.$data.outerHeight;return e.$data.position.top<=t.$data.position.top&&n>t.$data.position.top||(e.$data.position.top>=t.$data.position.top&&e.$data.position.top<i||e.$data.position.top>=t.$data.position.top&&n<i)}itemsOverlaps(t,e){return!!this.itemsOnTheSameLevel(t,e)&&(e.time.start>=t.time.start&&e.time.start<=t.time.end||(e.time.end>=t.time.start&&e.time.end<=t.time.end||(e.time.start>=t.time.start&&e.time.end<=t.time.end||e.time.start<=t.time.start&&e.time.end>=t.time.end)))}itemOverlapsWithOthers(t,e){for(let i=0,n=e.length;i<n;i++){const n=e[i],s=n.time.start&&t.time.start&&n.time.end&&t.time.end;if(t.id!==n.id&&this.itemsOverlaps(t,n)&&s)return n}return null}fixOverlappedItems(t){if(0===t.length)return;let e=0;for(let i of t){i.$data.position.top=i.top,i.$data.position.actualTop=i.$data.position.top+i.gap.top;let n=this.itemOverlapsWithOthers(i,t);if(e&&n)for(;n=this.itemOverlapsWithOthers(i,t);)i.$data.position.top+=n.$data.outerHeight,i.$data.position.actualTop=i.$data.position.top+i.gap.top;e++}}recalculateRowHeight(t,e=!1){if(!t.$data)return 0;let i=0;if(e){const e=this.getItems(t.$data.items);this.fixOverlappedItems(e),t.$data.items=e.map(t=>t.id)}for(const e of this.getItems(t.$data.items))i=Math.max(i,e.$data.position.top+e.$data.outerHeight);return i<t.height&&(i=t.height),t.$data.actualHeight=i,t.$data.outerHeight=t.$data.actualHeight+t.gap.top+t.gap.bottom,t.$data.outerHeight}recalculateRowsHeightsAndFixOverlappingItems(t){let e=0;const i=this.getAllRows();for(const n of t){const t=i[n];this.recalculateRowHeight(t,!0),t.$data.position.top=e,e+=t.$data.outerHeight}return e}recalculateRowsPercents(t,e){let i=0;const n=this.getAllRows();for(const s of t){const t=n[s];e<=0?(t.$data.position.topPercent=0,t.$data.position.bottomPercent=0):(t.$data.position.topPercent=i?i/e:0,t.$data.position.bottomPercent=(i+t.$data.outerHeight)/e),i+=t.$data.outerHeight}}generateParents(t,e="parentId"){const i={};for(const n in t){const s=t[n],o=void 0!==s[e]&&null!==s[e]?s[e]:"";void 0===i[o]&&(i[o]={}),i[o][s.id]=s}return i}fastTree(t,e,i=[]){const n=t[e.id];if(e.$data.parents=i,void 0===n)return e.$data.children=[],e;""!==e.id&&(i=[...i,e.id]),e.$data.children=Object.values(n).map(t=>t.id);for(const e in n){const s=n[e];this.fastTree(t,s,i)}return e}makeTreeMap(t,e){const i=this.generateParents(e,"rowId");for(const e in t){if(!t[e].$data)return;if(t[e].$data.items.length=0,void 0!==i[e])for(const n of Object.values(i[e]))t[e].$data.items.push(n.id)}const n=this.generateParents(t);return this.fastTree(n,{id:"",$data:{children:[],parents:[],items:[]}})}getRowsWithParentsExpanded(t){const e=[];t:for(const i in t){if(!t[i].$data||!t[i].$data.parents)return[];for(const e of t[i].$data.parents){const i=t[e];if(!i||!i.expanded)continue t}e.push(i)}return e}getVisibleRows(t){if(this.debug&&console.log("getVisibleRows #1",{rowsWithParentsExpanded:t}),0===t.length)return[];const e=[],i=this.state.get("config.scroll.vertical");let n=i.data;this.debug&&console.log("getVisibleRows #2",{topRow:n}),n||(n=t[0]);let s=this.state.get("$data.innerHeight");if(this.debug&&console.log("getVisibleRows #3",{innerHeight:s}),!s)return[];const o=this.getAllRows();s+=i.offset||0;let r=t.find(t=>t===n.id),a=t.indexOf(r);if(this.debug&&console.log("getVisibleRows #4",{index:a}),void 0===a)return[];let l=0;for(let i=t.length;a<i;a++){const i=t[a],n=o[i];if(!n||!n.$data)return this.debug&&console.log("getVisibleItems NO-ROW",{row:n,rowId:i,rows:o,index:a,rowsWithParentsExpanded:t}),[];if(l<=s&&(n.$data.position.viewTop=l,e.push(n.id)),l+=n.$data.outerHeight,l>=s)break}return this.debug&&console.log("getVisibleRows #5 final",{visibleRows:e,innerHeight:s,topRow:n,index:a}),e}normalizeMouseWheelEvent(t){let e=t.deltaX||0,i=t.deltaY||0,n=t.deltaZ||0;const s=t.deltaMode,o=this.state.get("config.list.rowHeight");let r=1;switch(s){case 1:o&&(r=o);break;case 2:r=window.height}return e*=r,i*=r,n*=r,{x:e,y:i,z:n,event:t}}scrollToTime(t,e=!0,i=this.state.get("$data.chart.time")){if(!i.allDates)return 0;if(e){t-=this.state.get("$data.chart.dimensions.width")/2*i.timePerPixel}const n=this.time.findDateAtTime(t,i.allDates[i.level]);let s=i.allDates[i.level].indexOf(n);return-1===s?0:this.setScrollLeft(s,i).posPx}setScrollLeft(t,e=this.state.get("$data.chart.time"),i,n="scroll"){void 0===t&&(t=0);let s=!0;void 0===i&&(s=!1,i=this.state.multi());const o=e.allDates[e.level];if(!o)return;const r=o[t];if(!r)return;let a;return i=i.update("config.scroll.horizontal",i=>{i.data=Object.assign({},r);const n=e.allDates[e.level].length-i.lastPageCount;t>n&&(t=n),i.dataIndex=t,i.posPx=this.time.calculateScrollPosPxFromTime(i.data.leftGlobal,e,i);const s=i.maxPosPx-i.innerSize;return i.posPx>s&&(i.posPx=s),a=i,i}),n&&(i=i.update("$data.chart.time.recalculateTimesLastReason",n)),s?i:(i.done(),a)}getScrollLeft(){return this.state.get("config.scroll.horizontal")}setScrollTop(t,e=0){void 0===t&&(t=0);const i=this.state.get("$data.list.rowsWithParentsExpanded"),n=this.getRows(i);n[t]||0===t||(t=0),n[t]&&this.state.update("config.scroll.vertical",i=>{const s=n.length-i.lastPageCount;return t+i.lastPageCount>n.length&&(t=s),t===s&&(e=0),i.data=n[t],i.offset=e,i.posPx=n[t].$data.position.topPercent*i.maxPosPx+Math.floor(i.scrollArea*(e/i.area)),i.dataIndex=t,i})}getScrollTop(){return this.state.get("config.scroll.vertical")}getSVGIconSrc(t){return"string"==typeof this.iconsCache[t]||(this.iconsCache[t]="data:image/svg+xml;base64,"+btoa(t)),this.iconsCache[t]}destroy(){for(const t of this.unsubscribes)t();this.unsubscribes=[],this.debug&&delete window.state}}function ai(t){const e=t.state,i=new ri(e),n={treeMap:{id:"",$data:{children:[],parents:[],items:[]}},list:{visibleRows:[],visibleRowsHeight:0,rowsWithParentsExpanded:[],rowsHeight:0,width:0},dimensions:{width:0,height:0},chart:{dimensions:{width:0,innerWidth:0,height:0},visibleItems:[],time:{zoom:0,format:{period:"day",zoomTo:0,format:()=>""},level:0,levels:[],timePerPixel:0,totalViewDurationMs:0,totalViewDurationPx:0,leftGlobal:0,rightGlobal:0,leftPx:0,rightPx:0,leftInner:0,rightInner:0,period:"day",leftGlobalDate:null,rightGlobalDate:null,centerGlobal:0,centerGlobalDate:null,from:0,to:0,fromDate:null,toDate:null,additionalSpaceAdded:!1}},elements:{}};"boolean"==typeof t.debug&&t.debug&&(window.state=e),e.update("",t=>({config:t.config,$data:n}));const s=It(e,i);i.setVido(s);const o=e.get("config.components.Main"),r=s.createApp({component:o,props:{},element:t.element}),a=r.vidoInstance.api;const l={state:e,api:a,component:r,destroy:function(){r.destroy()},reload:function(){l.component.destroy();const i=e.get("config.components.Main");l.component=s.createApp({component:i,props:{},element:t.element}),l.api=r.vidoInstance.api,l.component.update()}};return l}ai.api=oi;export default ai;
